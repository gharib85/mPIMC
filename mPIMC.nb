(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    311098,       7391]
NotebookOptionsPosition[    310752,       7375]
NotebookOutlinePosition[    311132,       7391]
CellTagsIndexPosition[    311089,       7388]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Copyright (C) 2017 Thomas Whitehead", "Text",
 CellChangeTimes->{{3.7130873657561436`*^9, 3.713087374400468*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<mPIMC`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startingPositions", "::", "usage"}], "=", 
   "\"\<startingPositions[numparticles,numslices,samplerange,sampledelta,\
dimensionality]\nnumparticles - the number of particles in the system\n\
numslices - the number of slices/beads per particle\nsamplerange - the \
position range over which to look for local minima to start particles in\n\
sampledelta - the position sampling size over which minima are sought\n\
dimensionality - the dimension of the system\nRETURN - a \
{numparticles,numslices,dimensionality} vector of the starting positions for \
particles, which should be perturbed using pathInitialise\n\n\
startingPositions looks for approximate local minima of the external \
potential, returning a vector of where particles should start out\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startingPositions", "::", "argnum"}], "=", 
   "\"\<startingPositions was called with `1` arguments.  It expected \
5.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathInitialise", "::", "usage"}], "=", 
   "\"\<pathInitialise[numparticles,numslices,\[Lambda],\[Tau],dimensionality]\
\nnumparticles - the number of particles in the system\nnumslices - the \
number of slices/beads per particle\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - the dimension of the system\nRETURN - a \
{numparticles,numslices,dimensionality} vector of positions randomly \
distributed around the origin, drawn from a flat distribution of the width of \
the thermal wavelength\n\npathInitialise slightly randomises initial starting \
positions over the order of the thermal wavelength\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathInitialise", "::", "argnum"}], "=", 
   "\"\<pathInitialise was called with `1` arguments.  It expected 5.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vprime", "::", "usage"}], "=", 
   "\"\<vprime[path,particle,bead]\npath - list of all particle and bead \
positions at a given time step\nparticle - individual particle for which to \
calculate vprime\nbead - individual bead of that particle for which to \
calculate vripime\nRETURN - a {dimensionality} vector of the derivative of \
the potential at the position of the selected particle\n\nvprime calculates \
the first derivative of the external potential and interparticle potential at \
the position of a given particle\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vprime", "::", "argnum"}], "=", 
   "\"\<vprime was called with `1` arguments.  It expected 3.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkinetic", "::", "usage"}], "=", 
   "\"\<springkinetic[post1,post2,\[Lambda],\[Tau]]\npost1 - position of \
first particle bead\npost2 - position of second particle bead\n\[Lambda] - \!\
\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
RETURN - a real number expressing the kinetic energy from the 'spring' \
between two beads\n\nspringkinetic calculates the contribution to the kinetic \
energy from a single pair of adjacent beads with given positions.  Note, \
almost always better to use springkineticC\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkinetic", "::", "argnum"}], "=", 
   "\"\<springkinetic was called with `1` arguments.  It expected 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkineticC", "::", "usage"}], "=", 
   "\"\<springkineticC[post1,post2,\[Lambda],\[Tau]]\npost1 - position of \
first particle bead\npost2 - position of second particle bead\n\[Lambda] - \!\
\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
RETURN - a real number expressing the kinetic energy from the 'spring' \
between two beads\n\nspringkineticC calculates the contribution to the \
kinetic energy from a single pair of adjacent beads with given \
positions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkineticC", "::", "argnum"}], "=", 
   "\"\<springkineticC was called with `1` arguments.  It expected 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"place", "::", "usage"}], "=", 
   "\"\<place[length,placed]\nlength - the length of the list\nplaced - the \
position which may sit within a list of length 'length', or may sit within \
'length' either side of it\nRETURN - an integer expressing a new value of \
placed\n\nplace rounds placed to sit within the range [1,length], useful if \
labels have been cycled\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"place", "::", "argnum"}], "=", 
   "\"\<place was called with `1` arguments.  It expected 2.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalVariate", "::", "usage"}], "=", 
   "\"\<normalVariate[\[Mu],\[Sigma],dimensionality]\n\[Mu] - mean value to \
draw values around (usually 0)\n\[Sigma] - standard deviation of samples to \
draw\ndimensionality - dimension of the system\nRETURN - a {dimensionality} \
position vector of random values drawn from a normal distribution\n\n\
normalVariate gives a random vector drawn from a normal distribution with \
mean \[Mu] and standard deviation \[Sigma]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalVariate", "::", "argnum"}], "=", 
   "\"\<normalVariate was called with `1` arguments.  It expected 3.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleBeadDisplace", "::", "usage"}], "=", 
   "\"\<singleBeadDisplace[path,\[Lambda],\[Tau],dimensionality]\npath - list \
of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - {move accepted \
(True/False),new path}\n\nsingleBeadDisplace randomly selects one particle, \
relabels its beads, then moves the second bead of this particle by random \
vector.  If move is accepted (acceptprob>randomreal), replace position of \
this bead with new position\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleBeadDisplace", "::", "argnum"}], "=", 
   "\"\<singleBeadDisplace was called with `1` arguments.  It expected \
4.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleElectronDisplace", "::", "usage"}], "=", 
   "\"\<singleElectronDisplace[path,\[Lambda],\[Tau],dimensionality]\npath - \
list of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - {move accepted \
(True/False),new path}\n\nsingleElectronDisplace randomly selects one \
particle, shifts all the beads of it by a random vector.  If move is accepted \
(acceptprob>randomreal), replace electron positions with new positions\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleElectronDisplace", "::", "argnum"}], "=", 
   "\"\<singleElectronDisplace was called with `1` arguments.  It expected 4.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMover", "::", "usage"}], "=", 
   "\"\<bisectionMover[path,places,\[Lambda],\[Tau],dimensionality]\npath - \
list of all bead positions at a given time step for a given particle (note \
unusual definition)\nplaces - a list of three bead numbers, of which the \
second corresponds to a bead to be moved\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - a {dimensionality} \
position vector for the new position of the second bead in 'places'\n\n\
bisectionMover is a function to bisect given bead positions to find a new \
bead position, and then offset from it a random amount drawn from a normal \
distribution of order the thermal wavelength.  Note, almost always better to \
use bisectionMoverC\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMover", "::", "argnum"}], "=", 
   "\"\<bisectionMover was called with `1` arguments.  It expected 5.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoverC", "::", "usage"}], "=", 
   "\"\<bisectionMoverC[path,places,\[Lambda],\[Tau],dimensionality]\npath - \
list of all bead positions at a given time step for a given particle (note \
unusual definition)\nplaces - a list of three bead numbers, of which the \
second corresponds to a bead to be moved\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - a {dimensionality} \
position vector for the new position of the second bead in 'places'\n\n\
bisectionMoverC is a function to bisect given bead positions to find a new \
bead position, and then offset from it a random amount drawn from a normal \
distribution of order the thermal wavelength\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoverC", "::", "argnum"}], "=", 
   "\"\<bisectionMoverC was called with `1` arguments.  It expected 5.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMove", "::", "usage"}], "=", 
   "\"\<bisectionMove[path,\[Lambda],\[Tau],dimensionality]\npath - list of \
all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - {move accepted \
(True/False),new path}\n\nbisectionMove randomly selects one particle, \
relabls its beads, then implements a bisection algorithm on its beads.  In \
this algorithm, for each step the middle bead of the subsections of the \
arrays is moved by a random distance set to sample the kinetic energy density \
matrix.  Then, at each step, the potential energy is compared with old move, \
and accepted or not. DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMove", "::", "argnum"}], "=", 
   "\"\<bisectionMove was called with `1` arguments.  It expected 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoveStatistics", "::", "usage"}], "=", 
   "\"\<bisectionMoveStatistics[path,\[Lambda],\[Tau],joined,maxcyclelength,\
dimensionality]\npath - list of all particle and bead positions at a given \
time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \
\(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a measure \
of inverse temperature\njoined - an association of each particle, showing \
which particle is joined before it\nmaxcyclelength - the maximum number of \
particles to attempt to permute labels of in a single move\ndimensionality - \
dimension of the system\nRETURN - {move accepted (True/False),new path}\n\n\
bisectionMoveStatistics randomly selects one particle, relabls its beads, \
then implements a bisection algorithm on its beads.  In this algorithm, for \
each step the middle bead of the subsections of the arrays is moved by a \
random distance set to sample the kinetic energy density matrix.  Then, at \
each step, the potential energy is compared with old move, and accepted or \
not.  In addition, chains of beads can join or split apart (implementing \
bosonic statistics), handled by the association 'joined'\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoveStatistics", "::", "argnum"}], "=", 
   "\"\<bisectionMoveStatistics was called with `1` arguments.  It expected \
6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"permutationSampler", "::", "usage"}], "=", 
   "\"\<permutationSampler[path,\[Lambda],\[Tau],joined,cyclelength,beads]\n\
path - list of all particle and bead positions at a given time step\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\njoined - an association of each particle, showing which particle \
is joined before it\ncyclelength - the number of particles whose labels are \
being permuted\nbeads - the number of beads/slices per uncorrelated particle\n\
RETURN - an association of the newly joined particle labels\n\n\
permutationSampler samples permutations of the different particle labels, and \
returns a new joined association if energetically favourable\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"permutationSampler", "::", "argnum"}], "=", 
   "\"\<permutationSampler was called with `1` arguments.  It expected \
6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1bead", "::", "usage"}], "=", 
   "\"\<potentialAction1bead[path,\[Lambda],\[Tau],particle,bead]\npath - \
list of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
particle - the particular particle to calculate the contribution to the \
potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the potential action for\nRETURN - a real \
number expressing the potential action of that particle bead in all \
potentials\n\npotentialAction1bead gives the potential action contribution of \
each particle to the action, symmetrized and in the primitive approximation. \
DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1bead", "::", "argnum"}], "=", 
   "\"\<potentialAction1bead was called with `1` arguments.  It expected 5.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatistics", "::", "usage"}], "=", 
   "\"\<potentialAction1beadStatistics[path,\[Lambda],\[Tau],particle,bead,\
joined]\npath - list of all particle and bead positions at a given time step\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\nparticle - the particular particle to calculate the contribution \
to the potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the potential action for\njoined - an \
association of each particle, showing which particle is joined before it\n\
RETURN - a real number expressing the potential action of that particle bead \
in all potentials\n\npotentialAction1beadStatistics gives the potential \
action contribution of each particle to the action, symmetrized, including \
the possibility of permutations, and in the primitive approximation. Note: \
generally better to use potentialAction1beadStatisticsC\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatistics", "::", "argnum"}], "=", 
   "\"\<potentialAction1beadStatistics was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatisticsC", "::", "usage"}], "=", 
   "\"\<potentialAction1beadStatisticsC[path,\[Lambda],\[Tau],particle,bead,\
joined]\npath - list of all particle and bead positions at a given time step\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\nparticle - the particular particle to calculate the contribution \
to the potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the potential action for\njoined - an array \
showing which particle is joined before the corresponding particle (note \
unusual definition: Values@joined)\nRETURN - a real number expressing the \
potential action of that particle bead in all potentials\n\n\
potentialAction1beadStatisticsC gives the potential action contribution of \
each particle to the action, symmetrized, including the possibility of \
permutations, and in the primitive approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatisticsC", "::", "argnum"}], "=", 
   "\"\<potentialAction1beadStatisticsC was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction1bead", "::", "usage"}], "=", 
   "\"\<kineticAction1bead[path,\[Lambda],\[Tau],particle,bead]\npath - list \
of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
particle - the particular particle to calculate the contribution to the \
potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the kinetic action for\nRETURN - a real number \
expressing the kinetic action of that particle bead\n\nkineticAction1bead \
gives the kinetic action contribution of each particle bead to the \
action\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction1bead", "::", "argnum"}], "=", 
   "\"\<kineticAction1bead was called with `1` arguments.  It expected \
5.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction2bead", "::", "usage"}], "=", 
   "\"\<kineticAction2bead[path,\[Lambda],\[Tau],particle,bead1,bead2]\npath \
- list of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
particle - the particular particle to calculate the contribution to the \
potential action for\nbead1 - one particular bead of that particle to \
calculate the contribution to the kinetic action for\nbead2 - another \
particular bead of that particle to calculate the contribution to the kinetic \
action for\nRETURN - a real number expressing the kinetic action of two beads\
\n\nkineticAction2bead gives the kinetic action contribution of a pair of \
particle beads to the action\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction2bead", "::", "argnum"}], "=", 
   "\"\<kineticAction2bead was called with `1` arguments.  It expected \
6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticActionOffset", "::", "usage"}], "=", 
   "\"\<kineticActionOffset[\[Lambda],\[Tau],numparticles,numslices,\
dimensionality]\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - the number of particles in the \
system\nnumslices - the number of slices/beads for each particle\n\
dimensionality - the dimension of the system\nRETURN - a real number giving \
the classical contribution to the kinetic energy\n\nkineticActionOffset \
calculates the semi-classical kinetic energy of a particle for use in \
virial-style estimators\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticActionOffset", "::", "argnum"}], "=", 
   "\"\<kineticActionOffset was called with `1` arguments.  It expected \
5.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimator", "::", "usage"}], "=", 
   "\"\<virialTotalEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total energy\n\nvirialTotalEnergyEstimator gives an estimator for the total \
energy, calculated in the virial approximation. DEPRECATED\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimator", "::", "argnum"}], "=", 
   "\"\<virialTotalEnergyEstimator was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimator", "::", "usage"}], "=", 
   "\"\<virialTotalEnergySquaredEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total squared energy\n\nvirialTotalEnergySquaredEstimator gives an estimator \
for the total energy squared, calculated in the virial approximation. \
DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimator", "::", "argnum"}], "=", 
   "\"\<virialTotalEnergySquaredEstimator was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimatorStatistics", "::", "usage"}], "=", 
   "\"\<virialTotalEnergyEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total energy\n\n\
virialTotalEnergyEstimatorStatistics gives an estimator for the total energy, \
calculated in the virial approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimatorStatistics", "::", "argnum"}], "=", 
   "\"\<virialTotalEnergyEstimatorStatistics was called with `1` arguments.  \
It expected 7.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "::", "usage"}], 
   "=", "\"\<virialTotalEnergySquaredEstimatorStatistics[path,\[Lambda],\[Tau]\
,numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total squared \
energy\n\nvirialTotalEnergySquaredEstimatorStatistics gives an estimator for \
the total energy squared, calculated in the virial approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "::", "argnum"}], 
   "=", "\"\<virialTotalEnergySquaredEstimatorStatistics was called with `1` \
arguments.  It expected 7.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimator", "::", "usage"}], "=", 
   "\"\<thermTotalEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total energy\n\nthermTotalEnergyEstimator gives an estimator for the total \
energy, calculated in the thermodynamic approximation. DEPRECATED\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimator", "::", "argnum"}], "=", 
   "\"\<thermTotalEnergyEstimator was called with `1` arguments.  It expected \
6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimator", "::", "usage"}], "=", 
   "\"\<thermTotalEnergySquaredEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total squared energy\n\nthermTotalEnergySquaredEstimator gives an estimator \
for the total energy squared, calculated in the thermodynamic approximation. \
DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimator", "::", "argnum"}], "=", 
   "\"\<thermTotalEnergySquaredEstimator was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimatorStatistics", "::", "usage"}], "=", 
   "\"\<thermTotalEnergyEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total energy\n\n\
thermTotalEnergyEstimatorStatistics gives an estimator for the total energy, \
calculated in the thermodynamic approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimatorStatistics", "::", "argnum"}], "=", 
   "\"\<thermTotalEnergyEstimatorStatistics was called with `1` arguments.  \
It expected 7.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "::", "usage"}], 
   "=", "\"\<thermTotalEnergySquaredEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total squared \
energy\n\nthermTotalEnergySquaredEstimatorStatistics gives an estimator for \
the total energy squared, calculated in the thermodynamic \
approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "::", "argnum"}], 
   "=", "\"\<thermTotalEnergySquaredEstimatorStatistics was called with `1` \
arguments.  It expected 7.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "::", "usage"}], "=", 
   "\"\<fullVirialTotalEnergyEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total energy\n\n\
fullVirialTotalEnergyEstimatorStatistics gives an estimator for the total \
energy, calculated in the virial approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "::", "argnum"}], "=", 
   "\"\<fullVirialTotalEnergyEstimatorStatistics was called with `1` \
arguments.  It expected 7.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergySquaredEstimatorStatistics", "::", "usage"}],
    "=", "\"\<fullVirialTotalEnergySquaredEstimatorStatistics[path,\[Lambda],\
\[Tau],numparticles,numslices,joined,dimensionality]\npath - list of all \
particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total squared \
energy\n\nfullVirialTotalEnergySquaredEstimatorStatistics gives an estimator \
for the total energy squared, calculated in the virial approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "fullVirialTotalEnergySquaredEstimatorStatistics", "::", "argnum"}], "=", 
   "\"\<fullVirialTotalEnergySquaredEstimatorStatistics was called with `1` \
arguments.  It expected 7.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeTotalEnergyEstimator", "::", "usage"}], "=", 
   "\"\<heinzeTotalEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total energy\n\nheinzeTotalEnergyEstimator gives an estimator for the total \
energy, calculated according to the Heinze procedure, see \
http://oops.uni-oldenburg.de/274/1/304.pdf, p. 26.  Note: factor of 2 is a \
fudge, not properly physically motivated\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeTotalEnergyEstimator", "::", "argnum"}], "=", 
   "\"\<heinzeTotalEnergyEstimator was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeKineticEnergyEstimator", "::", "usage"}], "=", 
   "\"\<heinzeKineticEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
kinetic energy\n\nheinzeKineticEnergyEstimator gives an estimator for the \
kinetic energy, calculated according to the Heinze procedure, see \
http://oops.uni-oldenburg.de/274/1/304.pdf, p. 26\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeKineticEnergyEstimator", "::", "argnum"}], "=", 
   "\"\<heinzeKineticEnergyEstimator was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePotentialEnergyEstimator", "::", "usage"}], "=", 
   "\"\<heinzePotentialEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
potential energy\n\nheinzePotentialEnergyEstimator gives an estimator for the \
potential energy, calculated according to the Heinze procedure, see \
http://oops.uni-oldenburg.de/274/1/304.pdf, p. 26\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePotentialEnergyEstimator", "::", "argnum"}], "=", 
   "\"\<heinzePotentialEnergyEstimator was called with `1` arguments.  It \
expected 6.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePairDist", "::", "usage"}], "=", 
   "\"\<heinzePairDist[path,numparticles,numslices]\npath - list of all \
particle and bead positions at a given time step\nnumparticles - number of \
particles in the system\nnumslices - number of slices/beads per particle\n\
RETURN - an array of inter-particle distance vectors\n\nheinzePairDist gives \
an approximation to the density-density correlation function, calculated at \
each time step, for use in calculating the total energy\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePairDist", "::", "argnum"}], "=", 
   "\"\<heinzePairDist was called with `1` arguments.  It expected 3.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeParticleDist", "::", "usage"}], "=", 
   "\"\<heinzeParticleDist[path,numparticles,numslices]\npath - list of all \
particle and bead positions at a given time step\nnumparticles - number of \
particles in the system\nnumslices - number of slices/beads per particle\n\
RETURN - an array of position vectors\n\nheinzeParticleDist gives an \
approximation to the density, calculated at each time step, for use in \
calculating the total energy\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeParticleDist", "::", "argnum"}], "=", 
   "\"\<heinzeParticleDist was called with `1` arguments.  It expected \
3.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialPlot", "::", "usage"}], "=", 
   "\"\<potentialPlot[path,dimensionality]\npath - list of all particle and \
bead positions at a given time step\ndimensionality - the dimension of the \
system\nRETURN - a plot of the external potential\n\npotentialPlot creates a \
plot of the external potential, given a realisation of particle \
positions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialPlot", "::", "argnum"}], "=", 
   "\"\<potentialPlot was called with `1` arguments.  It expected 2.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPlot", "::", "usage"}], "=", 
   "\"\<energyPlot[energyVirial,energyFullVirial,energyTherm,energyHeinze,\
energysaverarrayvirial,energysaverarrayfullvirial,energysaverarraytherm,\
energysaverarrayheinze,invvarvirial,invvarfullvirial,invvartherm,invvarheinze,\
equilibrationsteps,numsteps,harmonictrap,\[Omega],\[Tau],slices,\
dimensionality]\nenergyVirial - whether to calculate the energy in the virial \
approximation\nenergyFullVirial - whether to calculate the energy in the full \
virial approximation\nenergyTherm - whether to calculate the energy in the \
thermodynamic approximation\nenergyHeinze - whether to calculate the energy \
using the Heinze procedure\nenergysaverarrayvirial - an array of energies \
calculated in the virial approximation\nenergysaverarrayfullvirial - an array \
of energies calculated in the full virial approximation\n\
energysaverarraytherm - an array of energies calculated in the thermodynamic \
approximation\nenergysaverarrayheinze - an array of energies calculated using \
the Heinze procedure\ninvvarvirial - an array of inverse variances of the \
energy calculated in the virial approximation\ninvvarfullvirial - an array of \
inverse variances of the energy calculated in the full virial approximation\n\
invvartherm - an array of inverse variances of the energy calculated in the \
thermodynamic approximation\ninvvarheinze - an array of inverse variances of \
the energy calculated using the Heinze procedure\nequilibrationsteps - the \
number of equilibration steps taken before calculating estimators\nnumsteps - \
the total number of time steps used\nharmonictrap - whether to calculate \
properties in a corresponding harmonic trap\n\[Omega] - corresponding \
harmonic trap frequency\n\[Tau] - the time step, also a measure of inverse \
temperature\nslices - number of slices/beads per particle\ndimensionality - \
the dimension of the system\nRETURN - a plot of the energy estimators in the \
system\n\nenergyPlot creates a plot of the energy estimators as a function of \
step number, showing also the average values and their error bars and \
analytic approximations if requested\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPlot", "::", "argnum"}], "=", 
   "\"\<energyPlot was called with `1` arguments.  It expected 19.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathPlot", "::", "usage"}], "=", 
   "\"\<pathPlot[path,joined,dimensionality]\npath - list of all particle and \
bead positions at a given time step\njoined - an association of each \
particle, showing which particle is joined before it\ndimensionality - the \
dimension of the system\nRETURN - a plot of the position of beads in a given \
realisation\n\npathPlot plots paths, including the permutations given in the \
'joined' association\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathPlot", "::", "argnum"}], "=", 
   "\"\<pathPlot was called with `1` arguments.  It expected 3.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyVirial", "::", "usage"}], "=", 
   "\"\<printEnergyVirial[energysaverarrayvirial,invvarvirial]\n\
energysaverarrayvirial - an array of energies calculated in the virial \
approximation\ninvvarvirial - an array of inverse variances of the energy \
calculated in the virial approximation\nRETURN - a string\n\n\
printEnergyVirial prints the energy expectation value and error in the virial \
approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyVirial", "::", "argnum"}], "=", 
   "\"\<printEnergyVirial was called with `1` arguments.  It expected \
2.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyFullVirial", "::", "usage"}], "=", 
   "\"\<printEnergyFullVirial[energysaverarrayvirial,invvarvirial]\n\
energysaverarrayvirial - an array of energies calculated in the full virial \
approximation\ninvvarvirial - an array of inverse variances of the energy \
calculated in the full virial approximation\nRETURN - a string\n\n\
printEnergyFullVirial prints the energy expectation value and error in the \
full virial approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyFullVirial", "::", "argnum"}], "=", 
   "\"\<printEnergyFullVirial was called with `1` arguments.  It expected \
2.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyTherm", "::", "usage"}], "=", 
   "\"\<printEnergyTherm[energysaverarraytherm,invvartherm]\n\
energysaverarraytherm - an array of energies calculated in the thermodynamic \
approximation\ninvvartherm - an array of inverse variances of the energy \
calculated in the thermodynamic approximation\nRETURN - a string\n\n\
printEnergyTherm prints the energy expectation value and error in the \
thermodynamic approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyTherm", "::", "argnum"}], "=", 
   "\"\<printEnergyTherm was called with `1` arguments.  It expected \
2.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyHeinze", "::", "usage"}], "=", 
   "\"\<printEnergyHeinze[energysaverarrayheinze]\nenergysaverarrayheinze - \
an array of energies calculated using the Heinze procedure\nRETURN - a string\
\n\nprintEnergyHeinze prints the energy expectation value and error using the \
Heinze procedure\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyHeinze", "::", "argnum"}], "=", 
   "\"\<printEnergyHeinze was called with `1` arguments.  It expected \
1.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"autocorrelationPlot", "::", "usage"}], "=", 
   "\"\<autocorrelationPlot[energyVirial,energyFullVirial,energyTherm,\
energyHeinze,energysaverarrayvirial,energysaverarrayfullvirial,\
energysaverarraytherm,energysaverarrayheinze,observablecalc]\nenergyVirial - \
whether to calculate the energy in the virial approximation\nenergyFullVirial \
- whether to calculate the energy in the full virial approximation\n\
energyTherm - whether to calculate the energy in the thermodynamic \
approximation\nenergyHeinze - whether to calculate the energy using the \
Heinze procedure\nenergysaverarrayvirial - an array of energies calculated in \
the virial approximation\nenergysaverarrayfullvirial - an array of energies \
calculated in the full virial approximation\nenergysaverarraytherm - an array \
of energies calculated in the thermodynamic approximation\n\
energysaverarrayheinze - an array of energies calculated using the Heinze \
procedure\nobservablecalc - how many time steps between calculating \
expectation values\nRETURN - a plot of the autocorrelation in different \
energy estimators\n\nautocorrelationPlot creates a plot of the \
autocorrelation in the different estimators of the energy as a function of \
step number\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"autocorrelationPlot", "::", "argnum"}], "=", 
   "\"\<autocorrelationPlot was called with `1` arguments.  It expected \
9.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapEnergies", "::", "usage"}], "=", 
   "\"\<exactHarmonicTrapEnergies[maxval,\[Tau],slices,\[Omega],\
dimensionality]\nmaxval - the maximum principal quantum number to use\n\[Tau] \
- the time step, also a measure of inverse temperature\nslices - number of \
slices/beads per particle\n\[Omega] - harmonic trap frequency\ndimensionality \
- the dimension of the system\nRETURN - a real number that gives the energy \
of a particle in an harmonic trap\n\nexactHarmonicTrapEnergies gives a \
numerically exact (as maxval->\[Infinity]) expression for the energy of a \
single particle in an harmonic trap, for comparison with calculated results\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapEnergies", "::", "argnum"}], "=", 
   "\"\<exactHarmonicTrapEnergies was called with `1` arguments.  It expected \
5.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapWfns", "::", "usage"}], "=", 
   "\"\<exactHarmonicTrapWfns[maxval,\[Tau],slices,\[Omega],dimensionality]\n\
maxval - the maximum principal quantum number to use\n\[Tau] - the time step, \
also a measure of inverse temperature\nslices - number of slices/beads per \
particle\n\[Omega] - harmonic trap frequency\ndimensionality - the dimension \
of the system\nRETURN - a 1D function corresponding to the x-position of a \
particle in an harmonic trap\n\nexactHarmonicTrapWfns gives a numerically \
exact (as maxval->\[Infinity]) expression for the x-position of a single \
particle in an harmonic trap, for comparison with calculated results\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapWfns", "::", "argnum"}], "=", 
   "\"\<exactHarmonicTrapWfns was called with `1` arguments.  It expected \
5.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyArrayMaker", "::", "usage"}], "=", 
   "\"\<energyArrayMaker[energyassoc,energysquaredassoc]\nenergyassoc - an \
association of energies\nenergysquaredassoc - an association of squared \
energies\nRETURN - an array of two arrays, the energy and inverse variance of \
the energy\n\nenergyArrayMaker takes associations of energies and squared \
energies, and returns arrays of the energy and the inverse variance, for \
weighting purposes\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyArrayMaker", "::", "argnum"}], "=", 
   "\"\<energyArrayMaker was called with `1` arguments.  It expected \
2.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMaker", "::", "usage"}], "=", 
   "\"\<energyAssocMaker[step,numsteps,\[Lambda],\[Tau],numparticles,\
numslices,path,dimensionality,type]\nstep - the time step number\nnumsteps - \
the total number of time steps used\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - the number of particles in the system\nnumslices - the number \
of slices/beads per particle\npath - list of all particle and bead positions \
at a given time step\ndimensionality - the dimension of the system\ntype - \
type of energy estimator desired\nRETURN - pairs of {{relative step,energy \
estimator},{relative step,squared energy estimator}} arrays\n\n\
energyAssocMaker calculates the energy and squared energy in the \
approximation given by 'type'.  Currently supported versions are 'virial', \
'therm', 'heinze'. DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMaker", "::", "argnum"}], "=", 
   "\"\<energyAssocMaker was called with `1` arguments.  It expected \
9.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMakerStatistics", "::", "usage"}], "=", 
   "\"\<energyAssocMakerStatistics[step,numsteps,\[Lambda],\[Tau],\
numparticles,numslices,path,joined,dimensionality,type]\nstep - the time step \
number\nnumsteps - the total number of time steps used\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - the number of particles in the system\nnumslices - the number \
of slices/beads per particle\npath - list of all particle and bead positions \
at a given time step\njoined - an association of each particle, showing which \
particle is joined before it\ndimensionality - the dimension of the system\n\
type - type of energy estimator desired\nRETURN - pairs of {{relative \
step,energy estimator},{relative step,squared energy estimator}} arrays\n\n\
energyAssocMakerStatistics calculates the energy and squared energy in the \
approximation given by 'type'.  Currently supported versions are 'virial', \
'fullvirial', 'therm', 'heinze'\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMakerStatistics", "::", "argnum"}], "=", 
   "\"\<energyAssocMakerStatistics was called with `1` arguments.  It \
expected 10.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyMaker", "::", "usage"}], "=", 
   "\"\<energyMaker[calculateEnergy,energyTherm,energyVirial,energyFullVirial,\
energyHeinze,harmonictrap,energysaveassoctherm,energysquaredsaveassoctherm,\
energysaveassocvirial,energysquaredsaveassocvirial,energysaveassocfullvirial,\
energysquaredsaveassocfullvirial,energysaveassocheinze,\
energysquaredsaveassocheinze,\[Tau],slices,\[Omega]]\ncalculateEnergy - \
whether to calculate the energy expectation value\nenergyTherm - whether to \
calculate the energy in the thermodynamic approximation\nenergyVirial - \
whether to calculate the energy in the virial approximation\nenergyFullVirial \
- whether to calculate the energy in the full virial approximation\n\
energyHeinze - whether to calculate the energy using the Heinze procedure\n\
harmonictrap - whether to calculate properties in a corresponding harmonic \
trap\nenergysaveassoctherm - association of energies calculated in the \
thermodynamic approximation\nenergysquaredsaveassoctherm - association of \
squared energies calculated in the thermodynamic approximation\n\
energysaveassocvirial - association of energies calculated in the virial \
approximation\nenergysquaredsaveassocvirial - association of squared energies \
calculated in the virial approximation\nenergysaveassocfullvirial - \
association of energies calculated in the full virial approximation\n\
energysquaredsaveassocfullvirial - association of squared energies calculated \
in the full virial approximation\nenergysaveassocheinze - association of \
energies calculated using the Heinze procedure\nenergysquaredsaveassocheinze \
- association of squared energies calculated using the Heinze procedure\n\
\[Tau] - the time step, also a measure of inverse temperature\nslices - the \
number of slices/beads per particle\n\[Omega] - harmonic trap frequency\n\
RETURN - arrays of energies and errors in different approximations\n\n\
energyMaker takes the associations of energies created at each time step, and \
converts them into arrays\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyMaker", "::", "argnum"}], "=", 
   "\"\<energyMaker was called with `1` arguments.  It expected 17.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPrinter", "::", "usage"}], "=", 
   "\"\<energyPrinter[calculateEnergy,energyTherm,energyVirial,\
energyFullVirial,energyHeinze,harmonictrap,energysaverarraytherm,invvartherm,\
energysaverarrayvirial,invvarvirial,energysaverarrayfullvirial,\
invvarfullvirial,energysaverarrayheinze,invvarheinze,\[Tau],slices,\[Omega],\
dimensionality]\ncalculateEnergy - whether to calculate the energy \
expectation value\nenergyTherm - whether to calculate the energy in the \
thermodynamic approximation\nenergyVirial - whether to calculate the energy \
in the virial approximation\nenergyFullVirial - whether to calculate the \
energy in the full virial approximation\nenergyHeinze - whether to calculate \
the energy using the Heinze procedure\nharmonictrap - whether to calculate \
properties in a corresponding harmonic trap\nenergysaverarraytherm - an array \
of energies calculated in the thermodynamic approximation\ninvvartherm - an \
array of inverse variances of the energy calculated in the thermodynamic \
approximation\nenergysaverarrayvirial - an array of energies calculated in \
the virial approximation\ninvvarvirial - an array of inverse variances of the \
energy calculated in the virial approximation\nenergysaverarrayfullvirial - \
an array of energies calculated in the full virial approximation\n\
invvarfullvirial - an array of inverse variances of the energy calculated in \
the full virial approximation\nenergysaverarrayheinze - an array of energies \
calculated using the Heinze procedure\ninvvarheinze - an array of inverse \
variances of the energy calculated using the Heinze procedure\n\[Tau] - the \
time step, also a measure of inverse temperature\nslices - the number of \
slices/beads per particle\n\[Omega] - harmonic trap frequency\ndimensionality \
- the dimension of the system\nRETURN - Null, prints strings\n\nenergyPrinter \
takes arrays of energies and inverse variances and passes them to routines \
which print the energy estimators and errors on them\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPrinter", "::", "argnum"}], "=", 
   "\"\<energyPrinter was called with `1` arguments.  It expected 18.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expectationValueMaker", "::", "usage"}], "=", 
   "\"\<expectationValueMaker[calculateParticleDensityX,\
calculatePairCorrelationFunction,numparticles,particleDensityX,\
vectorPairCorrelationFunction]\ncalculateParticleDensityX - whether to \
calculate the single-particle density\ncalculatePairCorrelationFunction - \
whether to calculate the pair/density-density correlation function\n\
numparticles - the number of particles in the system\nparticleDensityX - an \
association of single-particle positions\nvectorPairCorrelationFunction - an \
association of pairs of particle positions\nRETURN - an array of pairs of \
{density,density-density} arrays\n\nexpectationValueMaker takes the \
associations of expectation values (not the energy) calculated at each time \
step, and turns them into arrays.  Currently supports density and \
density-density correlation functions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expectationValueMaker", "::", "argnum"}], "=", 
   "\"\<expectationValueMaker was called with `1` arguments.  It expected \
5.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotMaker", "::", "usage"}], "=", 
   "\"\<plotMaker[showPaths,calculateEnergy,calculateParticleDensityX,\
calculatePairCorrelationFunction,allow3DCorrelationPlots,showAutocorrelation,\
numparticles,path,joined,energyVirial,energyFullVirial,energyTherm,\
energyHeinze,energysaverarrayvirial,energysaverarrayfullvirial,\
energysaverarraytherm,energysaverarrayheinze,invvarvirial,invvarfullvirial,\
invvartherm,invvarheinze,equilibrationsteps,numsteps,harmonictrap,\[Omega],\
\[Tau],slices,particleDensityXsaverarray,\
vectorPairCorrelationFunctionsaverarray,binsize,observablecalc,plotPoints,\
dimensionality]\nshowPaths - whether to plot a graph of a realisation of \
particle/bead positions\ncalculateEnergy - whether to calculate the energy \
expectation value\ncalculateParticleDensityX - whether to calculate the \
single-particle density\ncalculatePairCorrelationFunction - whether to \
calculate the pair/density-density correlation function\n\
allow3DCorrelationPlots - whether to make 3D plots of the density and pair \
correlation function; slower to run if allowed\nshowAutocorrelation - whether \
to show the autocorrelation in the energy\nnumparticles - the number of \
particles in the system\npath - list of all particle and bead positions at a \
given time step\njoined - an association of each particle, showing which \
particle is joined before it\nenergyVirial - whether to calculate the energy \
in the virial approximation\nenergyFullVirial - whether to calculate the \
energy in the full virial approximation\nenergyTherm - whether to calculate \
the energy in the thermodynamic approximation\nenergyHeinze - whether to \
calculate the energy using the Heinze procedure\nenergysaverarrayvirial - an \
array of energies calculated in the virial approximation\n\
energysaverarrayfullvirial - an array of energies calculated in the full \
virial approximation\nenergysaverarraytherm - an array of energies calculated \
in the thermodynamic approximation\nenergysaverarrayheinze - an array of \
energies calculated using the Heinze procedure\ninvvarvirial - an array of \
inverse variances of the energy calculated in the virial approximation\n\
invvarfullvirial - an array of inverse variances of the energy calculated in \
the full virial approximation\ninvvartherm - an array of inverse variances of \
the energy calculated in the thermodynamic approximation\ninvvarheinze - an \
array of inverse variances of the energy calculated using the Heinze \
procedure\nequilibrationsteps - the number of equilibration steps taken \
before calculating estimators\nnumsteps - the total number of time steps used\
\nharmonictrap - whether to calculate properties in a corresponding harmonic \
trap\n\[Omega] - harmonic trap frequency\n\[Tau] - the time step, also a \
measure of inverse temperature\nslices - the number of slices/beads per \
particle\nparticleDensityXsaverarray - an array of particle positions\n\
vectorPairCorrelationFunctionsaverarray - an array of pairs of particle \
positions\nbinsize - an array of sizes of different smoothings to use for the \
particle density and pair correlation functions\nobservablecalc - how many \
steps between calculating quantities\nplotPoints - the number of samples to \
take in 3D plots; slower to run for large numbers\ndimensionality - the \
dimension of the system\nRETURN - an array of plots\n\nplotMaker makes plots \
of the path, energy, particle density, pair correlation function, and \
autocorrelation, as requested\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotMaker", "::", "argnum"}], "=", 
   "\"\<plotMaker was called with `1` arguments.  It expected 33.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arrayExtractor", "::", "usage"}], "=", 
   "\"\<arrayExtractor[energyTherm,energyVirial,energyFullVirial,energyHeinze,\
calculateParticleDensityX,calculatePairCorrelationFunction,numparticles,\
arrays]\nenergyTherm - whether to calculate the energy in the thermodynamic \
approximation\nenergyVirial - whether to calculate the energy in the virial \
approximation\nenergyFullVirial - whether to calculate the energy in the full \
virial approximation\nenergyHeinze - whether to calculate the energy using \
the Heinze procedure\ncalculateParticleDensityX - whether to calculate the \
single-particle density\ncalculatePairCorrelationFunction - whether to \
calculate the pair/density-density correlation function\nnumparticles - the \
number of particles in the system\narrays - an array of arrays of different \
expectation values\nRETURN - an array of expectation values and errors, as \
{energy(therm),error(therm),energy(virial),error(virial),energy(fullvirial),\
error(fullvirial),energy(heinze),error(heinze),density,pair corr. fn.,number \
of successful bisections,number of steps with permutations,the last path,the \
last joined,the longest permutation cycle}\n\narrayExtractor takes arrays of \
expectation values calculated on different processors and combines them into \
single expectation values per time step\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arrayExtractor", "::", "argnum"}], "=", 
   "\"\<arrayExtractor was called with `1` arguments.  It expected 8.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialisationloop", "::", "usage"}], "=", 
   "\"\<initialisationloop[showPaths,\[Lambda],\[Tau],slices,numparticles,\
numsteps,startingRange,startingDelta,dimensionality]\nshowPaths - whether to \
plot the starting realisation of particle/bead positions\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
slices - the number of slices/beads per particle\nnumparticles - the number \
of particles in the system\nnumsteps - the total number of time steps used\n\
startingRange - the position range over which to look for local minima to \
start particles in\nstartingDelta - the position sampling size over which \
minima are sought\ndimensionality - the dimension of the system\nRETURN - an \
array of the starting particle/bead positions, and starting association of \
all particles unpermuted\n\ninitialisationloop creates the starting particle \
positions and permutations, also printing some information about the system \
and the starting positions, if requested\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialisationloop", "::", "argnum"}], "=", 
   "\"\<initialisationloop was called with `1` arguments.  It expected \
9.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mainLoop", "::", "usage"}], "=", 
   "\"\<mainLoop[originalpath,originaljoined,\[Lambda],\[Tau],calculateEnergy,\
calculateParticleDensity,calculatePairCorrelationFunction,maxcyclelength,\
dimensionality,numparticles,equilibrationsteps,observablecalc,numsteps,slices,\
energyTherm,energyVirial,energyFullVirial,energyHeinze,\[Omega],harmonictrap,\
calculateFracSameWell]\noriginalpath - an array ofstarting particle/bead \
positions\noriginaljoined - an association of starting particle permutations\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\ncalculateEnergy - whether to calculate the energy expectation \
value\ncalculateParticleDensityX - whether to calculate the single-particle \
density\ncalculatePairCorrelationFunction - whether to calculate the \
pair/density-density correlation function\nmaxcyclelength - the maximum \
number of particles to attempt to permute labels of in a single move\n\
dimensionality - the dimension of the system\nnumparticles - the number of \
particles in the system\nequilibrationsteps - number of time steps to \
equilibrate for before calculating expectation values\nobservablecalc - how \
many time steps between calculating expectation values\nnumsteps - the total \
number of time steps used\nslices - the number of slices/beads per particle\n\
energyTherm - whether to calculate the energy in the thermodynamic \
approximation\nenergyVirial - whether to calculate the energy in the virial \
approximation\nenergyFullVirial - whether to calculate the energy in the full \
virial approximation\nenergyHeinze - whether to calculate the energy using \
the Heinze procedure\n\[Omega] - harmonic trap frequency\nharmonictrap - \
whether to compare to analytic results in an harmonic trap\n\
calculateFracSameWell - whether to calculate fraction of particle pairs in \
the same well\nRETURN - an array of expectation values and other observables\n\
\nmainLoop does the main body of the path integral monte carlo calculation, \
calling the bisection algorithm and expectation value creation \
routines\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mainLoop", "::", "argnum"}], "=", 
   "\"\<mainLoop was called with `1` arguments.  It expected 21.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierSpacing", "::", "usage"}], "=", 
   "\"\<barrierSpacing[startingRange,startingDelta,dimensionality,kvec]\n\
startingRange - the position range over which to look for local minima to \
start particles in\nstartingDelta - the position sampling size over which \
minima are sought\ndimensionality - the dimension of the system\nkvec - a \
measure of the momentum-space separation between minima of the potential; k \
in Sin[k x]\nRETURN - a plot of the distribution of heights of the barriers \
between adjacent potential minima\n\nbarrierSpacing is used to investigate \
the distribution of barriers between potential minima, for comparison between \
potentials\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierSpacing", "::", "argnum"}], "=", 
   "\"\<barrierSpacing was called with `1` arguments.  It expected 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tarjan", "::", "usage"}], "=", 
   "\"\<tarjan[cycle]\ncycle - a 'joined' association of particle \
permutations\nRETURN - an array of the permutation cycle lengths encountered \
throughout a calculation\n\ntarjan implements a reduced version of the Tarjan \
algorithm to identify cycles within a permutation association\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tarjan", "::", "argnum"}], "=", 
   "\"\<tarjan was called with `1` arguments.  It expected 1.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fracsamewell", "::", "usage"}], "=", 
   "\"\<fracsamewell[vectorPairCorrelationFunctionsaverarray]\n\
vectorPairCorrelationFunctionsaverarray - an array of pairs of particle \
positions\nRETURN - a real number giving the fraction of pairs within a \
calculated distance\n\nfracsamewell is used to calculate what proportion of \
particle pairs are within the same potential minimum\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fracsamewell", "::", "argnum"}], "=", 
   "\"\<fracsamewell was called with `1` arguments.  It expected 1.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hoppingt", "::", "usage"}], "=", 
   "\"\<hoppingt[\[Lambda],kvec,V,a]\n\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\nkvec - the k in V Sin[k x] for periodic potential\nV - the V in \
V Sin[k x] for periodic potential\na - scattering length\nRETURN - a real \
number, the kinetic energy constant for a Hubbard model\n\nhoppingt is used \
to calculate the kinetic constant for a Hubbard-model equivalent of a studied \
lattice\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hoppingt", "::", "argnum"}], "=", 
   "\"\<hoppingt was called with `1` arguments.  It expected 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierU", "::", "usage"}], "=", 
   "\"\<barrierU[\[Lambda],kvec,V,a]\n\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\nkvec - the k in V Sin[k x] for periodic potential\nV - the V in \
V Sin[k x] for periodic potential\na - scattering length\nRETURN - a real \
number, the well depth constant for a Hubbard model\n\nbarrierU is used to \
calculate the well depth for a Hubbard-model equivalent of a studied \
lattice\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierU", "::", "argnum"}], "=", 
   "\"\<barrierU was called with `1` arguments.  It expected 4.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startingPositions", "[", 
    RowBox[{
    "numparticles_", ",", "numslices_", ",", "samplerange_", ",", 
     "sampledelta_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "table", ",", "data", ",", "heights", ",", "minima", ",", "position", 
       ",", "length"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z", ",", 
              RowBox[{"extV", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"table", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"heights", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "All", ",", "4"}], "]"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"minima", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MaximalBy", "[", 
              RowBox[{
               RowBox[{"Join", "@@@", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Riffle", "[", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"MinDetect", "[", "heights", "]"}], ",", "2"}], 
                    "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Last"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"extV", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"extV", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"table", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"heights", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"minima", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MaximalBy", "[", 
              RowBox[{
               RowBox[{"Join", "@@@", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Riffle", "[", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"MinDetect", "[", "heights", "]"}], ",", "2"}], 
                    "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Last"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"extV", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}], ",", 
        "True", ",", 
        RowBox[{
        "Throw", "[", "\"\<Unknown dimensionality in startingPositions\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"length", "=", 
       RowBox[{"Length", "@", "minima"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"minima", "[", 
         RowBox[{"[", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "length", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numparticles"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "numslices"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startingPositions", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"startingPositions", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathInitialise", "[", 
    RowBox[{
    "numparticles_", ",", "numslices_", ",", "\[Lambda]_", ",", "\[Tau]_", 
     ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numparticles", ",", "numslices", ",", "dimensionality"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathInitialise", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"pathInitialise", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vprime", "[", 
    RowBox[{"path_", ",", "particle_", ",", "bead_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"derivExtV", "[", 
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead"}], "]"}]}], 
       "]"}], "]"}], "]"}], "+", 
    RowBox[{"Total", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"derivIntpartV", "[", 
        RowBox[{
         RowBox[{"path", "[", 
          RowBox[{"[", 
           RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
         RowBox[{"path", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"place", "[", 
             RowBox[{
              RowBox[{"Length", "@", "path"}], ",", 
              RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], "]"}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vprime", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"vprime", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkinetic", "[", 
    RowBox[{"post1_", ",", "post2_", ",", "\[Lambda]_", ",", "\[Tau]_"}], 
    "]"}], ":=", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"Norm", "[", 
      RowBox[{"post1", "-", "post2"}], "]"}], "2"], 
    RowBox[{"4", "\[Lambda]", " ", "\[Tau]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"springkinetic", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"springkinetic", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkineticC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"post1", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"post2", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Norm", "[", 
         RowBox[{"post1", "-", "post2"}], "]"}], "2"], 
       RowBox[{"4", "\[Lambda]", " ", "\[Tau]"}]]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"springkineticC", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"springkineticC", "::", "argnum"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
     ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"place", "[", 
    RowBox[{"length_", ",", "placed_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"placed", ">", "length"}], ",", 
     RowBox[{"placed", "-", "length"}], ",", 
     RowBox[{"0", "<", "placed", "\[LessEqual]", "length"}], ",", "placed", 
     ",", 
     RowBox[{"placed", "\[LessEqual]", "0"}], ",", 
     RowBox[{"placed", "+", "length"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"place", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"place", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalVariate", "[", 
    RowBox[{"\[Mu]_", ",", "\[Sigma]_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", "dimensionality"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalVariate", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"normalVariate", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleBeadDisplace", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "part", ",", "shuffledistance", ",", "temppath", ",", "temppos", ",", 
       "acold", ",", "acnew", ",", "acceptprob"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"shuffledistance", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", "part", "]"}], "]"}], ")"}]}]}], "}"}], "]"}]}], 
      ";", 
      RowBox[{"temppath", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RotateLeft", "[", 
          RowBox[{"#", ",", "shuffledistance"}], "]"}], "&"}], "/@", 
        "path"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", "temppath"}], ";", 
      RowBox[{
       RowBox[{"temppos", "[", 
        RowBox[{"[", 
         RowBox[{"part", ",", "2"}], "]"}], "]"}], "+=", 
       RowBox[{"normalVariate", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}], ",", 
         "dimensionality"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"acold", "=", 
       RowBox[{
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}],
          "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}],
          "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "3"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"acnew", "=", 
       RowBox[{
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}], 
         "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}], 
         "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "3"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"acceptprob", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"acnew", "-", "acold"}], ")"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
       "*", "1", " ", "for", " ", "Bayesian", " ", "prob", " ", "of", " ", 
        "going", " ", "this", " ", "way", " ", "vs", " ", "the", " ", 
        RowBox[{"other", ":", " ", 
         RowBox[{
         "needs", " ", "modifying", " ", "when", " ", "change", " ", 
          "dist"}]}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"acceptprob", ">", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "temppath"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"singleBeadDisplace", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"singleBeadDisplace", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleElectronDisplace", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "part", ",", "shuffle", ",", "temppos", ",", "temppost", ",", "enold", 
       ",", "ennew", ",", "acceptprob"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"shuffle", "=", 
       RowBox[{"normalVariate", "[", 
        RowBox[{"0", ",", 
         RowBox[{"10", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
         "dimensionality"}], "]"}]}], ";", 
      RowBox[{"temppost", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "+", "shuffle"}], ")"}], "&"}], "/@", 
        RowBox[{"path", "[", 
         RowBox[{"[", "part", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"path", ",", 
         RowBox[{"part", "\[Rule]", "temppost"}]}], "]"}]}], ";", 
      RowBox[{"enold", "=", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"bead", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"path", "[", 
              RowBox[{"[", "part", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], ";", 
      RowBox[{"ennew", "=", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"bead", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"temppos", "[", 
              RowBox[{"[", "part", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], ";", 
      RowBox[{"acceptprob", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
       "*", "1", " ", "for", " ", "Bayesian", " ", "prob", " ", "of", " ", 
        "going", " ", "this", " ", "way", " ", "vs", " ", "the", " ", 
        RowBox[{"other", ":", " ", 
         RowBox[{
         "needs", " ", "modifying", " ", "when", " ", "change", " ", 
          "dist"}]}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"acceptprob", ">", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "path"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"singleElectronDisplace", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"singleElectronDisplace", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMover", "[", 
    RowBox[{"path_", ",", 
     RowBox[{"places_", "?", "VectorQ"}], ",", "\[Lambda]_", ",", "\[Tau]_", 
     ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"path", "[", 
       RowBox[{"[", 
        RowBox[{"places", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
      RowBox[{"path", "[", 
       RowBox[{"[", 
        RowBox[{"places", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "2"], "+", 
    RowBox[{"normalVariate", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}], ",", "dimensionality"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bisectionMover", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"bisectionMover", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoverC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"path", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"places", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"dimensionality", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"path", "[", 
          RowBox[{"[", 
           RowBox[{"places", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
         RowBox[{"path", "[", 
          RowBox[{"[", 
           RowBox[{"places", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "2"], "+", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}]}], "]"}], ",", 
         "dimensionality"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bisectionMoverC", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"bisectionMoverC", "::", "argnum"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
     ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMove", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l", ",", "part", ",", "shuffledistance", ",", "temppath", ",", 
       "temppos", ",", "range", ",", "newrange", ",", "sets", ",", 
       "movedparticles", ",", "enold", ",", "ennew", ",", "acceptprob", ",", 
       "complete", ",", "rand", ",", "probofmove"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"shuffledistance", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", "part", "]"}], "]"}], ")"}]}]}], "}"}], "]"}]}], 
      ";", 
      RowBox[{"temppath", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RotateLeft", "[", 
          RowBox[{"#", ",", "shuffledistance"}], "]"}], "&"}], "/@", 
        "path"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Floor", "@", 
           RowBox[{"Log2", "[", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"path", "[", 
               RowBox[{"[", "part", "]"}], "]"}]}], "-", "1"}], "]"}]}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", "temppath"}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"complete", "=", 
       RowBox[{"Catch", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"l", "-", "1"}]}], ",", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", 
                  RowBox[{"{", "range", "}"}]}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{"range", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "+", "1"}], ",", 
                  SuperscriptBox["2", "i"]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", "range"}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    SuperscriptBox["2", "i"]}], "]"}], "&"}], "/@", "range"}],
                   ",", "1"}], "]"}]}]}]}], "]"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"temppos", "[", 
                 RowBox[{"[", 
                  RowBox[{"part", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                RowBox[{"bisectionMoverC", "[", 
                 RowBox[{
                  RowBox[{"temppos", "[", 
                   RowBox[{"[", "part", "]"}], "]"}], ",", "#", ",", 
                  "\[Lambda]", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "\[Tau]"}], ",", 
                  "dimensionality"}], "]"}]}], ")"}], "&"}], "/@", "sets"}], 
            ";", 
            RowBox[{"range", "=", "newrange"}], ";", 
            RowBox[{"movedparticles", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "sets"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"enold", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{"temppath", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ennew", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{"temppos", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"acceptprob", "=", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}], "&"}], "/@", 
                 RowBox[{"(", "acceptprob", ")"}]}], ",", "TrueQ"}], "]"}], 
              ",", 
              RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ";", 
            RowBox[{"temppath", "=", "temppos"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"l", "-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "True"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"complete", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"probofmove", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"2", "\[Lambda]", " ", 
                  SuperscriptBox["2", "i"], "\[Tau]"}]], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Norm", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "2"], "-", 
                    RowBox[{"temppos", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "]"}], "2"], "-", 
                  SuperscriptBox[
                   RowBox[{"Norm", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "2"], "-", 
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "]"}], "2"]}], ")"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"enold", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{
                "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",",
                  "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",",
                  "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 RowBox[{"bead", "+", "1"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"bead", ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ennew", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{
                "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 RowBox[{"bead", "+", "1"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"bead", ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], "}"}]}], 
             "]"}]}], ";", 
           RowBox[{"acceptprob", "=", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"acceptprob", "=", 
            RowBox[{"acceptprob", "*", "probofmove"}]}], ";", 
           RowBox[{"complete", "=", 
            RowBox[{"AllTrue", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", ">", 
                  RowBox[{"RandomReal", "[", "]"}]}], ")"}], "&"}], "/@", 
               "acceptprob"}], ",", "TrueQ"}], "]"}]}], ";"}]}], "]"}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"complete", ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "path"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bisectionMove", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"bisectionMove", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoveStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "joined_", ",", 
     "maxcyclelength_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "beads", ",", "l", ",", "part", ",", "shuffledistance", ",", "temppath",
        ",", "temppos", ",", "range", ",", "newrange", ",", "sets", ",", 
       "movedparticles", ",", "enold", ",", "ennew", ",", "acceptprob", ",", 
       "complete", ",", "rand", ",", "probofmove", ",", "newjoined", ",", 
       "cyclelength"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"beads", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"path", "[", 
         RowBox[{"[", "part", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"shuffledistance", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "beads"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temppath", "=", "path"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "shuffledistance"}], ",", 
          RowBox[{
           RowBox[{"temppath", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"joined", "[", "i", "]"}], ",", 
              RowBox[{"j", "-", "shuffledistance", "-", "1"}]}], "]"}], "]"}],
            "=", 
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"temppath", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "-", "shuffledistance"}]}], "]"}], "]"}], "=", 
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "beads"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyclelength", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Min", "[", 
           RowBox[{"maxcyclelength", ",", 
            RowBox[{"Length", "@", "path"}]}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newjoined", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cyclelength", "\[Equal]", "1"}], ",", "joined", ",", 
         RowBox[{"permutationSampler", "[", 
          RowBox[{
          "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "joined", ",", 
           "cyclelength", ",", "beads"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Floor", "@", 
           RowBox[{"Log2", "[", 
            RowBox[{"beads", "-", "1"}], "]"}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", "temppath"}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"complete", "=", 
       RowBox[{"Catch", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"l", "-", "1"}]}], ",", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", 
                  RowBox[{"{", "range", "}"}]}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{"range", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "+", "1"}], ",", 
                  SuperscriptBox["2", "i"]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", "range"}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    SuperscriptBox["2", "i"]}], "]"}], "&"}], "/@", "range"}],
                   ",", "1"}], "]"}]}]}]}], "]"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"temppos", "[", 
                 RowBox[{"[", 
                  RowBox[{"part", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                RowBox[{"bisectionMoverC", "[", 
                 RowBox[{
                  RowBox[{"temppos", "[", 
                   RowBox[{"[", "part", "]"}], "]"}], ",", "#", ",", 
                  "\[Lambda]", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "\[Tau]"}], ",", 
                  "dimensionality"}], "]"}]}], ")"}], "&"}], "/@", "sets"}], 
            ";", 
            RowBox[{"range", "=", "newrange"}], ";", 
            RowBox[{"movedparticles", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "sets"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"enold", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1beadStatisticsC", "[", 
                RowBox[{"temppath", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"Values", "@", "newjoined"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ennew", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1beadStatisticsC", "[", 
                RowBox[{"temppos", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"Values", "@", "newjoined"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"acceptprob", "=", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}], "&"}], "/@", 
                 RowBox[{"(", "acceptprob", ")"}]}], ",", "TrueQ"}], "]"}], 
              ",", 
              RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ";", 
            RowBox[{"temppath", "=", "temppos"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"l", "-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "True"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"complete", ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos", ",", "newjoined"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "path", ",", "joined"}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bisectionMoveStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"bisectionMoveStatistics", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"permutationSampler", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "joined_", ",", 
     "cyclelength_", ",", "beads_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "places", ",", "parts", ",", "position", ",", "ttransvector", ",", 
       "tdirvector", ",", "hvector", ",", "tempjoined", ",", "harr"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"places", "=", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", "path"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tempjoined", "=", "joined"}], ";", "\[IndentingNewLine]", 
      RowBox[{"parts", "=", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"position", "=", 
             RowBox[{"places", "[", 
              RowBox[{"[", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "@", "places"}]}], "}"}], "]"}], "]"}], 
              "]"}]}], ";", 
            RowBox[{"Sow", "[", "position", "]"}], ";", 
            RowBox[{"places", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"places", ",", 
               RowBox[{"Position", "[", 
                RowBox[{"places", ",", "position"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Length", "@", "path"}], ",", "cyclelength"}], "]"}]}],
             "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tempjoined", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "=", 
          RowBox[{"joined", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"parts", ",", 
           RowBox[{"{", 
            RowBox[{"parts", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", "2", ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ttransvector", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"springkineticC", "[", 
             RowBox[{
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
              ",", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"joined", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[Lambda]", ",", 
              RowBox[{"\[Tau]", " ", 
               RowBox[{"N", "[", "beads", "]"}]}]}], "]"}]}], "]"}], "&"}], 
         ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"parts", ",", 
             RowBox[{"{", 
              RowBox[{"parts", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", "2", ",", 
           "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tdirvector", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"springkineticC", "[", 
             RowBox[{
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
              ",", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"joined", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[Lambda]", ",", 
              RowBox[{"\[Tau]", " ", 
               RowBox[{"N", "[", "beads", "]"}]}]}], "]"}]}], "]"}], "&"}], 
         ",", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
            RowBox[{"Normal", "@", "joined"}]}], "]"}], "[", 
          RowBox[{"[", "parts", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"harr", "[", "i_", "]"}], ":=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"springkineticC", "[", 
             RowBox[{
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[Lambda]", ",", 
              RowBox[{"\[Tau]", " ", 
               RowBox[{"N", "[", "beads", "]"}]}]}], "]"}]}], "]"}], "&"}], 
         ",", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "path"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hvector", "=", 
       RowBox[{"Total", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"harr", "[", "#", "]"}], "&"}], ",", "parts"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RandomReal", "[", "]"}], "<", 
         FractionBox[
          RowBox[{"Total", "[", 
           RowBox[{"hvector", "/", "tdirvector"}], "]"}], 
          RowBox[{"Total", "[", 
           RowBox[{"hvector", "/", "ttransvector"}], "]"}]]}], ",", 
        "tempjoined", ",", "joined"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permutationSampler", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"permutationSampler", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1bead", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["\[Tau]", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"extV", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"particle", ",", 
           RowBox[{"place", "[", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"path", "[", 
               RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
             RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], "]"}], "+", 
       RowBox[{"extV", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], ")"}]}], 
    RowBox[{"(*", 
     RowBox[{"\[Tau]", " ", 
      RowBox[{"extV", "[", 
       RowBox[{"path", "[", 
        RowBox[{"[", 
         RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{"\[Tau]", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"extV", "[", 
         RowBox[{
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", 
             RowBox[{"place", "[", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"path", "[", 
                 RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
               RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
            ")"}], "s"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
          "}"}]}]}], "]"}]}], "*)"}], "+", 
    RowBox[{"(*", 
     RowBox[{
      FractionBox["\[Tau]", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"intpartV", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", "path"}], ",", 
                  RowBox[{"particle", "+", "j"}]}], "]"}], ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], "]"}]}],
         "+", 
        RowBox[{"Total", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"intpartV", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", "path"}], ",", 
                  RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], 
               "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
          "]"}]}]}], ")"}]}], "*)"}], 
    RowBox[{"\[Tau]", " ", 
     RowBox[{"Total", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"intpartV", "[", 
         RowBox[{
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"place", "[", 
              RowBox[{
               RowBox[{"Length", "@", "path"}], ",", 
               RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], "]"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potentialAction1bead", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"potentialAction1bead", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead_", ",", "joined_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["\[Tau]", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"bead", "\[Equal]", "1"}], ",", 
         RowBox[{"extV", "[", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"joined", "[", "particle", "]"}], ",", 
             RowBox[{"Length", "@", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{"joined", "[", "particle", "]"}], "]"}], "]"}]}]}], 
            "]"}], "]"}], "]"}], ",", 
         RowBox[{"extV", "[", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", 
             RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "]"}]}], "]"}], "+", 
       RowBox[{"extV", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], ")"}]}], 
    "+", 
    RowBox[{"\[Tau]", " ", 
     RowBox[{"Total", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"intpartV", "[", 
         RowBox[{
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"place", "[", 
              RowBox[{
               RowBox[{"Length", "@", "path"}], ",", 
               RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], "]"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potentialAction1beadStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"potentialAction1beadStatistics", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction1bead", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead_"}], "]"}], ":=", 
   RowBox[{"springkinetic", "[", 
    RowBox[{
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
          RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead"}], "]"}]}], 
       "]"}], "]"}], ",", "\[Lambda]", ",", "\[Tau]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticAction1bead", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"kineticAction1bead", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction2bead", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead1_", ",", "bead2_"}], "]"}], ":=", 
   RowBox[{"springkinetic", "[", 
    RowBox[{
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead1"}], "]"}]}], 
       "]"}], "]"}], ",", 
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead2"}], "]"}]}], 
       "]"}], "]"}], ",", "\[Lambda]", ",", "\[Tau]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticAction2bead", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"kineticAction2bead", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticActionOffset", "[", 
    RowBox[{
    "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", "numslices_", 
     ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", "numparticles", " ", "numslices"}], "2"], 
      RowBox[{"Log", "[", 
       RowBox[{"4", "\[Pi]", " ", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
     RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
     RowBox[{"numparticles", " ", "numslices", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"2", "\[Pi]", " ", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticActionOffset", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"kineticActionOffset", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
         RowBox[{"vprime", "[", 
          RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"virialTotalEnergyEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"virialTotalEnergyEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", 
              RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
           RowBox[{"vprime", "[", 
            RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"virialTotalEnergySquaredEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"virialTotalEnergySquaredEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
         RowBox[{"vprime", "[", 
          RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1beadStatisticsC", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
          ",", 
          RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"virialTotalEnergyEstimatorStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"virialTotalEnergyEstimatorStatistics", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", 
              RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
           RowBox[{"vprime", "[", 
            RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1beadStatisticsC", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
            ",", 
            RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "virialTotalEnergySquaredEstimatorStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "::", "argnum"}],
       ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]"}]], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"part", ",", 
              RowBox[{"place", "[", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"path", "[", 
                  RowBox[{"[", "part", "]"}], "]"}]}], ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], "]"}], 
         "2"], 
        RowBox[{"4", "\[Lambda]", " ", 
         SuperscriptBox["\[Tau]", "2"]}]], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thermTotalEnergyEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"thermTotalEnergyEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]"}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "part", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
            "]"}], "2"], 
          RowBox[{"4", "\[Lambda]", " ", 
           SuperscriptBox["\[Tau]", "2"]}]], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thermTotalEnergySquaredEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"thermTotalEnergySquaredEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]"}]], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"bead", "\[Equal]", "1"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], 
         "2"], 
        RowBox[{"4", "\[Lambda]", " ", 
         SuperscriptBox["\[Tau]", "2"]}]], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1beadStatisticsC", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
          ",", 
          RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thermTotalEnergyEstimatorStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"thermTotalEnergyEstimatorStatistics", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]"}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"bead", "\[Equal]", "1"}], ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{"part", ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], "]"}]}], 
            "]"}], "2"], 
          RowBox[{"4", "\[Lambda]", " ", 
           SuperscriptBox["\[Tau]", "2"]}]], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1beadStatisticsC", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
            ",", 
            RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "[", "args___", "]"}],
   ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "::", "argnum"}], 
      ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
         RowBox[{"vprime", "[", 
          RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", " ", "numparticles", " ", "numslices", " ", 
          SuperscriptBox["\[Tau]", "2"], "\[Lambda]"}]], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"bead", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", 
                 RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
              "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", 
                 RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
              "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
         "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1beadStatisticsC", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
          ",", 
          RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "::", "argnum"}], 
      ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergySquaredEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", 
              RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
           RowBox[{"vprime", "[", 
            RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"4", " ", "numparticles", "  ", "numslices", " ", 
            SuperscriptBox["\[Tau]", "2"], "\[Lambda]"}]], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"bead", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", 
                   RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
                "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", 
                   RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{"part", ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
                "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
           "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1beadStatisticsC", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
            ",", 
            RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "fullVirialTotalEnergySquaredEstimatorStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{
      "fullVirialTotalEnergySquaredEstimatorStatistics", "::", "argnum"}], 
      ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeTotalEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"heinzeKineticEnergyEstimator", "[", 
       RowBox[{
       "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
        "numslices", ",", "dimensionality"}], "]"}], "+", 
      RowBox[{"heinzePotentialEnergyEstimator", "[", 
       RowBox[{
       "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
        "numslices", ",", "dimensionality"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heinzeTotalEnergyEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"heinzeTotalEnergyEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeKineticEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairDist", ",", "particleDist"}], "}"}], ",", 
     RowBox[{
      RowBox[{"pairDist", "=", 
       RowBox[{"heinzePairDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{"particleDist", "=", 
       RowBox[{"heinzeParticleDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numparticles", ">", "1"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"numparticles", "-", "1"}], 
           RowBox[{"4", 
            RowBox[{"Length", "@", "pairDist"}]}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pairDist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"derivIntpartV", "[", 
              RowBox[{
               RowBox[{"pairDist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "pairDist"}]}], "}"}]}], "]"}]}], ",", 
         "0"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"Length", "@", "particleDist"}]}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"particleDist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ".", 
           RowBox[{"derivExtV", "[", 
            RowBox[{"particleDist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "particleDist"}]}], "}"}]}], "]"}]}]}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heinzeKineticEnergyEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"heinzeKineticEnergyEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePotentialEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairDist", ",", "particleDist"}], "}"}], ",", 
     RowBox[{
      RowBox[{"pairDist", "=", 
       RowBox[{"heinzePairDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{"particleDist", "=", 
       RowBox[{"heinzeParticleDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numparticles", ">", "1"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"numparticles", "-", "1"}], 
           RowBox[{"2", 
            RowBox[{"Length", "@", "pairDist"}]}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"intpartV", "[", 
             RowBox[{
              RowBox[{"pairDist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "pairDist"}]}], "}"}]}], "]"}]}], ",", 
         "0"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"Length", "@", "particleDist"}]}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"extV", "[", 
           RowBox[{"particleDist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "particleDist"}]}], "}"}]}], "]"}]}]}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heinzePotentialEnergyEstimator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"heinzePotentialEnergyEstimator", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePairDist", "[", 
    RowBox[{"path_", ",", "numparticles_", ",", "numslices_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Transpose", "@", "path"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heinzePairDist", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"heinzePairDist", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeParticleDist", "[", 
    RowBox[{"path_", ",", "numparticles_", ",", "numslices_"}], "]"}], ":=", 
   RowBox[{"Join", "@@", "path"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heinzeParticleDist", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"heinzeParticleDist", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialPlot", "[", 
    RowBox[{"path_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", "zmin", ",", 
       "zmax"}], "}"}], ",", 
     RowBox[{
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"xmax", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"ymin", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"ymax", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"zmin", "=", 
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{
             RowBox[{"Catenate", "@", "path"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{"zmax", "=", 
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{
             RowBox[{"Catenate", "@", "path"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{"SliceDensityPlot3D", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"extV", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], 
           RowBox[{"extV", "[", 
            RowBox[{"{", 
             RowBox[{"xmax", ",", "ymax", ",", "zmax"}], "}"}], "]"}]], ",", 
          "\"\<BackPlanes\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
        RowBox[{"DensityPlot", "[", 
         RowBox[{
          RowBox[{"extV", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ","}], 
           "*)"}], 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ymax", "-", "ymin"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potentialPlot", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"potentialPlot", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPlot", "[", 
    RowBox[{
    "energyVirial_", ",", "energyFullVirial_", ",", "energyTherm_", ",", 
     "energyHeinze_", ",", "energysaverarrayvirial_", ",", 
     "energysaverarrayfullvirial_", ",", "energysaverarraytherm_", ",", 
     "energysaverarrayheinze_", ",", "invvarvirial_", ",", 
     "invvarfullvirial_", ",", "invvartherm_", ",", "invvarheinze_", ",", 
     "equilibrationsteps_", ",", "numsteps_", ",", "harmonictrap_", ",", 
     "\[Omega]_", ",", "\[Tau]_", ",", "slices_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", "energysaverarrayvirial"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", "energysaverarrayfullvirial"}], 
          "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", "energysaverarraytherm"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", "energysaverarrayheinze"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"GridLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           FractionBox["equilibrationsteps", "numsteps"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"If", "[", 
            RowBox[{"harmonictrap", ",", 
             RowBox[{"exactHarmonicTrapEnergies", "[", 
              RowBox[{
              "15", ",", "\[Tau]", ",", "slices", ",", "\[Omega]", ",", 
               "dimensionality"}], "]"}], ",", "0"}], "]"}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Fractional step\>\"", ",", "\"\<Energy\>\""}], "}"}]}], 
       ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Energy per particle\>\""}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", "Blue", ",", 
          RowBox[{"Darker", "@", "Green"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"energyVirial", ",", "\"\<Virial\>\"", ",", "\"\<\>\""}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
           "energyFullVirial", ",", "\"\<Ceperley Virial\>\"", ",", 
            "\"\<\>\""}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
           "energyTherm", ",", "\"\<Thermodynamic\>\"", ",", "\"\<\>\""}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"energyHeinze", ",", "\"\<Heinze\>\"", ",", "\"\<\>\""}], 
           "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "virialEnergy", ",", "virialError", ",", "fullVirialEnergy", ",", 
         "fullVirialError", ",", "thermEnergy", ",", "thermError", ",", 
         "heinzeEnergy", ",", "heinzeError"}], "}"}], ",", 
       RowBox[{
        RowBox[{"virialEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", 
           FractionBox[
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"energysaverarrayvirial", "*", "invvarvirial"}], ")"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", "invvarvirial", ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "Null"}],
           "]"}]}], ";", 
        RowBox[{"virialError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", " ", 
           FractionBox["1", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", "invvarvirial", ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]], ",", 
           "Null"}], "]"}]}], ";", 
        RowBox[{"fullVirialEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", 
           FractionBox[
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "energysaverarrayfullvirial", "*", "invvarfullvirial"}], ")"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", "invvarfullvirial", ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "Null"}],
           "]"}]}], ";", 
        RowBox[{"fullVirialError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", " ", 
           FractionBox["1", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", "invvarfullvirial", ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]], ",", 
           "Null"}], "]"}]}], ";", 
        RowBox[{"thermEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", 
           FractionBox[
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"energysaverarraytherm", "*", "invvartherm"}], ")"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", "invvartherm", ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "Null"}],
           "]"}]}], ";", 
        RowBox[{"thermError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", " ", 
           FractionBox["1", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", "invvartherm", ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]], ",", 
           "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"heinzeEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", 
           RowBox[{"Mean", "@", 
            RowBox[{"energysaverarrayheinze", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "Null"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"heinzeError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", 
           FractionBox[
            RowBox[{"StandardDeviation", "@", 
             RowBox[{"energysaverarrayheinze", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Length", "@", 
              RowBox[{"energysaverarrayheinze", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]], ",", "Null"}], 
          "]"}]}], ";", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"virialEnergy", ",", 
            RowBox[{"virialEnergy", "+", "virialError"}], ",", 
            RowBox[{"virialEnergy", "-", " ", "virialError"}], ",", 
            "fullVirialEnergy", ",", 
            RowBox[{"fullVirialEnergy", "+", "fullVirialError"}], ",", 
            RowBox[{"fullVirialEnergy", "-", " ", "fullVirialError"}], ",", 
            "thermEnergy", ",", 
            RowBox[{"thermEnergy", "+", "thermError"}], ",", 
            RowBox[{"thermEnergy", "-", "thermError"}], ",", "heinzeEnergy", 
            ",", 
            RowBox[{"heinzeEnergy", "+", "heinzeError"}], ",", 
            RowBox[{"heinzeEnergy", "-", "heinzeError"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            FractionBox["equilibrationsteps", "numsteps"], ",", "1"}], "}"}], 
          ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"energyVirial", ",", " ", "Red", ",", "None"}], "]"}], 
             ",", "None", ",", "None", ",", 
             RowBox[{"If", "[", 
              RowBox[{"energyFullVirial", ",", 
               RowBox[{"Darker", "@", "Red"}], ",", "None"}], "]"}], ",", 
             "None", ",", "None", ",", 
             RowBox[{"If", "[", 
              RowBox[{"energyTherm", ",", "Blue", ",", "None"}], "]"}], ",", 
             "None", ",", "None", ",", 
             RowBox[{"If", "[", 
              RowBox[{"energyHeinze", ",", 
               RowBox[{"Darker", "@", "Green"}], ",", "None"}], "]"}], ",", 
             "None", ",", "None"}], "}"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "2", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", 
                   RowBox[{"Lighter", "@", "Red"}]}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"6", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "5", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", "Red"}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"9", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "8", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", 
                   RowBox[{"Lighter", "@", "Blue"}]}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"12", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "11", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", "Green"}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}]}],
             "}"}]}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyTherm", ",", 
         RowBox[{"Style", "@@@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"energysaverarraytherm", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PointSize", "[", 
                 RowBox[{"0.025", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "10"}], "/", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@",
                "invvartherm"}], ")"}]}], "}"}], "]"}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Darker", "@", "Blue"}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyVirial", ",", 
         RowBox[{"Style", "@@@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"energysaverarrayvirial", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PointSize", "[", 
                 RowBox[{"0.025", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "10"}], "/", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@",
                "invvarvirial"}], ")"}]}], "}"}], "]"}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Darker", "@", "Red"}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyFullVirial", ",", 
         RowBox[{"Style", "@@@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"energysaverarrayfullvirial", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PointSize", "[", 
                 RowBox[{"0.025", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "10"}], "/", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@",
                "invvarfullvirial"}], ")"}]}], "}"}], "]"}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Red"}]}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", "energysaverarrayvirial"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", "energysaverarrayfullvirial"}], 
          "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", "energysaverarraytherm"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", "energysaverarrayheinze"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", "Blue", ",", 
          RowBox[{"Darker", "@", "Green"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyPlot", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"energyPlot", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathPlot", "[", 
    RowBox[{"path_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPointPlot3D", "[", 
        RowBox[{"path", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"Graphics3D", "@", 
        RowBox[{"Line", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", "path"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "#", "]"}], ",", "1"}], "]"}], "]"}],
                "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "path"}]}]}], "}"}]}], "]"}]}]}]}]}], 
      "]"}], ",", 
     RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{"path", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"Graphics", "@", 
        RowBox[{"Line", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", "path"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "#", "]"}], ",", "1"}], "]"}], "]"}],
                "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "path"}]}]}], "}"}]}], "]"}]}]}]}]}], 
      "]"}], ",", "True", ",", 
     RowBox[{
     "Throw", "[", "\"\<Unknown dimensionality in pathPlot\>\"", "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathPlot", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"pathPlot", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyVirial", "[", 
    RowBox[{"energysaverarrayvirial_", ",", "invvarvirial_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Virial weighted estimator of the energy per particle                \
: \>\"", ",", 
     FractionBox[
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"energysaverarrayvirial", "*", "invvarvirial"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", "invvarvirial", ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "\"\<+/-\>\"", 
     ",", " ", 
     FractionBox["1", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", "invvarvirial", ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"printEnergyVirial", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"printEnergyVirial", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyFullVirial", "[", 
    RowBox[{"energysaverarrayvirial_", ",", "invvarvirial_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Ceperley virial weighted estimator of the energy per particle       \
: \>\"", ",", 
     FractionBox[
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"energysaverarrayvirial", "*", "invvarvirial"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", "invvarvirial", ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "\"\<+/-\>\"", 
     ",", " ", 
     FractionBox["1", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", "invvarvirial", ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"printEnergyFullVirial", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"printEnergyFullVirial", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyTherm", "[", 
    RowBox[{"energysaverarraytherm_", ",", "invvartherm_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Thermodynamic weighted estimator of the energy per particle         \
: \>\"", ",", 
     FractionBox[
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"energysaverarraytherm", "*", "invvartherm"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", "invvartherm", ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "\"\<+/-\>\"", 
     ",", " ", 
     FractionBox["1", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", "invvartherm", ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"printEnergyTherm", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"printEnergyTherm", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyHeinze", "[", "energysaverarrayheinze_", "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Heinze (unweighted) estimator of the energy per particle            \
: \>\"", ",", 
     RowBox[{"Mean", "@", 
      RowBox[{"energysaverarrayheinze", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "\"\<+/-\>\"", ",", 
     FractionBox[
      RowBox[{"StandardDeviation", "@", 
       RowBox[{"energysaverarrayheinze", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Length", "@", 
        RowBox[{"energysaverarrayheinze", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"printEnergyHeinze", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"printEnergyHeinze", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"autocorrelationPlot", "[", 
    RowBox[{
    "energyVirial_", ",", "energyFullVirial_", ",", "energyTherm_", ",", 
     "energyHeinze_", ",", "energysaverarrayvirial_", ",", 
     "energysaverarrayfullvirial_", ",", "energysaverarraytherm_", ",", 
     "energysaverarrayheinze_", ",", "observablecalc_"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyVirial", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarrayvirial", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarrayvirial"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"energyFullVirial", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarrayfullvirial", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarrayfullvirial"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"energyTherm", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarraytherm", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarraytherm"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"energyHeinze", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarrayheinze", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarrayheinze"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "}"}],
      ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Darker", "@", "Red"}], ",", "Blue", ",", 
        RowBox[{"Darker", "@", "Green"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"energyVirial", ",", "\"\<Virial\>\"", ",", "\"\<\>\""}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
         "energyFullVirial", ",", "\"\<Ceperley Virial\>\"", ",", 
          "\"\<\>\""}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
         "energyTherm", ",", "\"\<Thermodynamic\>\"", ",", "\"\<\>\""}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyHeinze", ",", "\"\<Heinze\>\"", ",", "\"\<\>\""}], 
         "]"}]}], "}"}]}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", "\"\<Autocorrelation in the energy\>\""}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Step number\>\"", ",", "\"\<Correlation\>\""}], "}"}]}], 
     ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"autocorrelationPlot", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"autocorrelationPlot", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapEnergies", "[", 
    RowBox[{
    "maxval_", ",", "\[Tau]_", ",", "slices_", ",", "\[Omega]_", ",", 
     "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tableofenergies", ",", "tableofoccupations", ",", "\[Psi]", ",", 
       "tableofwfns"}], "}"}], ",", 
     RowBox[{
      RowBox[{"tableofenergies", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", 
             FractionBox["dimensionality", "2"]}], ")"}], "\[Omega]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"dimensionality", "+", "n", "-", "1"}], ",", "n"}], 
             "]"}]}], "}"}]}], "]"}]}]}], ";", 
      RowBox[{"tableofoccupations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[Tau]"}], " ", "slices", " ", "#"}], "]"}], "&"}], "/@",
         "tableofenergies"}]}], ";", 
      FractionBox[
       RowBox[{"Total", "@", 
        RowBox[{"(", 
         RowBox[{"tableofoccupations", "*", "tableofenergies"}], ")"}]}], 
       RowBox[{"Total", "@", "tableofoccupations"}]]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exactHarmonicTrapEnergies", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"exactHarmonicTrapEnergies", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapWfns", "[", 
    RowBox[{
    "maxval_", ",", "\[Tau]_", ",", "slices_", ",", "\[Omega]_", ",", 
     "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tableofenergies", ",", "tableofoccupations", ",", "\[Psi]", ",", 
       "tableofwfns"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"tableofenergies", "=", 
          RowBox[{"Join", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", 
                FractionBox["dimensionality", "2"]}], ")"}], "\[Omega]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"dimensionality", "+", "n", "-", "1"}], ",", "n"}], 
                "]"}]}], "}"}]}], "]"}]}]}], ";", 
         RowBox[{"tableofoccupations", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Tau]"}], " ", "slices", " ", "#"}], "]"}], 
            "&"}], "/@", "tableofenergies"}]}], ";", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{
           "n_", ",", "l_", ",", "m_", ",", "r_", ",", "\[Theta]_", ",", 
            "\[Phi]_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            FractionBox[
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{"n", "+", "l", "+", "2"}]], 
              SuperscriptBox["\[Omega]", 
               RowBox[{"l", "+", 
                RowBox[{"3", "/", "2"}]}]]}], 
             SuperscriptBox["\[Pi]", 
              RowBox[{"1", "/", "2"}]]], "]"}], 
           RowBox[{"Sqrt", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"Factorial", "[", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"n", "-", "l"}], ")"}]}], "]"}], 
              RowBox[{"Factorial", "[", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"n", "+", "l"}], ")"}]}], "]"}]}], 
             RowBox[{"Factorial", "[", 
              RowBox[{"n", "+", "l", "+", "1"}], "]"}]], "]"}], 
           SuperscriptBox["r", "l"], 
           RowBox[{"Exp", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "1"}], "2"], "\[Omega]", " ", 
             SuperscriptBox["r", "2"]}], "]"}], 
           RowBox[{"LaguerreL", "[", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], 
              RowBox[{"(", 
               RowBox[{"n", "-", "l"}], ")"}]}], ",", 
             RowBox[{"l", "+", 
              FractionBox["1", "2"]}], ",", 
             RowBox[{"\[Omega]", " ", 
              SuperscriptBox["r", "2"]}]}], "]"}], 
           RowBox[{"SphericalHarmonicY", "[", 
            RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], 
            "]"}]}]}], ";", 
         RowBox[{
          RowBox[{"tableofwfns", "[", "x_", "]"}], "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"Total", "[", "tableofoccupations", "]"}]], 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   RowBox[{"\[Psi]", "[", 
                    RowBox[{"n", ",", "l", ",", "m", ",", "x", ",", 
                    FractionBox["\[Pi]", "2"], ",", "0"}], "]"}], "]"}], "2"],
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "n", ",", "0", ",", 
                   RowBox[{"-", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}]}], ")"}], 
             "*", "tableofoccupations"}], "]"}]}]}], ";"}], ",", 
        RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
        RowBox[{
         RowBox[{"tableofenergies", "=", 
          RowBox[{"Join", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", 
                FractionBox["dimensionality", "2"]}], ")"}], "\[Omega]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n", ",", "0", ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}]}]}], ";", 
         RowBox[{"tableofoccupations", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Tau]"}], " ", "slices", " ", "#"}], "]"}], 
            "&"}], "/@", "tableofenergies"}]}], ";", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"n_", ",", "m_", ",", "r_", ",", "\[Theta]_"}], "]"}], ":=", 
          RowBox[{
           FractionBox[
            RowBox[{"Sqrt", "[", 
             SuperscriptBox["\[Omega]", 
              RowBox[{"m", "+", "1"}]], "]"}], 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"n", "-", "m"}], "2"], ")"}], "!"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"n", "+", "m"}], "2"], ")"}], "!"}], ")"}], 
              "\[Pi]"}], "]"}]], 
           SuperscriptBox["r", "m"], 
           RowBox[{"HypergeometricU", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"m", "-", "n"}], "2"], ",", 
             RowBox[{"1", "+", "m"}], ",", 
             SuperscriptBox["r", "2"]}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "1"}], "2"], "\[Omega]", " ", 
             SuperscriptBox["r", "2"]}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Theta]"}], "]"}]}]}], 
         ";", 
         RowBox[{
          RowBox[{"tableofwfns", "[", "x_", "]"}], "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"Total", "[", "tableofoccupations", "]"}]], 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   RowBox[{"\[Psi]", "[", 
                    RowBox[{"n", ",", "m", ",", "x", ",", "0"}], "]"}], "]"}],
                   "2"], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n", ",", "0", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ")"}], "*", 
             "tableofoccupations"}], "]"}]}]}], ";"}]}], "]"}], ";", 
      FractionBox[
       RowBox[{"tableofwfns", "[", "x", "]"}], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"tableofwfns", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", "10"}], "/", 
            RowBox[{"Sqrt", "[", "\[Omega]", "]"}]}], ",", 
           RowBox[{"10", "/", 
            RowBox[{"Sqrt", "[", "\[Omega]", "]"}]}]}], "}"}]}], "]"}]]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exactHarmonicTrapWfns", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"exactHarmonicTrapWfns", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyArrayMaker", "[", 
    RowBox[{
     RowBox[{"energyassoc_", "?", "AssociationQ"}], ",", 
     RowBox[{"energysquaredassoc_", "?", "AssociationQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "energysavearray", ",", "energysquaredsavearray", ",", 
       "inversevariancearray"}], "}"}], ",", 
     RowBox[{
      RowBox[{"energysavearray", "=", 
       RowBox[{"Values", "@", "energyassoc"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"energyassoc", "[", 
          RowBox[{"[", 
           RowBox[{"Key", "[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "energyassoc", "]"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energysquaredsavearray", "=", 
       RowBox[{"Values", "@", "energysquaredassoc"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"energysquaredassoc", "[", 
          RowBox[{"[", 
           RowBox[{"Key", "[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "energysquaredassoc", "]"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inversevariancearray", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            FractionBox["1", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
              SuperscriptBox[
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"]}]]}], "}"}], 
          ")"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"energysavearray", ",", "energysquaredsavearray"}], "}"}], 
         "]"}]}]}], ";", 
      RowBox[{"{", 
       RowBox[{"energysavearray", ",", "inversevariancearray"}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyArrayMaker", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"energyArrayMaker", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMaker", "[", 
    RowBox[{
    "step_", ",", "numsteps_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", 
     "numparticles_", ",", "numslices_", ",", "path_", ",", "dimensionality_",
      ",", 
     RowBox[{"type_:", "\"\<virial\>\""}]}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"type", "\[Equal]", "\"\<therm\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergySquaredEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<virial\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergySquaredEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<heinze\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"heinzeTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"heinzeTotalEnergyEstimator", "[", 
            RowBox[{
            "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",",
              "numslices", ",", "dimensionality"}], "]"}], "2"], "+", 
          RowBox[{"numparticles", "*", "numslices"}]}]}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyAssocMaker", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"energyAssocMaker", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMakerStatistics", "[", 
    RowBox[{
    "step_", ",", "numsteps_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", 
     "numparticles_", ",", "numslices_", ",", "path_", ",", "joined_", ",", 
     "dimensionality_", ",", 
     RowBox[{"type_:", "\"\<virial\>\""}]}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"type", "\[Equal]", "\"\<therm\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergyEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<virial\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergyEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<fullvirial\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"fullVirialTotalEnergySquaredEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<heinze\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"heinzeTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"heinzeTotalEnergyEstimator", "[", 
            RowBox[{
            "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",",
              "numslices", ",", "dimensionality"}], "]"}], "2"], "+", 
          RowBox[{"numparticles", "*", "numslices"}]}]}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyAssocMakerStatistics", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"energyAssocMakerStatistics", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyMaker", "[", 
    RowBox[{
    "calculateEnergy_", ",", "energyTherm_", ",", "energyVirial_", ",", 
     "energyFullVirial_", ",", "energyHeinze_", ",", "harmonictrap_", ",", 
     "energysaveassoctherm_", ",", "energysquaredsaveassoctherm_", ",", 
     "energysaveassocvirial_", ",", "energysquaredsaveassocvirial_", ",", 
     "energysaveassocfullvirial_", ",", "energysquaredsaveassocfullvirial_", 
     ",", "energysaveassocheinze_", ",", "energysquaredsaveassocheinze_", ",",
      "\[Tau]_", ",", "slices_", ",", "\[Omega]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "energysaverarraytherm", ",", "invvartherm", ",", 
       "energysaverarrayvirial", ",", "invvarvirial", ",", 
       "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
       "energysaverarrayheinze", ",", "invvarheinze"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"calculateEnergy", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "}"}], 
            "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassoctherm", ",", "energysquaredsaveassoctherm"}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "}"}], 
            "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassocvirial", ",", "energysquaredsaveassocvirial"}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}], 
             "}"}], "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassocfullvirial", ",", 
              "energysquaredsaveassocfullvirial"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarrayheinze", ",", "invvarheinze"}], "}"}], 
            "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassocheinze", ",", "energysquaredsaveassocheinze"}], 
             "]"}]}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"energysaverarrayheinze", ",", "invvarheinze"}], "}"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyMaker", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"energyMaker", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPrinter", "[", 
    RowBox[{
    "calculateEnergy_", ",", "energyTherm_", ",", "energyVirial_", ",", 
     "energyFullVirial_", ",", "energyHeinze_", ",", "harmonictrap_", ",", 
     "energysaverarraytherm_", ",", "invvartherm_", ",", 
     "energysaverarrayvirial_", ",", "invvarvirial_", ",", 
     "energysaverarrayfullvirial_", ",", "invvarfullvirial_", ",", 
     "energysaverarrayheinze_", ",", "invvarheinze_", ",", "\[Tau]_", ",", 
     "slices_", ",", "\[Omega]_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"calculateEnergy", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"energyVirial", ",", 
        RowBox[{"printEnergyVirial", "[", 
         RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyFullVirial", ",", 
        RowBox[{"printEnergyFullVirial", "[", 
         RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyTherm", ",", 
        RowBox[{"printEnergyTherm", "[", 
         RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyHeinze", ",", 
        RowBox[{"printEnergyHeinze", "[", "energysaverarrayheinze", "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"harmonictrap", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<cf numerically exact total energy per non-interacting particle  \
    : \>\"", ",", 
          RowBox[{"exactHarmonicTrapEnergies", "[", 
           RowBox[{
           "15", ",", "\[Tau]", ",", "slices", ",", "\[Omega]", ",", 
            "dimensionality"}], "]"}]}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyPrinter", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"energyPrinter", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expectationValueMaker", "[", 
    RowBox[{
    "calculateParticleDensityX_", ",", "calculatePairCorrelationFunction_", 
     ",", "numparticles_", ",", "particleDensityX_", ",", 
     "vectorPairCorrelationFunction_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "particleDensityXsaverarray", ",", "pairCorrelationFunctionsaverarray", 
       ",", "vectorPairCorrelationFunctionsaverarray"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"particleDensityXsaverarray", "=", 
         RowBox[{"Values", "@", "particleDensityX"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"vectorPairCorrelationFunctionsaverarray", "=", 
         RowBox[{"Values", "@", "vectorPairCorrelationFunction"}]}]}], "]"}], 
      ";", 
      RowBox[{"{", 
       RowBox[{
       "particleDensityXsaverarray", ",", 
        "vectorPairCorrelationFunctionsaverarray"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expectationValueMaker", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"expectationValueMaker", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotMaker", "[", 
    RowBox[{
    "showPaths_", ",", "calculateEnergy_", ",", "calculateParticleDensityX_", 
     ",", "calculatePairCorrelationFunction_", ",", 
     "allow3DCorrelationPlots_", ",", "showAutocorrelation_", ",", 
     "numparticles_", ",", "path_", ",", "joined_", ",", "energyVirial_", ",",
      "energyFullVirial_", ",", "energyTherm_", ",", "energyHeinze_", ",", 
     "energysaverarrayvirial_", ",", "energysaverarrayfullvirial_", ",", 
     "energysaverarraytherm_", ",", "energysaverarrayheinze_", ",", 
     "invvarvirial_", ",", "invvarfullvirial_", ",", "invvartherm_", ",", 
     "invvarheinze_", ",", "equilibrationsteps_", ",", "numsteps_", ",", 
     "harmonictrap_", ",", "\[Omega]_", ",", "\[Tau]_", ",", "slices_", ",", 
     "particleDensityXsaverarray_", ",", 
     "vectorPairCorrelationFunctionsaverarray_", ",", "binsize_", ",", 
     "observablecalc_", ",", "plotPoints_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pathplot", ",", "potentialplot", ",", "energyplot", ",", 
       "particleDensityXplot", ",", "particleDensityXplot3D", ",", 
       "pairCorrelationFunctionplot", ",", 
       "pairUnweightedCorrelationFunctionplot", ",", "autocorrelationplot", 
       ",", "plots", ",", "xyAveragedPairCorrelationFunctionplot", ",", 
       "xPairCorrelationFunctionplot", ",", "plotRange", ",", 
       "shorterPlotRange", ",", "densityPlotRange", ",", "partdensfunc", ",", 
       "partdenstexture"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintTemporary", "[", "\"\<Currently drawing plots ...\>\"", "]"}], 
      ";", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{
         RowBox[{"pathplot", "=", 
          RowBox[{"pathPlot", "[", 
           RowBox[{"path", ",", "joined", ",", "dimensionality"}], "]"}]}], 
         ";", 
         RowBox[{"potentialplot", "=", 
          RowBox[{"potentialPlot", "[", 
           RowBox[{"path", ",", "dimensionality"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "calculateParticleDensityX", "&&", "allow3DCorrelationPlots"}], ",", 
        RowBox[{"densityPlotRange", "=", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"(", "#", ")"}], "]"}], "&"}], "/@", 
            RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"Round", "[", 
            RowBox[{"0.95", 
             RowBox[{"Length", "[", 
              RowBox[{"Join", "@@", "particleDensityXsaverarray"}], "]"}]}], 
            "]"}], "]"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"plotRange", "=", 
         RowBox[{"Last", "@", 
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
            RowBox[{
            "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"shorterPlotRange", "=", 
         RowBox[{"(*", "plotRange", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
            RowBox[{
            "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Round", "[", 
            RowBox[{"0.95", 
             RowBox[{"Length", "[", 
              RowBox[{
              "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}], 
              "]"}]}], "]"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"calculateEnergy", ",", 
        RowBox[{"energyplot", "=", 
         RowBox[{"energyPlot", "[", 
          RowBox[{
          "energyVirial", ",", "energyFullVirial", ",", "energyTherm", ",", 
           "energyHeinze", ",", "energysaverarrayvirial", ",", 
           "energysaverarrayfullvirial", ",", "energysaverarraytherm", ",", 
           "energysaverarrayheinze", ",", "invvarvirial", ",", 
           "invvarfullvirial", ",", "invvartherm", ",", "invvarheinze", ",", 
           "equilibrationsteps", ",", "numsteps", ",", "harmonictrap", ",", 
           "\[Omega]", ",", "\[Tau]", ",", "slices", ",", "dimensionality"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"particleDensityXplot", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"PDF", "[", 
                RowBox[{
                 RowBox[{"SmoothKernelDistribution", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                   ",", "#", ",", "\"\<Cosine\>\""}], "]"}], ",", "x"}], 
                "]"}], "&"}], "/@", "binsize"}], ")"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"First", "@", 
              RowBox[{"Sort", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                ")"}]}]}], ",", 
             RowBox[{"Last", "@", 
              RowBox[{"Sort", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                ")"}]}]}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Orange", ",", 
                 RowBox[{"Length", "@", "binsize"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Opacity", "[", 
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["2", "#"]], "+", 
                   FractionBox["1", "2"]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "binsize"}]}]}]}], "}"}], "]"}]}], 
           ",", 
           RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                FractionBox["1", 
                 SuperscriptBox["2", "#"]], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "binsize"}]}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x position\>\"", ",", "\"\<probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", "\"\<Particle Density Probability\>\""}], 
           ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "All"}], "}"}]}]}], "]"}]}]}], "]"}], 
      ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "calculateParticleDensityX", "&&", "allow3DCorrelationPlots"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
          RowBox[{"particleDensityXplot3D", "=", 
           RowBox[{"Plot3D", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{"(", 
               RowBox[{"PDF", "[", 
                RowBox[{
                 RowBox[{"SmoothKernelDistribution", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                   ",", 
                   RowBox[{"binsize", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ")"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
              "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
             RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<probability\>\""}], 
               "}"}]}], ",", 
             RowBox[{
             "PlotLabel", "\[Rule]", 
              "\"\<2D Particle Density Probability\>\""}]}], "]"}]}], ",", 
          RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"partdensfunc", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "=", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"SmoothKernelDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], ",", 
                RowBox[{"binsize", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"partdenstexture", "=", 
            RowBox[{"DensityPlot", "[", 
             RowBox[{
              RowBox[{"extV", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
               "}"}], ",", 
              RowBox[{"Frame", "\[Rule]", "None"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
              RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"particleDensityXplot3D", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"Plot3D", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"partdensfunc", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "<", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "3"}]]}], ",", "Null", ",", 
                  RowBox[{"partdensfunc", "[", 
                   RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "densityPlotRange"}], ",", 
                  "densityPlotRange"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"-", "densityPlotRange"}], ",", 
                  "densityPlotRange"}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
                RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
                RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
                RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<probability\>\""}],
                   "}"}]}], ",", 
                RowBox[{
                "PlotLabel", "\[Rule]", 
                 "\"\<2D Particle Density Probability\>\""}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Texture", "[", "partdenstexture", "]"}], ",", 
                  RowBox[{"Polygon", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "densityPlotRange"}], ",", 
                    RowBox[{"-", "densityPlotRange"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"densityPlotRange", ",", 
                    RowBox[{"-", "densityPlotRange"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "densityPlotRange", ",", "densityPlotRange", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "densityPlotRange"}], ",", 
                    "densityPlotRange", ",", "0"}], "}"}]}], "}"}], ",", 
                    RowBox[{"VertexTextureCoordinates", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], "]"}]}],
              "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"pairCorrelationFunctionplot", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"PDF", "[", 
                RowBox[{
                 RowBox[{"SmoothKernelDistribution", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    "Join", "@@", 
                    "vectorPairCorrelationFunctionsaverarray"}]}], ",", "#", 
                   ",", "\"\<Cosine\>\""}], "]"}], ",", "x"}], "]"}], "&"}], "/@",
               "binsize"}], ")"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "plotRange"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Orange", ",", 
                 RowBox[{"Length", "@", "binsize"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Opacity", "[", 
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["2", "#"]], "+", 
                   FractionBox["1", "2"]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "binsize"}]}]}]}], "}"}], "]"}]}], 
           ",", 
           RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                FractionBox["1", 
                 SuperscriptBox["2", "#"]], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "binsize"}]}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<|r|\>\"", ",", "\"\<probability\>\""}], "}"}]}], 
           ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<Averaged Density-Density Correlation Function\>\""}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"pairUnweightedCorrelationFunctionplot", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
               FractionBox["1", 
                SuperscriptBox["x", "2"]], ",", 
               RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
               FractionBox["1", "x"]}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PDF", "[", 
                 RowBox[{
                  RowBox[{"SmoothKernelDistribution", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    "Join", "@@", 
                    "vectorPairCorrelationFunctionsaverarray"}]}], ",", "#", 
                    ",", "\"\<Cosine\>\""}], "]"}], ",", "x"}], "]"}], "&"}], 
               "/@", "binsize"}], ")"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "plotRange"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Orange", ",", 
                 RowBox[{"Length", "@", "binsize"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Opacity", "[", 
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["2", "#"]], "+", 
                   FractionBox["1", "2"]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "binsize"}]}]}]}], "}"}], "]"}]}], 
           ",", 
           RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                FractionBox["1", 
                 SuperscriptBox["2", "#"]], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "binsize"}]}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<|r|\>\"", ",", "\"\<probability\>\""}], "}"}]}], 
           ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", "\"\<Pair Correlation Function\>\""}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"xyAveragedPairCorrelationFunctionplot", "=", 
         RowBox[{"Plot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"SmoothKernelDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
                 RowBox[{
                 "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
                ",", 
                RowBox[{"binsize", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<2D Density-Density Correlation Function\>\""}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"xPairCorrelationFunctionplot", "=", 
         RowBox[{"Plot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "@", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"SmoothKernelDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], "&"}],
                  "/@", 
                 RowBox[{
                 "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
                ",", 
                RowBox[{"binsize", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\)\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[\(x\), \(2\)]\)\>\"", ",", 
              "\"\<probability\>\""}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<x-direction Density-Density Correlation Function\>\""}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showAutocorrelation", ",", 
        RowBox[{"autocorrelationplot", "=", 
         RowBox[{"autocorrelationPlot", "[", 
          RowBox[{
          "energyVirial", ",", "energyFullVirial", ",", "energyTherm", ",", 
           "energyHeinze", ",", "energysaverarrayvirial", ",", 
           "energysaverarrayfullvirial", ",", "energysaverarraytherm", ",", 
           "energysaverarrayheinze", ",", "observablecalc"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", 
           RowBox[{"potentialplot", ",", "pathplot"}], "]"}]}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"calculateEnergy", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "energyplot", "]"}]}], "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"If", "[", 
           RowBox[{"harmonictrap", ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{"particleDensityXplot", ",", 
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "@", 
                  RowBox[{"exactHarmonicTrapWfns", "[", 
                   RowBox[{
                   "5", ",", "\[Tau]", ",", "slices", ",", "\[Omega]", ",", 
                    "dimensionality"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"Show", "[", "particleDensityXplot", "]"}]}], "]"}]}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "calculateParticleDensityX", "&&", "allow3DCorrelationPlots"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "particleDensityXplot3D", "]"}]}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "pairCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{
          "Show", "[", "pairUnweightedCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{
          "Show", "[", "xyAveragedPairCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "xPairCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"showAutocorrelation", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "autocorrelationplot", "]"}]}], "]"}]}], "]"}],
       ";", "plots"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotMaker", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"plotMaker", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arrayExtractor", "[", 
    RowBox[{
    "energyTherm_", ",", "energyVirial_", ",", "energyFullVirial_", ",", 
     "energyHeinze_", ",", "calculateParticleDensityX_", ",", 
     "calculatePairCorrelationFunction_", ",", "numparticles_", ",", 
     "arrays_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "arraysEnergyTherm", ",", "arraysInvVarTherm", ",", 
       "arraysEnergyVirial", ",", "arraysInvVarVirial", ",", 
       "arraysEnergyFullVirial", ",", "arraysInvVarFullVirial", ",", 
       "arraysEnergyHeinze", ",", "arraysInvVarHeinze", ",", 
       "arraysParticleDensityX", ",", "arraysPairCorrelationFunction", ",", 
       "numsuccessesBisect", ",", "numpermuted", ",", "path", ",", "joined", 
       ",", "longestcycle", ",", "arraysVectorPairCorrelationFunction"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"energyTherm", ",", 
        RowBox[{"arraysEnergyTherm", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyTherm", ",", 
        RowBox[{"arraysInvVarTherm", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyVirial", ",", 
        RowBox[{"arraysEnergyVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyVirial", ",", 
        RowBox[{"arraysInvVarVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyFullVirial", ",", 
        RowBox[{"arraysEnergyFullVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyFullVirial", ",", 
        RowBox[{"arraysInvVarFullVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyHeinze", ",", 
        RowBox[{"arraysEnergyHeinze", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "7", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyHeinze", ",", 
        RowBox[{"arraysInvVarHeinze", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "8", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"arraysParticleDensityX", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "9", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"arraysVectorPairCorrelationFunction", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "10", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numsuccessesBisect", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
         RowBox[{"[", "11", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numpermuted", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
         RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"path", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"13", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"joined", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"14", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"longestcycle", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"15", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"energyTherm", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyTherm"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarTherm"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarTherm"}], ")"}]}]]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyTherm", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarTherm"}], ")"}]}]}], "]"}],
         ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyVirial", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyVirial"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarVirial"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarVirial"}], ")"}]}]]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyVirial", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarVirial"}], ")"}]}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyFullVirial", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyFullVirial"}], ")"}], 
              "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarFullVirial"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarFullVirial"}], ")"}]}]]}],
          "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyFullVirial", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarFullVirial"}], ")"}]}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyHeinze", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyHeinze"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarHeinze"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarHeinze"}], ")"}]}]]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyHeinze", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarHeinze"}], ")"}]}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"calculateParticleDensityX", ",", 
          RowBox[{"Catenate", "@", "arraysParticleDensityX"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"calculatePairCorrelationFunction", "&&", 
           RowBox[{"numparticles", ">", "1"}]}], ",", 
          RowBox[{"Catenate", "@", "arraysVectorPairCorrelationFunction"}]}], 
         "]"}], ",", "numsuccessesBisect", ",", "numpermuted", ",", "path", 
        ",", "joined", ",", "longestcycle"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrayExtractor", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"arrayExtractor", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialisationloop", "[", 
    RowBox[{
    "showPaths_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "slices_", ",", 
     "numparticles_", ",", "numsteps_", ",", "startingRange_", ",", 
     "startingDelta_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"originaljoined", ",", "originalpath", ",", "startingPos"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"originalpath", ",", "originaljoined"}], "]"}], ";", 
      RowBox[{
      "PrintTemporary", "[", 
       "\"\<Currently constructing the starting positions ...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"originaljoined", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"startingPos", "=", 
       RowBox[{"startingPositions", "[", 
        RowBox[{
        "numparticles", ",", "slices", ",", "startingRange", ",", 
         "startingDelta", ",", "dimensionality"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"startingPos", ",", "1"}], "]"}]}]}], "<", 
         "numparticles"}], ",", 
        RowBox[{
        "Print", "[", 
         "\"\<Appears to be at least one starting position with more than one \
particle: check if this is desired behaviour.  If not, try increasing \
startingRange or decreasing startingDelta.\>\"", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"originalpath", "=", 
       RowBox[{"startingPos", "+", 
        RowBox[{"pathInitialise", "[", 
         RowBox[{
         "numparticles", ",", "slices", ",", "\[Lambda]", ",", "\[Tau]", ",", 
          "dimensionality"}], "]"}]}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"originaljoined", "[", "i", "]"}], "=", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "originalpath"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Temperature kT=\>\"", ",", 
        FractionBox["1", 
         RowBox[{"\[Tau]", " ", "slices"}]]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Thermal wavelength \!\(\*SqrtBox[\(2  \[Lambda]\[Tau]\)]\)=\>\"", 
        ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"potentialAction1beadStatisticsC", "=", 
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"path", ",", "_Real", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Lambda]t", ",", "_Real"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Tau]t", ",", "_Real"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"particle", ",", "_Integer"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"bead", ",", "_Integer"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"joined", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], 
            ",", 
            RowBox[{
             RowBox[{
              FractionBox["\[Tau]t", "2"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"bead", "\[Equal]", "1"}], ",", 
                  RowBox[{"extV", "[", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"joined", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"joined", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}], "]"}], "]"}]}]}], 
                    "]"}], "]"}], "]"}], ",", 
                  RowBox[{"extV", "[", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"particle", ",", 
                    RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "]"}]}], 
                 "]"}], "+", 
                RowBox[{"extV", "[", 
                 RowBox[{"path", "[", 
                  RowBox[{"[", 
                   RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], 
               ")"}]}], "+", 
             RowBox[{"\[Tau]t", " ", 
              RowBox[{"Total", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"intpartV", "[", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"place", "[", 
                    RowBox[{
                    RowBox[{"Length", "@", "path"}], ",", 
                    RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], 
                    "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
                "]"}]}]}]}]}], "]"}], "]"}], "/.", 
         RowBox[{"Join", "@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DownValues", "@", "extV"}], ",", 
            RowBox[{"DownValues", "@", "intpartV"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{
        "PrintTemporary", "[", "\"\<Currently drawing plot ...\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{"Print", "@", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
             RowBox[{"DensityPlot3D", "[", 
              RowBox[{
               RowBox[{"extV", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"OpacityFunction", "\[Rule]", "0.02"}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
                 "}"}]}]}], "]"}], ",", 
             RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
             RowBox[{"DensityPlot", "[", 
              RowBox[{
               RowBox[{"extV", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"-", "startingRange"}], ",", "startingRange"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"-", "startingRange"}], ",", "startingRange"}], 
                "}"}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             "True", ",", 
             RowBox[{
             "Throw", "[", 
              "\"\<Unknown dimensionality in initialisationloop\>\"", "]"}]}],
             "]"}], ",", 
           RowBox[{"pathPlot", "[", 
            RowBox[{
            "originalpath", ",", "originaljoined", ",", "dimensionality"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"originalpath", ",", "originaljoined"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialisationloop", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"initialisationloop", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mainLoop", "[", 
    RowBox[{
    "originalpath_", ",", "originaljoined_", ",", "\[Lambda]_", ",", 
     "\[Tau]_", ",", "calculateEnergy_", ",", "calculateParticleDensity_", 
     ",", "calculatePairCorrelationFunction_", ",", "maxcyclelength_", ",", 
     "dimensionality_", ",", "numparticles_", ",", "equilibrationsteps_", ",",
      "observablecalc_", ",", "numsteps_", ",", "slices_", ",", 
     "energyTherm_", ",", "energyVirial_", ",", "energyFullVirial_", ",", 
     "energyHeinze_", ",", "\[Omega]_", ",", "harmonictrap_", ",", 
     "calculateFracSameWell_", ",", "startingRange_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "path", ",", "joined", ",", "particleDensity", ",", 
       "energysaveassocvirial", ",", "energysaveassocfullvirial", ",", 
       "energysaveassoctherm", ",", "energysaveassocheinze", ",", 
       "energysquaredsaveassocheinze", ",", "energysquaredsaveassocvirial", 
       ",", "energysquaredsaveassocfullvirial", ",", 
       "energysquaredsaveassoctherm", ",", "vectorPairCorrelationFunction", 
       ",", "numsuccessesBisect", ",", "numpermuted", ",", "successBisect", 
       ",", "kernels", ",", "mainRunTime", ",", "arrays", ",", 
       "energysaverarraytherm", ",", "invvartherm", ",", 
       "energysaverarrayvirial", ",", "invvarvirial", ",", 
       "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
       "energysaverarrayheinze", ",", "invvarheinze", ",", 
       "particleDensitysaverarray", ",", 
       "vectorPairCorrelationFunctionsaverarray", ",", "longestcycle"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"path", "=", "originalpath"}], ";", "\[IndentingNewLine]", 
      RowBox[{"joined", "=", "originaljoined"}], ";", "\[IndentingNewLine]", 
      RowBox[{"longestcycle", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"particleDensity", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassocvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassocfullvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassoctherm", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassocheinze", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysquaredsaveassocheinze", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"energysquaredsaveassocvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysquaredsaveassocfullvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysquaredsaveassoctherm", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"vectorPairCorrelationFunction", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
          "calculateEnergy", "||", "calculateParticleDensity", "||", 
           "calculatePairCorrelationFunction"}], ")"}]}], ",", 
        RowBox[{
        "Throw", "[", "\"\<We don't appear to be calculating anything?\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"path", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\[NotEqual]", "slices"}], ",", 
        RowBox[{
        "Throw", "[", 
         "\"\<Double-check you ran the 'Initialisation' cell\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DistributeDefinitions", "[", 
       RowBox[{
       "path", ",", "joined", ",", "longestcycle", ",", "particleDensity", 
        ",", "energysaveassocvirial", ",", "energysaveassocfullvirial", ",", 
        "energysaveassoctherm", ",", "energysaveassocheinze", ",", 
        "energysquaredsaveassocheinze", ",", "energysquaredsaveassocvirial", 
        ",", "energysquaredsaveassocfullvirial", ",", 
        "energysquaredsaveassoctherm", ",", "vectorPairCorrelationFunction", 
        ",", "bisectionMoveStatistics", ",", "tarjan", ",", 
        "energyAssocMakerStatistics", ",", "energyMaker", ",", 
        "expectationValueMaker"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"kernels", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"$KernelID", "\[Rule]", "i"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "$KernelCount"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "kernels", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "currentNumber", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentNumber", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "@", "kernels"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<Current fraction complete : \>\"", ",", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "@", 
           RowBox[{"Mean", "@", "currentNumber"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "100"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mainRunTime", ",", "arrays"}], "}"}], "=", 
       RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
        RowBox[{"ParallelEvaluate", "[", 
         RowBox[{
          RowBox[{"numsuccessesBisect", "=", "0"}], ";", 
          RowBox[{"numpermuted", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"successBisect", "=", "False"}], ";", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"successBisect", ",", "path", ",", "joined"}], "}"}], 
              "=", 
              RowBox[{"bisectionMoveStatistics", "[", 
               RowBox[{
               "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "joined", ",", 
                "maxcyclelength", ",", "dimensionality"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{"Normal", "[", "joined", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
                "\[NotEqual]", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "joined", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{
               "Throw", "[", 
                "\"\<Joined array maps to same particle twice!\>\"", "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", "joined", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                 RowBox[{"Range", "@", "numparticles"}]}], "&&", 
                RowBox[{"step", ">", "equilibrationsteps"}]}], ",", 
               RowBox[{"numpermuted", "++"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"successBisect", "&&", 
                RowBox[{"step", ">", "equilibrationsteps"}]}], ",", 
               RowBox[{"numsuccessesBisect", "++"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Divisible", "[", 
                 RowBox[{"step", ",", "observablecalc"}], "]"}], "&&", 
                RowBox[{"step", "\[GreaterEqual]", "equilibrationsteps"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"numparticles", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "longestcycle"}], ",", 
                    RowBox[{"longestcycle", "=", "#"}]}], "]"}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{"First", "@", 
                    RowBox[{"tarjan", "[", "joined", "]"}]}], ")"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"calculateEnergy", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"energyTherm", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassoctherm", "[", "step", "]"}], ",", 
                    RowBox[{
                    "energysquaredsaveassoctherm", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", "\"\<therm\>\""}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"energyVirial", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassocvirial", "[", "step", "]"}], ",", 
                    RowBox[{
                    "energysquaredsaveassocvirial", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", "\"\<virial\>\""}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"energyFullVirial", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassocfullvirial", "[", "step", "]"}], 
                    ",", 
                    RowBox[{
                    "energysquaredsaveassocfullvirial", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", 
                    "\"\<fullvirial\>\""}], "]"}]}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"energyHeinze", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassocheinze", "[", "step", "]"}], ",", 
                    RowBox[{
                    "energysquaredsaveassocheinze", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", "\"\<heinze\>\""}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    "energyTherm", "||", "energyVirial", "||", 
                    "energyFullVirial", "||", "energyHeinze"}], ")"}]}], ",", 
                    RowBox[{
                    "Throw", "[", 
                    "\"\<Calculating energy, but no energy estimators \
selected!\>\"", "]"}]}], "]"}], ";"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{"calculateParticleDensity", ",", 
                  RowBox[{
                   RowBox[{"particleDensity", "[", "step", "]"}], "=", 
                   RowBox[{"Join", "@@", "path"}]}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"calculatePairCorrelationFunction", "&&", 
                   RowBox[{"numparticles", ">", "1"}]}], ",", 
                  RowBox[{
                   RowBox[{
                   "vectorPairCorrelationFunction", "[", "step", "]"}], "=", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", "path"}], ")"}]}], ")"}]}]}]}], 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Divisible", "[", 
                RowBox[{"step", ",", "observablecalc"}], "]"}], ",", 
               RowBox[{
                RowBox[{"currentNumber", "[", 
                 RowBox[{"[", 
                  RowBox[{"$KernelID", "/.", "kernels"}], "]"}], "]"}], "=", 
                RowBox[{
                 FractionBox["step", "numsteps"], "*", "100."}]}]}], "]"}], 
             ";"}], ",", 
            RowBox[{"{", 
             RowBox[{"step", ",", "numsteps"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"energysaverarrayheinze", ",", "invvarheinze"}], 
              "}"}]}], "}"}], "=", 
           RowBox[{"energyMaker", "[", 
            RowBox[{
            "calculateEnergy", ",", "energyTherm", ",", "energyVirial", ",", 
             "energyFullVirial", ",", "energyHeinze", ",", "harmonictrap", 
             ",", "energysaveassoctherm", ",", "energysquaredsaveassoctherm", 
             ",", "energysaveassocvirial", ",", 
             "energysquaredsaveassocvirial", ",", "energysaveassocfullvirial",
              ",", "energysquaredsaveassocfullvirial", ",", 
             "energysaveassocheinze", ",", "energysquaredsaveassocheinze", 
             ",", "\[Tau]", ",", "slices", ",", "\[Omega]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "particleDensitysaverarray", ",", 
             "vectorPairCorrelationFunctionsaverarray"}], "}"}], "=", 
           RowBox[{"expectationValueMaker", "[", 
            RowBox[{
            "calculateParticleDensity", ",", 
             "calculatePairCorrelationFunction", ",", "numparticles", ",", 
             "particleDensity", ",", "vectorPairCorrelationFunction"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "energysaverarraytherm", ",", "invvartherm", ",", 
            "energysaverarrayvirial", ",", "invvarvirial", ",", 
            "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
            "energysaverarrayheinze", ",", "invvarheinze", ",", 
            "particleDensitysaverarray", ",", 
            "vectorPairCorrelationFunctionsaverarray", ",", 
            "numsuccessesBisect", ",", "numpermuted", ",", "path", ",", 
            "joined", ",", "longestcycle"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Temperature kT=\>\"", ",", 
        FractionBox["1", 
         RowBox[{"\[Tau]", " ", "slices"}]]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Run time of main loop: \>\"", ",", "mainRunTime", ",", 
        "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "energysaverarraytherm", ",", "invvartherm", ",", 
         "energysaverarrayvirial", ",", "invvarvirial", ",", 
         "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
         "energysaverarrayheinze", ",", "invvarheinze", ",", 
         "particleDensitysaverarray", ",", 
         "vectorPairCorrelationFunctionsaverarray", ",", "numsuccessesBisect",
          ",", "numpermuted", ",", "path", ",", "joined", ",", 
         "longestcycle"}], "}"}], "=", 
       RowBox[{"arrayExtractor", "[", 
        RowBox[{
        "energyTherm", ",", "energyVirial", ",", "energyFullVirial", ",", 
         "energyHeinze", ",", "calculateParticleDensity", ",", 
         "calculatePairCorrelationFunction", ",", "numparticles", ",", 
         "arrays"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Acceptance ratio bisection: \>\"", ",", 
        FractionBox[
         RowBox[{"numsuccessesBisect", "+", "0."}], 
         RowBox[{"(", 
          RowBox[{"numsteps", "-", "equilibrationsteps"}], ")"}]]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numparticles", ">", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Fractional time with permutations: \>\"", ",", 
          FractionBox[
           RowBox[{"numpermuted", "+", "0."}], 
           RowBox[{"(", 
            RowBox[{"numsteps", "-", "equilibrationsteps"}], ")"}]]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numparticles", ">", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Longest permutation cycle: \>\"", ",", "longestcycle", ",", 
          "\"\< which is \>\"", ",", 
          FractionBox[
           RowBox[{"longestcycle", "+", "0."}], "numparticles"], ",", 
          "\"\< of all particles\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"numparticles", ">", "1"}], "&&", "calculateFracSameWell", "&&",
          "calculatePairCorrelationFunction", "&&", 
         RowBox[{"dimensionality", "\[Equal]", "2"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Fraction of particle pairs within same well is \>\"", ",", 
          RowBox[{"fracsamewell", "[", 
           RowBox[{
           "vectorPairCorrelationFunctionsaverarray", ",", "startingRange"}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "energysaverarraytherm", ",", "invvartherm", ",", 
        "energysaverarrayvirial", ",", "invvarvirial", ",", 
        "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
        "energysaverarrayheinze", ",", "invvarheinze", ",", 
        "particleDensitysaverarray", ",", 
        "vectorPairCorrelationFunctionsaverarray", ",", "numsuccessesBisect", 
        ",", "numpermuted", ",", "path", ",", "joined"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mainLoop", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"mainLoop", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierSpacing", "[", 
    RowBox[{
    "startingRange_", ",", "startingDelta_", ",", "dimensionality_", ",", 
     "kvec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "table", ",", "data", ",", "heights", ",", "minima", ",", "sets"}], 
      "}"}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
       RowBox[{
       "Throw", "[", 
        "\"\<Sorry, this feature isn't implemented for 3D yet\>\"", "]"}], 
       ",", 
       RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
       RowBox[{
        RowBox[{"table", "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"extV", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "startingRange"}], ",", "startingRange", ",", 
             "startingDelta"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "startingRange"}], ",", "startingRange", ",", 
             "startingDelta"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"table", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"heights", "=", 
         RowBox[{"table", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minima", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MaximalBy", "[", 
             RowBox[{
              RowBox[{"Join", "@@@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Riffle", "[", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
                   RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"MinDetect", "[", "heights", "]"}], ",", "2"}], 
                    "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Last"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"extV", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minima", "=", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "/.", 
              RowBox[{"Quiet", "@", 
               RowBox[{
                RowBox[{"FindMinimum", "[", 
                 RowBox[{
                  RowBox[{"extV", "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "#"}], "}"}], 
                   "]"}]}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], ",", "minima"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sets", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", 
            RowBox[{"minima", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ">", 
             RowBox[{"1.1", 
              SqrtBox["2"], 
              RowBox[{"\[Pi]", "/", "kvec"}]}]}]}]}], "]"}]}], ";", 
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"NMaximize", "[", 
                   RowBox[{
                    RowBox[{"extV", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
                    RowBox[{"Line", "[", "#", "]"}]}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"extV", "@", 
                  RowBox[{"minima", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "&"}], ",", 
               RowBox[{"sets", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{"sets", ",", 
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "minima"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", "0.05", "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<|r|\>\"", ",", "\"\<probability\>\""}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", "\"\<Histogram of barrier heights\>\""}]}], 
         "]"}]}], ",", "True", ",", 
       RowBox[{
       "Throw", "[", "\"\<Unknown dimensionality encountered\>\"", "]"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrierSpacing", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"barrierSpacing", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tarjan", "[", "cycle_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$RecursionLimit", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"1024", ",", 
         RowBox[{"Length", "@", "cycle"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"visited", ",", "loops", ",", "loopfn", ",", "i"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"visited", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"False", ",", 
           RowBox[{"Length", "@", "cycle"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"loops", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "@", "cycle"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"loopfn", "[", 
          RowBox[{"loop_", ",", "v_"}], "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"visited", "[", 
             RowBox[{"[", "v", "]"}], "]"}], "\[Equal]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"cycle", "[", 
               RowBox[{"[", 
                RowBox[{"Key", "@", "v"}], "]"}], "]"}], "\[NotEqual]", "v"}],
              ",", 
             RowBox[{
              RowBox[{
               RowBox[{"visited", "[", 
                RowBox[{"[", "v", "]"}], "]"}], "=", "True"}], ";", 
              RowBox[{
               RowBox[{"loops", "[", 
                RowBox[{"[", "loop", "]"}], "]"}], "++"}], ";", 
              RowBox[{"loopfn", "[", 
               RowBox[{"loop", ",", 
                RowBox[{"cycle", "[", 
                 RowBox[{"[", 
                  RowBox[{"Key", "@", "v"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"visited", "[", 
                RowBox[{"[", "v", "]"}], "]"}], "=", "True"}], ";", 
              RowBox[{
               RowBox[{"loops", "[", 
                RowBox[{"[", "loop", "]"}], "]"}], "++"}], ";"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "cycle"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"visited", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "False"}], ",", 
            RowBox[{
             RowBox[{"loopfn", "[", 
              RowBox[{"i", ",", "i"}], "]"}], ";"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Reverse", "@", 
           RowBox[{"Sort", "@", 
            RowBox[{"Flatten", "@", "loops"}]}]}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "\[Equal]", "0"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tarjan", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"tarjan", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fracsamewell", "[", 
    RowBox[{
    "vectorPairCorrelationFunctionsaverarray_", ",", "startingRange_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"firstxmax", ",", "joinedlist"}], "}"}], ",", 
     RowBox[{
      RowBox[{"firstxmax", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"FindMaximum", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"extV", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Abs", "[", "x", "]"}], "<", "startingRange"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.001"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
      RowBox[{"joinedlist", "=", 
       RowBox[{"Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
      ";", 
      RowBox[{
       FractionBox[
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
           "joinedlist"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "<", "firstxmax"}]}]}], "]"}], 
        RowBox[{"Length", "@", "joinedlist"}]], "//", "N"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fracsamewell", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"fracsamewell", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hoppingt", "[", 
    RowBox[{"\[Lambda]_", ",", "kvec_", ",", "V_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["4", 
     SqrtBox["\[Pi]"]], "\[Lambda]", " ", 
    SuperscriptBox["kvec", "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["V", 
       RowBox[{"\[Lambda]", " ", 
        SuperscriptBox["kvec", "2"]}]], ")"}], 
     RowBox[{"3", "/", "4"}]], 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SqrtBox[
       FractionBox["V", 
        RowBox[{"\[Lambda]", " ", 
         SuperscriptBox["kvec", "2"]}]]]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hoppingt", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"hoppingt", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierU", "[", 
    RowBox[{"\[Lambda]_", ",", "kvec_", ",", "V_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     FractionBox["8", "\[Pi]"]], "kvec", " ", "a", " ", "\[Lambda]", " ", 
    SuperscriptBox["kvec", "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["V", 
       RowBox[{"\[Lambda]", " ", 
        SuperscriptBox["kvec", "2"]}]], ")"}], 
     RowBox[{"3", "/", "4"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrierU", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"barrierU", "::", "argnum"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "args", "}"}], "]"}]}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713069660020986*^9, 3.7130696738361397`*^9}, {
   3.7130697122045746`*^9, 3.713070166159789*^9}, {3.713070203890414*^9, 
   3.713070231777899*^9}, {3.713070262811469*^9, 3.7130702965738516`*^9}, {
   3.713070330432297*^9, 3.713070457727626*^9}, {3.713070503795168*^9, 
   3.71307147372335*^9}, {3.713071537296489*^9, 3.713072841141263*^9}, {
   3.7130753372569714`*^9, 3.7130753489327126`*^9}, 3.713078017313891*^9, {
   3.7130805793355803`*^9, 3.713080615912367*^9}, 3.713080699705891*^9, {
   3.71308343928863*^9, 3.713083454834634*^9}, {3.713083799629408*^9, 
   3.7130838002474966`*^9}, {3.7130845278867693`*^9, 3.713084528066822*^9}, {
   3.713086371768278*^9, 3.713086452914151*^9}, {3.7130868773908525`*^9, 
   3.7130869123391275`*^9}, {3.713086943602635*^9, 3.713086950106759*^9}}]
},
AutoGeneratedPackage->Automatic,
WindowSize->{924, 906},
WindowMargins->{{Automatic, -5}, {Automatic, 44}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 119, 1, 30, "Text"],
Cell[680, 23, 310068, 7350, 35449, "Input",
 InitializationCell->True]
}
]
*)

