(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    368055,       7920]
NotebookOptionsPosition[    366948,       7878]
NotebookOutlinePosition[    367320,       7894]
CellTagsIndexPosition[    367277,       7891]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["mPIMC", "Title",
 CellChangeTimes->{{3.7053944764560547`*^9, 3.7053944774743414`*^9}}],

Cell["\<\
Copyright (C) 2017 Thomas Whitehead
\
\>", "Text",
 CellChangeTimes->{{3.7056632999808517`*^9, 3.7056633313332453`*^9}}],

Cell["\<\
This is mPIMC, a bosonic Path Integral Monte Carlo code written in \
Mathematica.  The aim of mPIMC is to provide an easy-to-understand, \
easy-to-modify, easy-to-generalise code base that is still efficient for \
simulations of larger systems.

mPIMC was designed with cold atomic gas simulations in mind; as such, it \
works with finite systems, allowing the explicit inclusion of external traps, \
harmonic or otherwise.

This is an explicitly parallel code; it will set up and use as many kernels \
as it can on the system you run it on.  This parallelisation is used simply \
to reduce statistical error bars in the results.
\
\>", "Text",
 CellChangeTimes->{{3.7053944864747405`*^9, 3.7053947166803045`*^9}, {
  3.705394851333225*^9, 3.705394851934965*^9}, {3.7053983771053505`*^9, 
  3.7053984083630753`*^9}, {3.7053984477514753`*^9, 3.705398496482787*^9}}],

Cell["\<\
To use mPIMC, simply run each cell that you find when scrolling down this \
notebook.  This will run a simple Path Integral Monte Carlo simulation of two \
bosons in an harmonic trap.

To run your own simulation, modify the \[OpenCurlyDoubleQuote]Variables\
\[CloseCurlyDoubleQuote] block using the descriptions of the keywords found \
there.

Then set the external and inter-particle potentials in the \
\[OpenCurlyDoubleQuote]Potentials\[CloseCurlyDoubleQuote] block, and run the \
\[OpenCurlyDoubleQuote]Initialisation\[CloseCurlyDoubleQuote] block to \
generate the starting configurations of particles.

Finally, when you\[CloseCurlyQuote]re happy with the system set-up, run the \
\[OpenCurlyDoubleQuote]Running Calls\[CloseCurlyDoubleQuote] block, which \
will run a Path Integral Monte Carlo simulation using your given inputs.
\
\>", "Text",
 CellChangeTimes->{{3.7053948577769203`*^9, 3.705395090586917*^9}, {
   3.7053982509681797`*^9, 3.705398256699975*^9}, 3.705401391020343*^9}],

Cell["\<\
If you find a bug (or, even better, fix a bug) in this code, please let me \
know via tmw38@tcm.phy.cam.ac.uk and I\[CloseCurlyQuote]ll put a fix in the \
main version.\
\>", "Text",
 CellChangeTimes->{{3.7054013965435495`*^9, 3.7054014507092543`*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.693733105702818*^9, 3.693733106619279*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "If", " ", "you", " ", "modify", " ", "functions", " ", "from", " ", 
    "here", " ", "and", " ", "things", " ", "break"}], ",", " ", 
   RowBox[{
    RowBox[{"it", "'"}], "s", " ", "because", " ", "you", " ", "modified", 
    " ", "functions", " ", "from", " ", "here"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7053978991905575`*^9, 3.705397934168207*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startingPositions", "::", "usage"}], "=", 
   "\"\<startingPositions[numparticles,numslices,samplerange,sampledelta,\
dimensionality]\nnumparticles - the number of particles in the system\n\
numslices - the number of slices/beads per particle\nsamplerange - the \
position range over which to look for local minima to start particles in\n\
sampledelta - the position sampling size over which minima are sought\n\
dimensionality - the dimension of the system\nRETURN - a \
{numparticles,numslices,dimensionality} vector of the starting positions for \
particles, which should be perturbed using pathInitialise\n\n\
startingPositions looks for approximate local minima of the external \
potential, returning a vector of where particles should start out\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startingPositions", "[", 
    RowBox[{
    "numparticles_", ",", "numslices_", ",", "samplerange_", ",", 
     "sampledelta_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "table", ",", "data", ",", "heights", ",", "minima", ",", "position", 
       ",", "length"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z", ",", 
              RowBox[{"extV", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"table", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"heights", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "All", ",", "4"}], "]"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"minima", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MaximalBy", "[", 
              RowBox[{
               RowBox[{"Join", "@@@", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Riffle", "[", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"MinDetect", "[", "heights", "]"}], ",", "2"}], 
                    "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Last"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"extV", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"extV", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "samplerange"}], ",", "samplerange", ",", 
              "sampledelta"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"table", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"heights", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"minima", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MaximalBy", "[", 
              RowBox[{
               RowBox[{"Join", "@@@", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Riffle", "[", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"MinDetect", "[", "heights", "]"}], ",", "2"}], 
                    "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Last"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"extV", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}], ",", 
        "True", ",", 
        RowBox[{
        "Throw", "[", "\"\<Unknown dimensionality in startingPositions\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"length", "=", 
       RowBox[{"Length", "@", "minima"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"minima", "[", 
         RowBox[{"[", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "length", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numparticles"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "numslices"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathInitialise", "::", "usage"}], "=", 
   "\"\<pathInitialise[numparticles,numslices,\[Lambda],\[Tau],dimensionality]\
\nnumparticles - the number of particles in the system\nnumslices - the \
number of slices/beads per particle\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - the dimension of the system\nRETURN - a \
{numparticles,numslices,dimensionality} vector of positions randomly \
distributed around the origin, drawn from a flat distribution of the width of \
the thermal wavelength\n\npathInitialise slightly randomises initial starting \
positions over the order of the thermal wavelength\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathInitialise", "[", 
    RowBox[{
    "numparticles_", ",", "numslices_", ",", "\[Lambda]_", ",", "\[Tau]_", 
     ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numparticles", ",", "numslices", ",", "dimensionality"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vprime", "::", "usage"}], "=", 
   "\"\<vprime[path,particle,bead]\npath - list of all particle and bead \
positions at a given time step\nparticle - individual particle for which to \
calculate vprime\nbead - individual bead of that particle for which to \
calculate vripime\nRETURN - a {dimensionality} vector of the derivative of \
the potential at the position of the selected particle\n\nvprime calculates \
the first derivative of the external potential and interparticle potential at \
the position of a given particle\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vprime", "[", 
    RowBox[{"path_", ",", "particle_", ",", "bead_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"derivExtV", "[", 
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead"}], "]"}]}], 
       "]"}], "]"}], "]"}], "+", 
    RowBox[{"Total", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"derivIntpartV", "[", 
        RowBox[{
         RowBox[{"path", "[", 
          RowBox[{"[", 
           RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
         RowBox[{"path", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"place", "[", 
             RowBox[{
              RowBox[{"Length", "@", "path"}], ",", 
              RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], "]"}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], "]"}]}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkinetic", "::", "usage"}], "=", 
   "\"\<springkinetic[post1,post2,\[Lambda],\[Tau]]\npost1 - position of \
first particle bead\npost2 - position of second particle bead\n\[Lambda] - \!\
\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
RETURN - a real number expressing the kinetic energy from the 'spring' \
between two beads\n\nspringkinetic calculates the contribution to the kinetic \
energy from a single pair of adjacent beads with given positions.  Note, \
almost always better to use springkineticC\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkinetic", "[", 
    RowBox[{"post1_", ",", "post2_", ",", "\[Lambda]_", ",", "\[Tau]_"}], 
    "]"}], ":=", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"Norm", "[", 
      RowBox[{"post1", "-", "post2"}], "]"}], "2"], 
    RowBox[{"4", "\[Lambda]", " ", "\[Tau]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springkineticC", "::", "usage"}], "=", 
   "\"\<springkineticC[post1,post2,\[Lambda],\[Tau]]\npost1 - position of \
first particle bead\npost2 - position of second particle bead\n\[Lambda] - \!\
\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
RETURN - a real number expressing the kinetic energy from the 'spring' \
between two beads\n\nspringkineticC calculates the contribution to the \
kinetic energy from a single pair of adjacent beads with given \
positions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"springkineticC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"post1", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"post2", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Norm", "[", 
        RowBox[{"post1", "-", "post2"}], "]"}], "2"], 
      RowBox[{"4", "\[Lambda]", " ", "\[Tau]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"place", "::", "usage"}], "=", 
   "\"\<place[length,placed]\nlength - the length of the list\nplaced - the \
position which may sit within a list of length 'length', or may sit within \
'length' either side of it\nRETURN - an integer expressing a new value of \
placed\n\nplace rounds placed to sit within the range [1,length], useful if \
labels have been cycled\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"place", "[", 
    RowBox[{"length_", ",", "placed_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"placed", ">", "length"}], ",", 
     RowBox[{"placed", "-", "length"}], ",", 
     RowBox[{"0", "<", "placed", "\[LessEqual]", "length"}], ",", "placed", 
     ",", 
     RowBox[{"placed", "\[LessEqual]", "0"}], ",", 
     RowBox[{"placed", "+", "length"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalVariate", "::", "usage"}], "=", 
   "\"\<normalVariate[\[Mu],\[Sigma],dimensionality]\n\[Mu] - mean value to \
draw values around (usually 0)\n\[Sigma] - standard deviation of samples to \
draw\ndimensionality - dimension of the system\nRETURN - a {dimensionality} \
position vector of random values drawn from a normal distribution\n\n\
normalVariate gives a random vector drawn from a normal distribution with \
mean \[Mu] and standard deviation \[Sigma]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalVariate", "[", 
    RowBox[{"\[Mu]_", ",", "\[Sigma]_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", "dimensionality"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleBeadDisplace", "::", "usage"}], "=", 
   "\"\<singleBeadDisplace[path,\[Lambda],\[Tau],dimensionality]\npath - list \
of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - {move accepted \
(True/False),new path}\n\nsingleBeadDisplace randomly selects one particle, \
relabels its beads, then moves the second bead of this particle by random \
vector.  If move is accepted (acceptprob>randomreal), replace position of \
this bead with new position\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleBeadDisplace", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "part", ",", "shuffledistance", ",", "temppath", ",", "temppos", ",", 
       "acold", ",", "acnew", ",", "acceptprob"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"shuffledistance", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", "part", "]"}], "]"}], ")"}]}]}], "}"}], "]"}]}], 
      ";", 
      RowBox[{"temppath", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RotateLeft", "[", 
          RowBox[{"#", ",", "shuffledistance"}], "]"}], "&"}], "/@", 
        "path"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", "temppath"}], ";", 
      RowBox[{
       RowBox[{"temppos", "[", 
        RowBox[{"[", 
         RowBox[{"part", ",", "2"}], "]"}], "]"}], "+=", 
       RowBox[{"normalVariate", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}], ",", 
         "dimensionality"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"acold", "=", 
       RowBox[{
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}],
          "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}],
          "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "3"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"acnew", "=", 
       RowBox[{
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}], 
         "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "2"}], 
         "]"}], "+", 
        RowBox[{"kineticAction1bead", "[", 
         RowBox[{
         "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "3"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"acceptprob", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"acnew", "-", "acold"}], ")"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
       "*", "1", " ", "for", " ", "Bayesian", " ", "prob", " ", "of", " ", 
        "going", " ", "this", " ", "way", " ", "vs", " ", "the", " ", 
        RowBox[{"other", ":", " ", 
         RowBox[{
         "needs", " ", "modifying", " ", "when", " ", "change", " ", 
          "dist"}]}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"acceptprob", ">", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "temppath"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleElectronDisplace", "::", "usage"}], "=", 
   "\"\<singleElectronDisplace[path,\[Lambda],\[Tau],dimensionality]\npath - \
list of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - {move accepted \
(True/False),new path}\n\nsingleElectronDisplace randomly selects one \
particle, shifts all the beads of it by a random vector.  If move is accepted \
(acceptprob>randomreal), replace electron positions with new positions\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singleElectronDisplace", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "part", ",", "shuffle", ",", "temppos", ",", "temppost", ",", "enold", 
       ",", "ennew", ",", "acceptprob"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"shuffle", "=", 
       RowBox[{"normalVariate", "[", 
        RowBox[{"0", ",", 
         RowBox[{"10", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
         "dimensionality"}], "]"}]}], ";", 
      RowBox[{"temppost", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "+", "shuffle"}], ")"}], "&"}], "/@", 
        RowBox[{"path", "[", 
         RowBox[{"[", "part", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"path", ",", 
         RowBox[{"part", "\[Rule]", "temppost"}]}], "]"}]}], ";", 
      RowBox[{"enold", "=", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"bead", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"path", "[", 
              RowBox[{"[", "part", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], ";", 
      RowBox[{"ennew", "=", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"bead", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"temppos", "[", 
              RowBox[{"[", "part", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], ";", 
      RowBox[{"acceptprob", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
       "*", "1", " ", "for", " ", "Bayesian", " ", "prob", " ", "of", " ", 
        "going", " ", "this", " ", "way", " ", "vs", " ", "the", " ", 
        RowBox[{"other", ":", " ", 
         RowBox[{
         "needs", " ", "modifying", " ", "when", " ", "change", " ", 
          "dist"}]}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"acceptprob", ">", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "path"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMover", "::", "usage"}], "=", 
   "\"\<bisectionMover[path,places,\[Lambda],\[Tau],dimensionality]\npath - \
list of all bead positions at a given time step for a given particle (note \
unusual definition)\nplaces - a list of three bead numbers, of which the \
second corresponds to a bead to be moved\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - a {dimensionality} \
position vector for the new position of the second bead in 'places'\n\n\
bisectionMover is a function to bisect given bead positions to find a new \
bead position, and then offset from it a random amount drawn from a normal \
distribution of order the thermal wavelength.  Note, almost always better to \
use bisectionMoverC\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMover", "[", 
    RowBox[{"path_", ",", 
     RowBox[{"places_", "?", "VectorQ"}], ",", "\[Lambda]_", ",", "\[Tau]_", 
     ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"path", "[", 
       RowBox[{"[", 
        RowBox[{"places", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
      RowBox[{"path", "[", 
       RowBox[{"[", 
        RowBox[{"places", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "2"], "+", 
    RowBox[{"normalVariate", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}], ",", "dimensionality"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoverC", "::", "usage"}], "=", 
   "\"\<bisectionMoverC[path,places,\[Lambda],\[Tau],dimensionality]\npath - \
list of all bead positions at a given time step for a given particle (note \
unusual definition)\nplaces - a list of three bead numbers, of which the \
second corresponds to a bead to be moved\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - a {dimensionality} \
position vector for the new position of the second bead in 'places'\n\n\
bisectionMoverC is a function to bisect given bead positions to find a new \
bead position, and then offset from it a random amount drawn from a normal \
distribution of order the thermal wavelength\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bisectionMoverC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"path", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"places", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimensionality", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"places", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"places", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "2"], "+", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Lambda]", " ", "\[Tau]"}], "]"}]}], "]"}], ",", 
        "dimensionality"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMove", "::", "usage"}], "=", 
   "\"\<bisectionMove[path,\[Lambda],\[Tau],dimensionality]\npath - list of \
all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
dimensionality - dimension of the system\nRETURN - {move accepted \
(True/False),new path}\n\nbisectionMove randomly selects one particle, \
relabls its beads, then implements a bisection algorithm on its beads.  In \
this algorithm, for each step the middle bead of the subsections of the \
arrays is moved by a random distance set to sample the kinetic energy density \
matrix.  Then, at each step, the potential energy is compared with old move, \
and accepted or not. DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMove", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l", ",", "part", ",", "shuffledistance", ",", "temppath", ",", 
       "temppos", ",", "range", ",", "newrange", ",", "sets", ",", 
       "movedparticles", ",", "enold", ",", "ennew", ",", "acceptprob", ",", 
       "complete", ",", "rand", ",", "probofmove"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"shuffledistance", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", "part", "]"}], "]"}], ")"}]}]}], "}"}], "]"}]}], 
      ";", 
      RowBox[{"temppath", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RotateLeft", "[", 
          RowBox[{"#", ",", "shuffledistance"}], "]"}], "&"}], "/@", 
        "path"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Floor", "@", 
           RowBox[{"Log2", "[", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"path", "[", 
               RowBox[{"[", "part", "]"}], "]"}]}], "-", "1"}], "]"}]}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", "temppath"}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"complete", "=", 
       RowBox[{"Catch", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"l", "-", "1"}]}], ",", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", 
                  RowBox[{"{", "range", "}"}]}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{"range", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "+", "1"}], ",", 
                  SuperscriptBox["2", "i"]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", "range"}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    SuperscriptBox["2", "i"]}], "]"}], "&"}], "/@", "range"}],
                   ",", "1"}], "]"}]}]}]}], "]"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"temppos", "[", 
                 RowBox[{"[", 
                  RowBox[{"part", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                RowBox[{"bisectionMoverC", "[", 
                 RowBox[{
                  RowBox[{"temppos", "[", 
                   RowBox[{"[", "part", "]"}], "]"}], ",", "#", ",", 
                  "\[Lambda]", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "\[Tau]"}], ",", 
                  "dimensionality"}], "]"}]}], ")"}], "&"}], "/@", "sets"}], 
            ";", 
            RowBox[{"range", "=", "newrange"}], ";", 
            RowBox[{"movedparticles", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "sets"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"enold", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{"temppath", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ennew", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{"temppos", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"acceptprob", "=", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}], "&"}], "/@", 
                 RowBox[{"(", "acceptprob", ")"}]}], ",", "TrueQ"}], "]"}], 
              ",", 
              RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ";", 
            RowBox[{"temppath", "=", "temppos"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"l", "-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "True"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"complete", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"probofmove", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"2", "\[Lambda]", " ", 
                  SuperscriptBox["2", "i"], "\[Tau]"}]], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Norm", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "2"], "-", 
                    RowBox[{"temppos", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "]"}], "2"], "-", 
                  SuperscriptBox[
                   RowBox[{"Norm", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "2"], "-", 
                    RowBox[{"temppath", "[", 
                    RowBox[{"[", 
                    RowBox[{"part", ",", 
                    RowBox[{"sets", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "]"}], "2"]}], ")"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"enold", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{
                "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",",
                  "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",",
                  "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 RowBox[{"bead", "+", "1"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"bead", ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ennew", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"potentialAction1bead", "[", 
                RowBox[{
                "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 "bead"}], "]"}], "+", 
               RowBox[{"kineticAction1bead", "[", 
                RowBox[{
                "temppos", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
                 RowBox[{"bead", "+", "1"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"bead", ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], "}"}]}], 
             "]"}]}], ";", 
           RowBox[{"acceptprob", "=", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"acceptprob", "=", 
            RowBox[{"acceptprob", "*", "probofmove"}]}], ";", 
           RowBox[{"complete", "=", 
            RowBox[{"AllTrue", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", ">", 
                  RowBox[{"RandomReal", "[", "]"}]}], ")"}], "&"}], "/@", 
               "acceptprob"}], ",", "TrueQ"}], "]"}]}], ";"}]}], "]"}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"complete", ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "path"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoveStatistics", "::", "usage"}], "=", 
   "\"\<bisectionMoveStatistics[path,\[Lambda],\[Tau],joined,maxcyclelength,\
dimensionality]\npath - list of all particle and bead positions at a given \
time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \
\(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a measure \
of inverse temperature\njoined - an association of each particle, showing \
which particle is joined before it\nmaxcyclelength - the maximum number of \
particles to attempt to permute labels of in a single move\ndimensionality - \
dimension of the system\nRETURN - {move accepted (True/False),new path}\n\n\
bisectionMoveStatistics randomly selects one particle, relabls its beads, \
then implements a bisection algorithm on its beads.  In this algorithm, for \
each step the middle bead of the subsections of the arrays is moved by a \
random distance set to sample the kinetic energy density matrix.  Then, at \
each step, the potential energy is compared with old move, and accepted or \
not.  In addition, chains of beads can join or split apart (implementing \
bosonic statistics), handled by the association 'joined'\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisectionMoveStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "joined_", ",", 
     "maxcyclelength_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "beads", ",", "l", ",", "part", ",", "shuffledistance", ",", "temppath",
        ",", "temppos", ",", "range", ",", "newrange", ",", "sets", ",", 
       "movedparticles", ",", "enold", ",", "ennew", ",", "acceptprob", ",", 
       "complete", ",", "rand", ",", "probofmove", ",", "newjoined", ",", 
       "cyclelength"}], "}"}], ",", 
     RowBox[{
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"beads", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"path", "[", 
         RowBox[{"[", "part", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"shuffledistance", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "beads"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temppath", "=", "path"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "shuffledistance"}], ",", 
          RowBox[{
           RowBox[{"temppath", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"joined", "[", "i", "]"}], ",", 
              RowBox[{"j", "-", "shuffledistance", "-", "1"}]}], "]"}], "]"}],
            "=", 
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"temppath", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "-", "shuffledistance"}]}], "]"}], "]"}], "=", 
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "path"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "beads"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyclelength", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Min", "[", 
           RowBox[{"maxcyclelength", ",", 
            RowBox[{"Length", "@", "path"}]}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newjoined", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cyclelength", "\[Equal]", "1"}], ",", "joined", ",", 
         RowBox[{"permutationSampler", "[", 
          RowBox[{
          "temppath", ",", "\[Lambda]", ",", "\[Tau]", ",", "joined", ",", 
           "cyclelength", ",", "beads"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Floor", "@", 
           RowBox[{"Log2", "[", 
            RowBox[{"beads", "-", "1"}], "]"}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temppos", "=", "temppath"}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         SuperscriptBox["2", "l"], "+", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"complete", "=", 
       RowBox[{"Catch", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"l", "-", "1"}]}], ",", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", 
                  RowBox[{"{", "range", "}"}]}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{"range", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "+", "1"}], ",", 
                  SuperscriptBox["2", "i"]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"sets", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "0"], ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"i", "+", "1"}]], "+", "1"}]}], "}"}], "]"}], 
                    "]"}], "&"}], "/@", "range"}], ")"}]}], ";", 
               RowBox[{"newrange", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    SuperscriptBox["2", "i"], "+", "1"}], ",", 
                    SuperscriptBox["2", "i"]}], "]"}], "&"}], "/@", "range"}],
                   ",", "1"}], "]"}]}]}]}], "]"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"temppos", "[", 
                 RowBox[{"[", 
                  RowBox[{"part", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                RowBox[{"bisectionMoverC", "[", 
                 RowBox[{
                  RowBox[{"temppos", "[", 
                   RowBox[{"[", "part", "]"}], "]"}], ",", "#", ",", 
                  "\[Lambda]", ",", 
                  RowBox[{
                   SuperscriptBox["2", "i"], "\[Tau]"}], ",", 
                  "dimensionality"}], "]"}]}], ")"}], "&"}], "/@", "sets"}], 
            ";", 
            RowBox[{"range", "=", "newrange"}], ";", 
            RowBox[{"movedparticles", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "sets"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"enold", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1beadStatisticsC", "[", 
                RowBox[{"temppath", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"Values", "@", "newjoined"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ennew", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"potentialAction1beadStatisticsC", "[", 
                RowBox[{"temppos", ",", "\[Lambda]", ",", 
                 RowBox[{
                  SuperscriptBox["2", "i"], "\[Tau]"}], ",", "part", ",", 
                 RowBox[{"sets", "[", 
                  RowBox[{"[", 
                   RowBox[{"bead", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"Values", "@", "newjoined"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"bead", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "sets"}]}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"acceptprob", "=", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"ennew", "-", "enold"}], ")"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}], "&"}], "/@", 
                 RowBox[{"(", "acceptprob", ")"}]}], ",", "TrueQ"}], "]"}], 
              ",", 
              RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ";", 
            RowBox[{"temppath", "=", "temppos"}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"l", "-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "True"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"complete", ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "temppos", ",", "newjoined"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "path", ",", "joined"}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"permutationSampler", "::", "usage"}], "=", 
   "\"\<permutationSampler[path,\[Lambda],\[Tau],joined,cyclelength,beads]\n\
path - list of all particle and bead positions at a given time step\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\njoined - an association of each particle, showing which particle \
is joined before it\ncyclelength - the number of particles whose labels are \
being permuted\nbeads - the number of beads/slices per uncorrelated particle\n\
RETURN - an association of the newly joined particle labels\n\n\
permutationSampler samples permutations of the different particle labels, and \
returns a new joined association if energetically favourable\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"permutationSampler", "[", 
     RowBox[{
     "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "joined_", ",", 
      "cyclelength_", ",", "beads_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "places", ",", "parts", ",", "position", ",", "ttransvector", ",", 
        "tdirvector", ",", "hvector", ",", "tempjoined", ",", "harr"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"places", "=", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "path"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tempjoined", "=", "joined"}], ";", "\[IndentingNewLine]", 
       RowBox[{"parts", "=", 
        RowBox[{
         RowBox[{"Reap", "[", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"position", "=", 
              RowBox[{"places", "[", 
               RowBox[{"[", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Length", "@", "places"}]}], "}"}], "]"}], "]"}], 
               "]"}]}], ";", 
             RowBox[{"Sow", "[", "position", "]"}], ";", 
             RowBox[{"places", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"places", ",", 
                RowBox[{"Position", "[", 
                 RowBox[{"places", ",", "position"}], "]"}]}], "]"}]}], ";"}],
             "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Length", "@", "path"}], ",", "cyclelength"}], 
               "]"}]}], "}"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tempjoined", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "=", 
           RowBox[{"joined", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"parts", ",", 
            RowBox[{"{", 
             RowBox[{"parts", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", "2", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ttransvector", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"springkineticC", "[", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
               ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[Lambda]", ",", 
               RowBox[{"\[Tau]", " ", 
                RowBox[{"N", "[", "beads", "]"}]}]}], "]"}]}], "]"}], "&"}], 
          ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"parts", ",", 
              RowBox[{"{", 
               RowBox[{"parts", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", "2", ",",
             "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tdirvector", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"springkineticC", "[", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
               ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[Lambda]", ",", 
               RowBox[{"\[Tau]", " ", 
                RowBox[{"N", "[", "beads", "]"}]}]}], "]"}]}], "]"}], "&"}], 
          ",", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
             RowBox[{"Normal", "@", "joined"}]}], "]"}], "[", 
           RowBox[{"[", "parts", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"harr", "[", "i_", "]"}], ":=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"springkineticC", "[", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[Lambda]", ",", 
               RowBox[{"\[Tau]", " ", 
                RowBox[{"N", "[", "beads", "]"}]}]}], "]"}]}], "]"}], "&"}], 
          ",", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "path"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hvector", "=", 
        RowBox[{"Total", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"harr", "[", "#", "]"}], "&"}], ",", "parts"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], "<", 
          FractionBox[
           RowBox[{"Total", "[", 
            RowBox[{"hvector", "/", "tdirvector"}], "]"}], 
           RowBox[{"Total", "[", 
            RowBox[{"hvector", "/", "ttransvector"}], "]"}]]}], ",", 
         "tempjoined", ",", "joined"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "potential", " ", "action", " ", "contribution", " ", "of", 
     " ", "each", " ", "particle", " ", "to", " ", "the", " ", "action"}], 
    ",", " ", 
    RowBox[{
    "symmetrized", " ", "and", " ", "in", " ", "the", " ", "primitive", " ", 
     "approximation"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1bead", "::", "usage"}], "=", 
   "\"\<potentialAction1bead[path,\[Lambda],\[Tau],particle,bead]\npath - \
list of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
particle - the particular particle to calculate the contribution to the \
potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the potential action for\nRETURN - a real \
number expressing the potential action of that particle bead in all \
potentials\n\npotentialAction1bead gives the potential action contribution of \
each particle to the action, symmetrized and in the primitive approximation. \
DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1bead", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["\[Tau]", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"extV", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"particle", ",", 
           RowBox[{"place", "[", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"path", "[", 
               RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
             RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], "]"}], "+", 
       RowBox[{"extV", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], ")"}]}], 
    RowBox[{"(*", 
     RowBox[{"\[Tau]", " ", 
      RowBox[{"extV", "[", 
       RowBox[{"path", "[", 
        RowBox[{"[", 
         RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{"\[Tau]", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"extV", "[", 
         RowBox[{
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", 
             RowBox[{"place", "[", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"path", "[", 
                 RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
               RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
            ")"}], "s"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
          "}"}]}]}], "]"}]}], "*)"}], "+", 
    RowBox[{"(*", 
     RowBox[{
      FractionBox["\[Tau]", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"intpartV", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", "path"}], ",", 
                  RowBox[{"particle", "+", "j"}]}], "]"}], ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], "]"}]}],
         "+", 
        RowBox[{"Total", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"intpartV", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", "path"}], ",", 
                  RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], 
               "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
          "]"}]}]}], ")"}]}], "*)"}], 
    RowBox[{"\[Tau]", " ", 
     RowBox[{"Total", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"intpartV", "[", 
         RowBox[{
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"place", "[", 
              RowBox[{
               RowBox[{"Length", "@", "path"}], ",", 
               RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], "]"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatistics", "::", "usage"}], "=", 
   "\"\<potentialAction1beadStatistics[path,\[Lambda],\[Tau],particle,bead,\
joined]\npath - list of all particle and bead positions at a given time step\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\nparticle - the particular particle to calculate the contribution \
to the potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the potential action for\njoined - an \
association of each particle, showing which particle is joined before it\n\
RETURN - a real number expressing the potential action of that particle bead \
in all potentials\n\npotentialAction1beadStatistics gives the potential \
action contribution of each particle to the action, symmetrized, including \
the possibility of permutations, and in the primitive approximation. Note: \
generally better to use potentialAction1beadStatisticsC\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatisticsC", "::", "usage"}], "=", 
   "\"\<potentialAction1beadStatisticsC[path,\[Lambda],\[Tau],particle,bead,\
joined]\npath - list of all particle and bead positions at a given time step\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\nparticle - the particular particle to calculate the contribution \
to the potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the potential action for\njoined - an array \
showing which particle is joined before the corresponding particle (note \
unusual definition: Values@joined)\nRETURN - a real number expressing the \
potential action of that particle bead in all potentials\n\n\
potentialAction1beadStatisticsC gives the potential action contribution of \
each particle to the action, symmetrized, including the possibility of \
permutations, and in the primitive approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialAction1beadStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead_", ",", "joined_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["\[Tau]", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"bead", "\[Equal]", "1"}], ",", 
         RowBox[{"extV", "[", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"joined", "[", "particle", "]"}], ",", 
             RowBox[{"Length", "@", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{"joined", "[", "particle", "]"}], "]"}], "]"}]}]}], 
            "]"}], "]"}], "]"}], ",", 
         RowBox[{"extV", "[", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", 
             RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "]"}]}], "]"}], "+", 
       RowBox[{"extV", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", 
          RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], ")"}]}], 
    "+", 
    RowBox[{"\[Tau]", " ", 
     RowBox[{"Total", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"intpartV", "[", 
         RowBox[{
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"place", "[", 
              RowBox[{
               RowBox[{"Length", "@", "path"}], ",", 
               RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], "]"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
       "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction1bead", "::", "usage"}], "=", 
   "\"\<kineticAction1bead[path,\[Lambda],\[Tau],particle,bead]\npath - list \
of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
particle - the particular particle to calculate the contribution to the \
potential action for\nbead - the particular bead of that particle to \
calculate the contribution to the kinetic action for\nRETURN - a real number \
expressing the kinetic action of that particle bead\n\nkineticAction1bead \
gives the kinetic action contribution of each particle bead to the \
action\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction1bead", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead_"}], "]"}], ":=", 
   RowBox[{"springkinetic", "[", 
    RowBox[{
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", 
          RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead"}], "]"}]}], 
       "]"}], "]"}], ",", "\[Lambda]", ",", "\[Tau]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction2bead", "::", "usage"}], "=", 
   "\"\<kineticAction2bead[path,\[Lambda],\[Tau],particle,bead1,bead2]\npath \
- list of all particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
particle - the particular particle to calculate the contribution to the \
potential action for\nbead1 - one particular bead of that particle to \
calculate the contribution to the kinetic action for\nbead2 - another \
particular bead of that particle to calculate the contribution to the kinetic \
action for\nRETURN - a real number expressing the kinetic action of two beads\
\n\nkineticAction2bead gives the kinetic action contribution of a pair of \
particle beads to the action\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticAction2bead", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "particle_", ",", 
     "bead1_", ",", "bead2_"}], "]"}], ":=", 
   RowBox[{"springkinetic", "[", 
    RowBox[{
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead1"}], "]"}]}], 
       "]"}], "]"}], ",", 
     RowBox[{"path", "[", 
      RowBox[{"[", 
       RowBox[{"particle", ",", 
        RowBox[{"place", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"path", "[", 
            RowBox[{"[", "particle", "]"}], "]"}]}], ",", "bead2"}], "]"}]}], 
       "]"}], "]"}], ",", "\[Lambda]", ",", "\[Tau]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticActionOffset", "::", "usage"}], "=", 
   "\"\<kineticActionOffset[\[Lambda],\[Tau],numparticles,numslices,\
dimensionality]\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - the number of particles in the \
system\nnumslices - the number of slices/beads for each particle\n\
dimensionality - the dimension of the system\nRETURN - a real number giving \
the classical contribution to the kinetic energy\n\nkineticActionOffset \
calculates the semi-classical kinetic energy of a particle for use in \
virial-style estimators\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kineticActionOffset", "[", 
    RowBox[{
    "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", "numslices_", 
     ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", "numparticles", " ", "numslices"}], "2"], 
      RowBox[{"Log", "[", 
       RowBox[{"4", "\[Pi]", " ", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
     RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
     RowBox[{"numparticles", " ", "numslices", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"2", "\[Pi]", " ", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimator", "::", "usage"}], "=", 
   "\"\<virialTotalEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total energy\n\nvirialTotalEnergyEstimator gives an estimator for the total \
energy, calculated in the virial approximation. DEPRECATED\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
         RowBox[{"vprime", "[", 
          RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimator", "::", "usage"}], "=", 
   "\"\<virialTotalEnergySquaredEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total squared energy\n\nvirialTotalEnergySquaredEstimator gives an estimator \
for the total energy squared, calculated in the virial approximation. \
DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", 
              RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
           RowBox[{"vprime", "[", 
            RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimatorStatistics", "::", "usage"}], "=", 
   "\"\<virialTotalEnergyEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total energy\n\n\
virialTotalEnergyEstimatorStatistics gives an estimator for the total energy, \
calculated in the virial approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergyEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
         RowBox[{"vprime", "[", 
          RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1beadStatisticsC", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
          ",", 
          RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "::", "usage"}], 
   "=", "\"\<virialTotalEnergySquaredEstimatorStatistics[path,\[Lambda],\[Tau]\
,numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total squared \
energy\n\nvirialTotalEnergySquaredEstimatorStatistics gives an estimator for \
the total energy squared, calculated in the virial approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", 
              RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
           RowBox[{"vprime", "[", 
            RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1beadStatisticsC", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
            ",", 
            RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimator", "::", "usage"}], "=", 
   "\"\<thermTotalEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total energy\n\nthermTotalEnergyEstimator gives an estimator for the total \
energy, calculated in the thermodynamic approximation. DEPRECATED\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]"}]], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"part", ",", 
              RowBox[{"place", "[", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"path", "[", 
                  RowBox[{"[", "part", "]"}], "]"}]}], ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], "]"}], 
         "2"], 
        RowBox[{"4", "\[Lambda]", " ", 
         SuperscriptBox["\[Tau]", "2"]}]], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1bead", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimator", "::", "usage"}], "=", 
   "\"\<thermTotalEnergySquaredEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total squared energy\n\nthermTotalEnergySquaredEstimator gives an estimator \
for the total energy squared, calculated in the thermodynamic approximation. \
DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]"}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", 
                RowBox[{"place", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", "part", "]"}], "]"}]}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}]}], "]"}], "]"}]}], 
            "]"}], "2"], 
          RowBox[{"4", "\[Lambda]", " ", 
           SuperscriptBox["\[Tau]", "2"]}]], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1bead", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", 
            "bead"}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimatorStatistics", "::", "usage"}], "=", 
   "\"\<thermTotalEnergyEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total energy\n\n\
thermTotalEnergyEstimatorStatistics gives an estimator for the total energy, \
calculated in the thermodynamic approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergyEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]"}]], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", 
             RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"bead", "\[Equal]", "1"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], 
         "2"], 
        RowBox[{"4", "\[Lambda]", " ", 
         SuperscriptBox["\[Tau]", "2"]}]], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1beadStatisticsC", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
          ",", 
          RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "::", "usage"}], 
   "=", "\"\<thermTotalEnergySquaredEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total squared \
energy\n\nthermTotalEnergySquaredEstimatorStatistics gives an estimator for \
the total energy squared, calculated in the thermodynamic \
approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]"}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", "bead"}], "]"}], "]"}], "-", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"bead", "\[Equal]", "1"}], ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{"part", ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], "]"}]}], 
            "]"}], "2"], 
          RowBox[{"4", "\[Lambda]", " ", 
           SuperscriptBox["\[Tau]", "2"]}]], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1beadStatisticsC", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
            ",", 
            RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "::", "usage"}], "=", 
   "\"\<fullVirialTotalEnergyEstimatorStatistics[path,\[Lambda],\[Tau],\
numparticles,numslices,joined,dimensionality]\npath - list of all particle \
and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total energy\n\n\
fullVirialTotalEnergyEstimatorStatistics gives an estimator for the total \
energy, calculated in the virial approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox["dimensionality", 
        RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"path", "[", 
           RowBox[{"[", 
            RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
         RowBox[{"vprime", "[", 
          RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", " ", "numparticles", " ", "numslices", " ", 
          SuperscriptBox["\[Tau]", "2"], "\[Lambda]"}]], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"bead", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", 
                 RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
              "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", 
                 RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{"part", ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
              "]"}], "-", 
             RowBox[{"path", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"joined", "[", "part", "]"}], ",", 
                RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
         "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"potentialAction1beadStatisticsC", "[", 
         RowBox[{
         "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
          ",", 
          RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergySquaredEstimatorStatistics", "::", "usage"}],
    "=", "\"\<fullVirialTotalEnergySquaredEstimatorStatistics[path,\[Lambda],\
\[Tau],numparticles,numslices,joined,dimensionality]\npath - list of all \
particle and bead positions at a given time step\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - number of particles in the system\nnumslices - number of \
slices/beads per particle\njoined - an association of each particle, showing \
which particle is joined before it\ndimensionality - the dimension of the \
system\nRETURN - a real number giving an estimator for the total squared \
energy\n\nfullVirialTotalEnergySquaredEstimatorStatistics gives an estimator \
for the total energy squared, calculated in the virial approximation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullVirialTotalEnergySquaredEstimatorStatistics", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"numslices", " ", "numparticles"}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["dimensionality", 
          RowBox[{"2", "\[Tau]", " ", "numslices"}]], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"path", "[", 
             RowBox[{"[", 
              RowBox[{"part", ",", "bead"}], "]"}], "]"}], ")"}], ".", 
           RowBox[{"vprime", "[", 
            RowBox[{"path", ",", "part", ",", "bead"}], "]"}]}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"4", " ", "numparticles", "  ", "numslices", " ", 
            SuperscriptBox["\[Tau]", "2"], "\[Lambda]"}]], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"bead", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", 
                   RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
                "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", 
                   RowBox[{"joined", "[", "part", "]"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{"part", ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", "bead"}], "]"}], 
                "]"}], "-", 
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "part", "]"}], ",", 
                  RowBox[{"bead", "-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
           "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "\[Tau]"], 
          RowBox[{"potentialAction1beadStatisticsC", "[", 
           RowBox[{
           "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "part", ",", "bead", 
            ",", 
            RowBox[{"Values", "@", "joined"}]}], "]"}]}]}], ")"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"part", ",", "1", ",", "numparticles"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bead", ",", "1", ",", "numslices"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeTotalEnergyEstimator", "::", "usage"}], "=", 
   "\"\<heinzeTotalEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
total energy\n\nheinzeTotalEnergyEstimator gives an estimator for the total \
energy, calculated according to the Heinze procedure, see \
http://oops.uni-oldenburg.de/274/1/304.pdf, p. 26.  Note: factor of 2 is a \
fudge, not properly physically motivated\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeTotalEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"heinzeKineticEnergyEstimator", "[", 
       RowBox[{
       "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
        "numslices", ",", "dimensionality"}], "]"}], "+", 
      RowBox[{"heinzePotentialEnergyEstimator", "[", 
       RowBox[{
       "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
        "numslices", ",", "dimensionality"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeKineticEnergyEstimator", "::", "usage"}], "=", 
   "\"\<heinzeKineticEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
kinetic energy\n\nheinzeKineticEnergyEstimator gives an estimator for the \
kinetic energy, calculated according to the Heinze procedure, see \
http://oops.uni-oldenburg.de/274/1/304.pdf, p. 26\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeKineticEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairDist", ",", "particleDist"}], "}"}], ",", 
     RowBox[{
      RowBox[{"pairDist", "=", 
       RowBox[{"heinzePairDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{"particleDist", "=", 
       RowBox[{"heinzeParticleDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numparticles", ">", "1"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"numparticles", "-", "1"}], 
           RowBox[{"4", 
            RowBox[{"Length", "@", "pairDist"}]}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pairDist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"derivIntpartV", "[", 
              RowBox[{
               RowBox[{"pairDist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "pairDist"}]}], "}"}]}], "]"}]}], ",", 
         "0"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"Length", "@", "particleDist"}]}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"particleDist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ".", 
           RowBox[{"derivExtV", "[", 
            RowBox[{"particleDist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "particleDist"}]}], "}"}]}], "]"}]}]}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePotentialEnergyEstimator", "::", "usage"}], "=", 
   "\"\<heinzePotentialEnergyEstimator[path,\[Lambda],\[Tau],numparticles,\
numslices,dimensionality]\npath - list of all particle and bead positions at \
a given time step\n\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \
\(2\)], \(2  m\)]\) for mass of particles m\n\[Tau] - the time step, also a \
measure of inverse temperature\nnumparticles - number of particles in the \
system\nnumslices - number of slices/beads per particle\ndimensionality - the \
dimension of the system\nRETURN - a real number giving an estimator for the \
potential energy\n\nheinzePotentialEnergyEstimator gives an estimator for the \
potential energy, calculated according to the Heinze procedure, see \
http://oops.uni-oldenburg.de/274/1/304.pdf, p. 26\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePotentialEnergyEstimator", "[", 
    RowBox[{
    "path_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "numparticles_", ",", 
     "numslices_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pairDist", ",", "particleDist"}], "}"}], ",", 
     RowBox[{
      RowBox[{"pairDist", "=", 
       RowBox[{"heinzePairDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{"particleDist", "=", 
       RowBox[{"heinzeParticleDist", "[", 
        RowBox[{"path", ",", "numparticles", ",", "numslices"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numparticles", ">", "1"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"numparticles", "-", "1"}], 
           RowBox[{"2", 
            RowBox[{"Length", "@", "pairDist"}]}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"intpartV", "[", 
             RowBox[{
              RowBox[{"pairDist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "pairDist"}]}], "}"}]}], "]"}]}], ",", 
         "0"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"Length", "@", "particleDist"}]}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"extV", "[", 
           RowBox[{"particleDist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "particleDist"}]}], "}"}]}], "]"}]}]}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePairDist", "::", "usage"}], "=", 
   "\"\<heinzePairDist[path,numparticles,numslices]\npath - list of all \
particle and bead positions at a given time step\nnumparticles - number of \
particles in the system\nnumslices - number of slices/beads per particle\n\
RETURN - an array of inter-particle distance vectors\n\nheinzePairDist gives \
an approximation to the density-density correlation function, calculated at \
each time step, for use in calculating the total energy\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzePairDist", "[", 
    RowBox[{"path_", ",", "numparticles_", ",", "numslices_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Transpose", "@", "path"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeParticleDist", "::", "usage"}], "=", 
   "\"\<heinzeParticleDist[path,numparticles,numslices]\npath - list of all \
particle and bead positions at a given time step\nnumparticles - number of \
particles in the system\nnumslices - number of slices/beads per particle\n\
RETURN - an array of position vectors\n\nheinzeParticleDist gives an \
approximation to the density, calculated at each time step, for use in \
calculating the total energy\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heinzeParticleDist", "[", 
    RowBox[{"path_", ",", "numparticles_", ",", "numslices_"}], "]"}], ":=", 
   RowBox[{"Join", "@@", "path"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialPlot", "::", "usage"}], "=", 
   "\"\<potentialPlot[path,dimensionality]\npath - list of all particle and \
bead positions at a given time step\ndimensionality - the dimension of the \
system\nRETURN - a plot of the external potential\n\npotentialPlot creates a \
plot of the external potential, given a realisation of particle \
positions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potentialPlot", "[", 
    RowBox[{"path_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", "zmin", ",", 
       "zmax"}], "}"}], ",", 
     RowBox[{
      RowBox[{"xmin", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"xmax", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"ymin", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"ymax", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{
          RowBox[{"Catenate", "@", "path"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"zmin", "=", 
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{
             RowBox[{"Catenate", "@", "path"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{"zmax", "=", 
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{
             RowBox[{"Catenate", "@", "path"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{"SliceDensityPlot3D", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"extV", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], 
           RowBox[{"extV", "[", 
            RowBox[{"{", 
             RowBox[{"xmax", ",", "ymax", ",", "zmax"}], "}"}], "]"}]], ",", 
          "\"\<BackPlanes\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
        RowBox[{"DensityPlot", "[", 
         RowBox[{
          RowBox[{"extV", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ","}], 
           "*)"}], 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ymax", "-", "ymin"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPlot", "::", "usage"}], "=", 
   "\"\<energyPlot[energyVirial,energyFullVirial,energyTherm,energyHeinze,\
energysaverarrayvirial,energysaverarrayfullvirial,energysaverarraytherm,\
energysaverarrayheinze,invvarvirial,invvarfullvirial,invvartherm,invvarheinze,\
equilibrationsteps,numsteps,harmonictrap,\[Omega],\[Tau],slices,\
dimensionality]\nenergyVirial - whether to calculate the energy in the virial \
approximation\nenergyFullVirial - whether to calculate the energy in the full \
virial approximation\nenergyTherm - whether to calculate the energy in the \
thermodynamic approximation\nenergyHeinze - whether to calculate the energy \
using the Heinze procedure\nenergysaverarrayvirial - an array of energies \
calculated in the virial approximation\nenergysaverarrayfullvirial - an array \
of energies calculated in the full virial approximation\n\
energysaverarraytherm - an array of energies calculated in the thermodynamic \
approximation\nenergysaverarrayheinze - an array of energies calculated using \
the Heinze procedure\ninvvarvirial - an array of inverse variances of the \
energy calculated in the virial approximation\ninvvarfullvirial - an array of \
inverse variances of the energy calculated in the full virial approximation\n\
invvartherm - an array of inverse variances of the energy calculated in the \
thermodynamic approximation\ninvvarheinze - an array of inverse variances of \
the energy calculated using the Heinze procedure\nequilibrationsteps - the \
number of equilibration steps taken before calculating estimators\nnumsteps - \
the total number of time steps used\nharmonictrap - whether to calculate \
properties in a corresponding harmonic trap\n\[Omega] - corresponding \
harmonic trap frequency\n\[Tau] - the time step, also a measure of inverse \
temperature\nslices - number of slices/beads per particle\ndimensionality - \
the dimension of the system\nRETURN - a plot of the energy estimators in the \
system\n\nenergyPlot creates a plot of the energy estimators as a function of \
step number, showing also the average values and their error bars and \
analytic approximations if requested\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPlot", "[", 
    RowBox[{
    "energyVirial_", ",", "energyFullVirial_", ",", "energyTherm_", ",", 
     "energyHeinze_", ",", "energysaverarrayvirial_", ",", 
     "energysaverarrayfullvirial_", ",", "energysaverarraytherm_", ",", 
     "energysaverarrayheinze_", ",", "invvarvirial_", ",", 
     "invvarfullvirial_", ",", "invvartherm_", ",", "invvarheinze_", ",", 
     "equilibrationsteps_", ",", "numsteps_", ",", "harmonictrap_", ",", 
     "\[Omega]_", ",", "\[Tau]_", ",", "slices_", ",", "dimensionality_"}], 
    "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", "energysaverarrayvirial"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", "energysaverarrayfullvirial"}], 
          "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", "energysaverarraytherm"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", "energysaverarrayheinze"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"GridLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           FractionBox["equilibrationsteps", "numsteps"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"If", "[", 
            RowBox[{"harmonictrap", ",", 
             RowBox[{"exactHarmonicTrapEnergies", "[", 
              RowBox[{
              "15", ",", "\[Tau]", ",", "slices", ",", "\[Omega]", ",", 
               "dimensionality"}], "]"}], ",", "0"}], "]"}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Fractional step\>\"", ",", "\"\<Energy\>\""}], "}"}]}], 
       ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Energy per particle\>\""}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", "Blue", ",", 
          RowBox[{"Darker", "@", "Green"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"energyVirial", ",", "\"\<Virial\>\"", ",", "\"\<\>\""}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
           "energyFullVirial", ",", "\"\<Ceperley Virial\>\"", ",", 
            "\"\<\>\""}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
           "energyTherm", ",", "\"\<Thermodynamic\>\"", ",", "\"\<\>\""}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"energyHeinze", ",", "\"\<Heinze\>\"", ",", "\"\<\>\""}], 
           "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "virialEnergy", ",", "virialError", ",", "fullVirialEnergy", ",", 
         "fullVirialError", ",", "thermEnergy", ",", "thermError", ",", 
         "heinzeEnergy", ",", "heinzeError"}], "}"}], ",", 
       RowBox[{
        RowBox[{"virialEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", 
           FractionBox[
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"energysaverarrayvirial", "*", "invvarvirial"}], ")"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", "invvarvirial", ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "Null"}],
           "]"}]}], ";", 
        RowBox[{"virialError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", " ", 
           FractionBox["1", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", "invvarvirial", ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]], ",", 
           "Null"}], "]"}]}], ";", 
        RowBox[{"fullVirialEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", 
           FractionBox[
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "energysaverarrayfullvirial", "*", "invvarfullvirial"}], ")"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", "invvarfullvirial", ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "Null"}],
           "]"}]}], ";", 
        RowBox[{"fullVirialError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", " ", 
           FractionBox["1", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", "invvarfullvirial", ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]], ",", 
           "Null"}], "]"}]}], ";", 
        RowBox[{"thermEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", 
           FractionBox[
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"energysaverarraytherm", "*", "invvartherm"}], ")"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"(", "invvartherm", ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "Null"}],
           "]"}]}], ";", 
        RowBox[{"thermError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", " ", 
           FractionBox["1", 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", "invvartherm", ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]], ",", 
           "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"heinzeEnergy", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", 
           RowBox[{"Mean", "@", 
            RowBox[{"energysaverarrayheinze", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "Null"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"heinzeError", "=", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", 
           FractionBox[
            RowBox[{"StandardDeviation", "@", 
             RowBox[{"energysaverarrayheinze", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
            RowBox[{"Sqrt", "@", 
             RowBox[{"Length", "@", 
              RowBox[{"energysaverarrayheinze", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]], ",", "Null"}], 
          "]"}]}], ";", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"virialEnergy", ",", 
            RowBox[{"virialEnergy", "+", "virialError"}], ",", 
            RowBox[{"virialEnergy", "-", " ", "virialError"}], ",", 
            "fullVirialEnergy", ",", 
            RowBox[{"fullVirialEnergy", "+", "fullVirialError"}], ",", 
            RowBox[{"fullVirialEnergy", "-", " ", "fullVirialError"}], ",", 
            "thermEnergy", ",", 
            RowBox[{"thermEnergy", "+", "thermError"}], ",", 
            RowBox[{"thermEnergy", "-", "thermError"}], ",", "heinzeEnergy", 
            ",", 
            RowBox[{"heinzeEnergy", "+", "heinzeError"}], ",", 
            RowBox[{"heinzeEnergy", "-", "heinzeError"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            FractionBox["equilibrationsteps", "numsteps"], ",", "1"}], "}"}], 
          ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"energyVirial", ",", " ", "Red", ",", "None"}], "]"}], 
             ",", "None", ",", "None", ",", 
             RowBox[{"If", "[", 
              RowBox[{"energyFullVirial", ",", 
               RowBox[{"Darker", "@", "Red"}], ",", "None"}], "]"}], ",", 
             "None", ",", "None", ",", 
             RowBox[{"If", "[", 
              RowBox[{"energyTherm", ",", "Blue", ",", "None"}], "]"}], ",", 
             "None", ",", "None", ",", 
             RowBox[{"If", "[", 
              RowBox[{"energyHeinze", ",", 
               RowBox[{"Darker", "@", "Green"}], ",", "None"}], "]"}], ",", 
             "None", ",", "None"}], "}"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "2", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", 
                   RowBox[{"Lighter", "@", "Red"}]}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"6", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "5", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", "Red"}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"9", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "8", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", 
                   RowBox[{"Lighter", "@", "Blue"}]}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"12", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "11", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", "Green"}], ",", 
                  RowBox[{"Opacity", "[", "0.75", "]"}]}], "]"}]}], "}"}]}]}],
             "}"}]}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyTherm", ",", 
         RowBox[{"Style", "@@@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"energysaverarraytherm", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PointSize", "[", 
                 RowBox[{"0.025", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "10"}], "/", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@",
                "invvartherm"}], ")"}]}], "}"}], "]"}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Darker", "@", "Blue"}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyVirial", ",", 
         RowBox[{"Style", "@@@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"energysaverarrayvirial", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PointSize", "[", 
                 RowBox[{"0.025", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "10"}], "/", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@",
                "invvarvirial"}], ")"}]}], "}"}], "]"}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Darker", "@", "Red"}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyFullVirial", ",", 
         RowBox[{"Style", "@@@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"energysaverarrayfullvirial", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PointSize", "[", 
                 RowBox[{"0.025", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "10"}], "/", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@",
                "invvarfullvirial"}], ")"}]}], "}"}], "]"}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Red"}]}]}]}], "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", "energysaverarrayvirial"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", "energysaverarrayfullvirial"}], 
          "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", "energysaverarraytherm"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", "energysaverarrayheinze"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", "Blue", ",", 
          RowBox[{"Darker", "@", "Green"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathPlot", "::", "usage"}], "=", 
   "\"\<pathPlot[path,joined,dimensionality]\npath - list of all particle and \
bead positions at a given time step\njoined - an association of each \
particle, showing which particle is joined before it\ndimensionality - the \
dimension of the system\nRETURN - a plot of the position of beads in a given \
realisation\n\npathPlot plots paths, including the permutations given in the \
'joined' association\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathPlot", "[", 
    RowBox[{"path_", ",", "joined_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPointPlot3D", "[", 
        RowBox[{"path", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"Graphics3D", "@", 
        RowBox[{"Line", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", "path"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "#", "]"}], ",", "1"}], "]"}], "]"}],
                "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "path"}]}]}], "}"}]}], "]"}]}]}]}]}], 
      "]"}], ",", 
     RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{"path", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"Graphics", "@", 
        RowBox[{"Line", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", "path"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"path", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"joined", "[", "#", "]"}], ",", "1"}], "]"}], "]"}],
                "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "path"}]}]}], "}"}]}], "]"}]}]}]}]}], 
      "]"}], ",", "True", ",", 
     RowBox[{
     "Throw", "[", "\"\<Unknown dimensionality in pathPlot\>\"", "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyVirial", "::", "usage"}], "=", 
   "\"\<printEnergyVirial[energysaverarrayvirial,invvarvirial]\n\
energysaverarrayvirial - an array of energies calculated in the virial \
approximation\ninvvarvirial - an array of inverse variances of the energy \
calculated in the virial approximation\nRETURN - a string\n\n\
printEnergyVirial prints the energy expectation value and error in the virial \
approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyVirial", "[", 
    RowBox[{"energysaverarrayvirial_", ",", "invvarvirial_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Virial weighted estimator of the energy per particle                \
: \>\"", ",", 
     FractionBox[
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"energysaverarrayvirial", "*", "invvarvirial"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", "invvarvirial", ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "\"\<+/-\>\"", 
     ",", " ", 
     FractionBox["1", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", "invvarvirial", ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyFullVirial", "::", "usage"}], "=", 
   "\"\<printEnergyFullVirial[energysaverarrayvirial,invvarvirial]\n\
energysaverarrayvirial - an array of energies calculated in the full virial \
approximation\ninvvarvirial - an array of inverse variances of the energy \
calculated in the full virial approximation\nRETURN - a string\n\n\
printEnergyFullVirial prints the energy expectation value and error in the \
full virial approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyFullVirial", "[", 
    RowBox[{"energysaverarrayvirial_", ",", "invvarvirial_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Ceperley virial weighted estimator of the energy per particle       \
: \>\"", ",", 
     FractionBox[
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"energysaverarrayvirial", "*", "invvarvirial"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", "invvarvirial", ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "\"\<+/-\>\"", 
     ",", " ", 
     FractionBox["1", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", "invvarvirial", ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyTherm", "::", "usage"}], "=", 
   "\"\<printEnergyTherm[energysaverarraytherm,invvartherm]\n\
energysaverarraytherm - an array of energies calculated in the thermodynamic \
approximation\ninvvartherm - an array of inverse variances of the energy \
calculated in the thermodynamic approximation\nRETURN - a string\n\n\
printEnergyTherm prints the energy expectation value and error in the \
thermodynamic approximation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyTherm", "[", 
    RowBox[{"energysaverarraytherm_", ",", "invvartherm_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Thermodynamic weighted estimator of the energy per particle         \
: \>\"", ",", 
     FractionBox[
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"energysaverarraytherm", "*", "invvartherm"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", "invvartherm", ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]], ",", "\"\<+/-\>\"", 
     ",", " ", 
     FractionBox["1", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", "invvartherm", ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyHeinze", "::", "usage"}], "=", 
   "\"\<printEnergyHeinze[energysaverarrayheinze]\nenergysaverarrayheinze - \
an array of energies calculated using the Heinze procedure\nRETURN - a string\
\n\nprintEnergyHeinze prints the energy expectation value and error using the \
Heinze procedure\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printEnergyHeinze", "[", "energysaverarrayheinze_", "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Heinze (unweighted) estimator of the energy per particle            \
: \>\"", ",", 
     RowBox[{"Mean", "@", 
      RowBox[{"energysaverarrayheinze", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "\"\<+/-\>\"", ",", 
     FractionBox[
      RowBox[{"StandardDeviation", "@", 
       RowBox[{"energysaverarrayheinze", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Length", "@", 
        RowBox[{"energysaverarrayheinze", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"autocorrelationPlot", "::", "usage"}], "=", 
   "\"\<autocorrelationPlot[energyVirial,energyFullVirial,energyTherm,\
energyHeinze,energysaverarrayvirial,energysaverarrayfullvirial,\
energysaverarraytherm,energysaverarrayheinze,observablecalc]\nenergyVirial - \
whether to calculate the energy in the virial approximation\nenergyFullVirial \
- whether to calculate the energy in the full virial approximation\n\
energyTherm - whether to calculate the energy in the thermodynamic \
approximation\nenergyHeinze - whether to calculate the energy using the \
Heinze procedure\nenergysaverarrayvirial - an array of energies calculated in \
the virial approximation\nenergysaverarrayfullvirial - an array of energies \
calculated in the full virial approximation\nenergysaverarraytherm - an array \
of energies calculated in the thermodynamic approximation\n\
energysaverarrayheinze - an array of energies calculated using the Heinze \
procedure\nobservablecalc - how many time steps between calculating \
expectation values\nRETURN - a plot of the autocorrelation in different \
energy estimators\n\nautocorrelationPlot creates a plot of the \
autocorrelation in the different estimators of the energy as a function of \
step number\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"autocorrelationPlot", "[", 
    RowBox[{
    "energyVirial_", ",", "energyFullVirial_", ",", "energyTherm_", ",", 
     "energyHeinze_", ",", "energysaverarrayvirial_", ",", 
     "energysaverarrayfullvirial_", ",", "energysaverarraytherm_", ",", 
     "energysaverarrayheinze_", ",", "observablecalc_"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"energyVirial", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarrayvirial", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarrayvirial"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"energyFullVirial", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarrayfullvirial", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarrayfullvirial"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"energyTherm", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarraytherm", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarraytherm"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"energyHeinze", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "observablecalc"}], ",", 
             RowBox[{"CorrelationFunction", "[", 
              RowBox[{
               RowBox[{"energysaverarrayheinze", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"10", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "energysaverarrayheinze"}], "-", 
                  "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "}"}],
      ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Darker", "@", "Red"}], ",", "Blue", ",", 
        RowBox[{"Darker", "@", "Green"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"energyVirial", ",", "\"\<Virial\>\"", ",", "\"\<\>\""}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
         "energyFullVirial", ",", "\"\<Ceperley Virial\>\"", ",", 
          "\"\<\>\""}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
         "energyTherm", ",", "\"\<Thermodynamic\>\"", ",", "\"\<\>\""}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyHeinze", ",", "\"\<Heinze\>\"", ",", "\"\<\>\""}], 
         "]"}]}], "}"}]}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", "\"\<Autocorrelation in the energy\>\""}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Step number\>\"", ",", "\"\<Correlation\>\""}], "}"}]}], 
     ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapEnergies", "::", "usage"}], "=", 
   "\"\<exactHarmonicTrapEnergies[maxval,\[Tau],slices,\[Omega],\
dimensionality]\nmaxval - the maximum principal quantum number to use\n\[Tau] \
- the time step, also a measure of inverse temperature\nslices - number of \
slices/beads per particle\n\[Omega] - harmonic trap frequency\ndimensionality \
- the dimension of the system\nRETURN - a real number that gives the energy \
of a particle in an harmonic trap\n\nexactHarmonicTrapEnergies gives a \
numerically exact (as maxval->\[Infinity]) expression for the energy of a \
single particle in an harmonic trap, for comparison with calculated results\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapEnergies", "[", 
    RowBox[{
    "maxval_", ",", "\[Tau]_", ",", "slices_", ",", "\[Omega]_", ",", 
     "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tableofenergies", ",", "tableofoccupations", ",", "\[Psi]", ",", 
       "tableofwfns"}], "}"}], ",", 
     RowBox[{
      RowBox[{"tableofenergies", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", 
             FractionBox["dimensionality", "2"]}], ")"}], "\[Omega]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"dimensionality", "+", "n", "-", "1"}], ",", "n"}], 
             "]"}]}], "}"}]}], "]"}]}]}], ";", 
      RowBox[{"tableofoccupations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[Tau]"}], " ", "slices", " ", "#"}], "]"}], "&"}], "/@",
         "tableofenergies"}]}], ";", 
      FractionBox[
       RowBox[{"Total", "@", 
        RowBox[{"(", 
         RowBox[{"tableofoccupations", "*", "tableofenergies"}], ")"}]}], 
       RowBox[{"Total", "@", "tableofoccupations"}]]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exactHarmonicTrapWfns", "::", "usage"}], "=", 
   "\"\<exactHarmonicTrapWfns[maxval,\[Tau],slices,\[Omega],dimensionality]\n\
maxval - the maximum principal quantum number to use\n\[Tau] - the time step, \
also a measure of inverse temperature\nslices - number of slices/beads per \
particle\n\[Omega] - harmonic trap frequency\ndimensionality - the dimension \
of the system\nRETURN - a 1D function corresponding to the x-position of a \
particle in an harmonic trap\n\nexactHarmonicTrapWfns gives a numerically \
exact (as maxval->\[Infinity]) expression for the x-position of a single \
particle in an harmonic trap, for comparison with calculated results\>\""}], 
  ";", 
  RowBox[{
   RowBox[{"exactHarmonicTrapWfns", "[", 
    RowBox[{
    "maxval_", ",", "\[Tau]_", ",", "slices_", ",", "\[Omega]_", ",", 
     "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tableofenergies", ",", "tableofoccupations", ",", "\[Psi]", ",", 
       "tableofwfns"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"tableofenergies", "=", 
          RowBox[{"Join", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", 
                FractionBox["dimensionality", "2"]}], ")"}], "\[Omega]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"dimensionality", "+", "n", "-", "1"}], ",", "n"}], 
                "]"}]}], "}"}]}], "]"}]}]}], ";", 
         RowBox[{"tableofoccupations", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Tau]"}], " ", "slices", " ", "#"}], "]"}], 
            "&"}], "/@", "tableofenergies"}]}], ";", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{
           "n_", ",", "l_", ",", "m_", ",", "r_", ",", "\[Theta]_", ",", 
            "\[Phi]_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            FractionBox[
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{"n", "+", "l", "+", "2"}]], 
              SuperscriptBox["\[Omega]", 
               RowBox[{"l", "+", 
                RowBox[{"3", "/", "2"}]}]]}], 
             SuperscriptBox["\[Pi]", 
              RowBox[{"1", "/", "2"}]]], "]"}], 
           RowBox[{"Sqrt", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"Factorial", "[", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"n", "-", "l"}], ")"}]}], "]"}], 
              RowBox[{"Factorial", "[", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"n", "+", "l"}], ")"}]}], "]"}]}], 
             RowBox[{"Factorial", "[", 
              RowBox[{"n", "+", "l", "+", "1"}], "]"}]], "]"}], 
           SuperscriptBox["r", "l"], 
           RowBox[{"Exp", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "1"}], "2"], "\[Omega]", " ", 
             SuperscriptBox["r", "2"]}], "]"}], 
           RowBox[{"LaguerreL", "[", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], 
              RowBox[{"(", 
               RowBox[{"n", "-", "l"}], ")"}]}], ",", 
             RowBox[{"l", "+", 
              FractionBox["1", "2"]}], ",", 
             RowBox[{"\[Omega]", " ", 
              SuperscriptBox["r", "2"]}]}], "]"}], 
           RowBox[{"SphericalHarmonicY", "[", 
            RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], 
            "]"}]}]}], ";", 
         RowBox[{
          RowBox[{"tableofwfns", "[", "x_", "]"}], "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"Total", "[", "tableofoccupations", "]"}]], 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   RowBox[{"\[Psi]", "[", 
                    RowBox[{"n", ",", "l", ",", "m", ",", "x", ",", 
                    FractionBox["\[Pi]", "2"], ",", "0"}], "]"}], "]"}], "2"],
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "n", ",", "0", ",", 
                   RowBox[{"-", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}]}], ")"}], 
             "*", "tableofoccupations"}], "]"}]}]}], ";"}], ",", 
        RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
        RowBox[{
         RowBox[{"tableofenergies", "=", 
          RowBox[{"Join", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", 
                FractionBox["dimensionality", "2"]}], ")"}], "\[Omega]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n", ",", "0", ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}]}]}], ";", 
         RowBox[{"tableofoccupations", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Tau]"}], " ", "slices", " ", "#"}], "]"}], 
            "&"}], "/@", "tableofenergies"}]}], ";", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"n_", ",", "m_", ",", "r_", ",", "\[Theta]_"}], "]"}], ":=", 
          RowBox[{
           FractionBox[
            RowBox[{"Sqrt", "[", 
             SuperscriptBox["\[Omega]", 
              RowBox[{"m", "+", "1"}]], "]"}], 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"n", "-", "m"}], "2"], ")"}], "!"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"n", "+", "m"}], "2"], ")"}], "!"}], ")"}], 
              "\[Pi]"}], "]"}]], 
           SuperscriptBox["r", "m"], 
           RowBox[{"HypergeometricU", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"m", "-", "n"}], "2"], ",", 
             RowBox[{"1", "+", "m"}], ",", 
             SuperscriptBox["r", "2"]}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "1"}], "2"], "\[Omega]", " ", 
             SuperscriptBox["r", "2"]}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Theta]"}], "]"}]}]}], 
         ";", 
         RowBox[{
          RowBox[{"tableofwfns", "[", "x_", "]"}], "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"Total", "[", "tableofoccupations", "]"}]], 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   RowBox[{"\[Psi]", "[", 
                    RowBox[{"n", ",", "m", ",", "x", ",", "0"}], "]"}], "]"}],
                   "2"], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "0", ",", "maxval"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n", ",", "0", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ")"}], "*", 
             "tableofoccupations"}], "]"}]}]}], ";"}]}], "]"}], ";", 
      FractionBox[
       RowBox[{"tableofwfns", "[", "x", "]"}], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"tableofwfns", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", "10"}], "/", 
            RowBox[{"Sqrt", "[", "\[Omega]", "]"}]}], ",", 
           RowBox[{"10", "/", 
            RowBox[{"Sqrt", "[", "\[Omega]", "]"}]}]}], "}"}]}], "]"}]]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyArrayMaker", "::", "usage"}], "=", 
   "\"\<energyArrayMaker[energyassoc,energysquaredassoc]\nenergyassoc - an \
association of energies\nenergysquaredassoc - an association of squared \
energies\nRETURN - an array of two arrays, the energy and inverse variance of \
the energy\n\nenergyArrayMaker takes associations of energies and squared \
energies, and returns arrays of the energy and the inverse variance, for \
weighting purposes\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyArrayMaker", "[", 
    RowBox[{
     RowBox[{"energyassoc_", "?", "AssociationQ"}], ",", 
     RowBox[{"energysquaredassoc_", "?", "AssociationQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "energysavearray", ",", "energysquaredsavearray", ",", 
       "inversevariancearray"}], "}"}], ",", 
     RowBox[{
      RowBox[{"energysavearray", "=", 
       RowBox[{"Values", "@", "energyassoc"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"energyassoc", "[", 
          RowBox[{"[", 
           RowBox[{"Key", "[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "energyassoc", "]"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energysquaredsavearray", "=", 
       RowBox[{"Values", "@", "energysquaredassoc"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"energysquaredassoc", "[", 
          RowBox[{"[", 
           RowBox[{"Key", "[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "energysquaredassoc", "]"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inversevariancearray", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            FractionBox["1", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
              SuperscriptBox[
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"]}]]}], "}"}], 
          ")"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"energysavearray", ",", "energysquaredsavearray"}], "}"}], 
         "]"}]}]}], ";", 
      RowBox[{"{", 
       RowBox[{"energysavearray", ",", "inversevariancearray"}], "}"}]}]}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "energyAssocMaker", " ", "makes", " ", "associations", " ", "of", " ", 
    "the", " ", "energy", " ", "with", " ", "the", " ", "simulation", " ", 
    RowBox[{"step", ".", "  ", "Pass"}], " ", "in", " ", "the", " ", "type", 
    " ", "of", " ", "energy", " ", "estimator", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"currently", " ", 
       RowBox[{"supported", ":", " ", "\"\<therm\>\""}]}], ",", " ", 
      "\"\<virial\>\"", ",", " ", "\"\<heinze\>\""}], ")"}], " ", "and", " ", 
    "it", " ", "will", " ", "return", " ", "a", " ", "pair", " ", "of", " ", 
    "association", " ", "elements", " ", "for", " ", "the", " ", "energy", 
    " ", "and", " ", "energy", " ", "squared"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMaker", "::", "usage"}], "=", 
   "\"\<energyAssocMaker[step,numsteps,\[Lambda],\[Tau],numparticles,\
numslices,path,dimensionality,type]\nstep - the time step number\nnumsteps - \
the total number of time steps used\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - the number of particles in the system\nnumslices - the number \
of slices/beads per particle\npath - list of all particle and bead positions \
at a given time step\ndimensionality - the dimension of the system\ntype - \
type of energy estimator desired\nRETURN - pairs of {{relative step,energy \
estimator},{relative step,squared energy estimator}} arrays\n\n\
energyAssocMaker calculates the energy and squared energy in the \
approximation given by 'type'.  Currently supported versions are 'virial', \
'therm', 'heinze'. DEPRECATED\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMaker", "[", 
    RowBox[{
    "step_", ",", "numsteps_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", 
     "numparticles_", ",", "numslices_", ",", "path_", ",", "dimensionality_",
      ",", 
     RowBox[{"type_:", "\"\<virial\>\""}]}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"type", "\[Equal]", "\"\<therm\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergySquaredEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<virial\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergySquaredEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<heinze\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"heinzeTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"heinzeTotalEnergyEstimator", "[", 
            RowBox[{
            "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",",
              "numslices", ",", "dimensionality"}], "]"}], "2"], "+", 
          RowBox[{"numparticles", "*", "numslices"}]}]}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMakerStatistics", "::", "usage"}], "=", 
   "\"\<energyAssocMakerStatistics[step,numsteps,\[Lambda],\[Tau],\
numparticles,numslices,path,joined,dimensionality,type]\nstep - the time step \
number\nnumsteps - the total number of time steps used\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
numparticles - the number of particles in the system\nnumslices - the number \
of slices/beads per particle\npath - list of all particle and bead positions \
at a given time step\njoined - an association of each particle, showing which \
particle is joined before it\ndimensionality - the dimension of the system\n\
type - type of energy estimator desired\nRETURN - pairs of {{relative \
step,energy estimator},{relative step,squared energy estimator}} arrays\n\n\
energyAssocMakerStatistics calculates the energy and squared energy in the \
approximation given by 'type'.  Currently supported versions are 'virial', \
'fullvirial', 'therm', 'heinze'\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyAssocMakerStatistics", "[", 
    RowBox[{
    "step_", ",", "numsteps_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", 
     "numparticles_", ",", "numslices_", ",", "path_", ",", "joined_", ",", 
     "dimensionality_", ",", 
     RowBox[{"type_:", "\"\<virial\>\""}]}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"type", "\[Equal]", "\"\<therm\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergyEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"thermTotalEnergySquaredEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<virial\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergyEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"virialTotalEnergySquaredEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<fullvirial\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"fullVirialTotalEnergyEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"fullVirialTotalEnergySquaredEstimatorStatistics", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "joined", ",", "dimensionality"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"type", "\[Equal]", "\"\<heinze\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{"heinzeTotalEnergyEstimator", "[", 
          RowBox[{
          "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",", 
           "numslices", ",", "dimensionality"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["step", "numsteps"], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"heinzeTotalEnergyEstimator", "[", 
            RowBox[{
            "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "numparticles", ",",
              "numslices", ",", "dimensionality"}], "]"}], "2"], "+", 
          RowBox[{"numparticles", "*", "numslices"}]}]}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyMaker", "::", "usage"}], "=", 
   "\"\<energyMaker[calculateEnergy,energyTherm,energyVirial,energyFullVirial,\
energyHeinze,harmonictrap,energysaveassoctherm,energysquaredsaveassoctherm,\
energysaveassocvirial,energysquaredsaveassocvirial,energysaveassocfullvirial,\
energysquaredsaveassocfullvirial,energysaveassocheinze,\
energysquaredsaveassocheinze,\[Tau],slices,\[Omega]]\ncalculateEnergy - \
whether to calculate the energy expectation value\nenergyTherm - whether to \
calculate the energy in the thermodynamic approximation\nenergyVirial - \
whether to calculate the energy in the virial approximation\nenergyFullVirial \
- whether to calculate the energy in the full virial approximation\n\
energyHeinze - whether to calculate the energy using the Heinze procedure\n\
harmonictrap - whether to calculate properties in a corresponding harmonic \
trap\nenergysaveassoctherm - association of energies calculated in the \
thermodynamic approximation\nenergysquaredsaveassoctherm - association of \
squared energies calculated in the thermodynamic approximation\n\
energysaveassocvirial - association of energies calculated in the virial \
approximation\nenergysquaredsaveassocvirial - association of squared energies \
calculated in the virial approximation\nenergysaveassocfullvirial - \
association of energies calculated in the full virial approximation\n\
energysquaredsaveassocfullvirial - association of squared energies calculated \
in the full virial approximation\nenergysaveassocheinze - association of \
energies calculated using the Heinze procedure\nenergysquaredsaveassocheinze \
- association of squared energies calculated using the Heinze procedure\n\
\[Tau] - the time step, also a measure of inverse temperature\nslices - the \
number of slices/beads per particle\n\[Omega] - harmonic trap frequency\n\
RETURN - arrays of energies and errors in different approximations\n\n\
energyMaker takes the associations of energies created at each time step, and \
converts them into arrays\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyMaker", "[", 
    RowBox[{
    "calculateEnergy_", ",", "energyTherm_", ",", "energyVirial_", ",", 
     "energyFullVirial_", ",", "energyHeinze_", ",", "harmonictrap_", ",", 
     "energysaveassoctherm_", ",", "energysquaredsaveassoctherm_", ",", 
     "energysaveassocvirial_", ",", "energysquaredsaveassocvirial_", ",", 
     "energysaveassocfullvirial_", ",", "energysquaredsaveassocfullvirial_", 
     ",", "energysaveassocheinze_", ",", "energysquaredsaveassocheinze_", ",",
      "\[Tau]_", ",", "slices_", ",", "\[Omega]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "energysaverarraytherm", ",", "invvartherm", ",", 
       "energysaverarrayvirial", ",", "invvarvirial", ",", 
       "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
       "energysaverarrayheinze", ",", "invvarheinze"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"calculateEnergy", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"energyTherm", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "}"}], 
            "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassoctherm", ",", "energysquaredsaveassoctherm"}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"energyVirial", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "}"}], 
            "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassocvirial", ",", "energysquaredsaveassocvirial"}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"energyFullVirial", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}], 
             "}"}], "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassocfullvirial", ",", 
              "energysquaredsaveassocfullvirial"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"energyHeinze", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"energysaverarrayheinze", ",", "invvarheinze"}], "}"}], 
            "=", 
            RowBox[{"energyArrayMaker", "[", 
             RowBox[{
             "energysaveassocheinze", ",", "energysquaredsaveassocheinze"}], 
             "]"}]}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}], "}"}
         ], ",", 
        RowBox[{"{", 
         RowBox[{"energysaverarrayheinze", ",", "invvarheinze"}], "}"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPrint", "::", "usage"}], "=", 
   "\"\<energyPrinter[calculateEnergy,energyTherm,energyVirial,\
energyFullVirial,energyHeinze,harmonictrap,energysaverarraytherm,invvartherm,\
energysaverarrayvirial,invvarvirial,energysaverarrayfullvirial,\
invvarfullvirial,energysaverarrayheinze,invvarheinze,\[Tau],slices,\[Omega],\
dimensionality]\ncalculateEnergy - whether to calculate the energy \
expectation value\nenergyTherm - whether to calculate the energy in the \
thermodynamic approximation\nenergyVirial - whether to calculate the energy \
in the virial approximation\nenergyFullVirial - whether to calculate the \
energy in the full virial approximation\nenergyHeinze - whether to calculate \
the energy using the Heinze procedure\nharmonictrap - whether to calculate \
properties in a corresponding harmonic trap\nenergysaverarraytherm - an array \
of energies calculated in the thermodynamic approximation\ninvvartherm - an \
array of inverse variances of the energy calculated in the thermodynamic \
approximation\nenergysaverarrayvirial - an array of energies calculated in \
the virial approximation\ninvvarvirial - an array of inverse variances of the \
energy calculated in the virial approximation\nenergysaverarrayfullvirial - \
an array of energies calculated in the full virial approximation\n\
invvarfullvirial - an array of inverse variances of the energy calculated in \
the full virial approximation\nenergysaverarrayheinze - an array of energies \
calculated using the Heinze procedure\ninvvarheinze - an array of inverse \
variances of the energy calculated using the Heinze procedure\n\[Tau] - the \
time step, also a measure of inverse temperature\nslices - the number of \
slices/beads per particle\n\[Omega] - harmonic trap frequency\ndimensionality \
- the dimension of the system\nRETURN - Null, prints strings\n\nenergyPrinter \
takes arrays of energies and inverse variances and passes them to routines \
which print the energy estimators and errors on them\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energyPrinter", "[", 
    RowBox[{
    "calculateEnergy_", ",", "energyTherm_", ",", "energyVirial_", ",", 
     "energyFullVirial_", ",", "energyHeinze_", ",", "harmonictrap_", ",", 
     "energysaverarraytherm_", ",", "invvartherm_", ",", 
     "energysaverarrayvirial_", ",", "invvarvirial_", ",", 
     "energysaverarrayfullvirial_", ",", "invvarfullvirial_", ",", 
     "energysaverarrayheinze_", ",", "invvarheinze_", ",", "\[Tau]_", ",", 
     "slices_", ",", "\[Omega]_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"calculateEnergy", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"energyVirial", ",", 
        RowBox[{"printEnergyVirial", "[", 
         RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyFullVirial", ",", 
        RowBox[{"printEnergyFullVirial", "[", 
         RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyTherm", ",", 
        RowBox[{"printEnergyTherm", "[", 
         RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyHeinze", ",", 
        RowBox[{"printEnergyHeinze", "[", "energysaverarrayheinze", "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"harmonictrap", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<cf numerically exact total energy per non-interacting particle  \
    : \>\"", ",", 
          RowBox[{"exactHarmonicTrapEnergies", "[", 
           RowBox[{
           "15", ",", "\[Tau]", ",", "slices", ",", "\[Omega]", ",", 
            "dimensionality"}], "]"}]}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expectationValueMaker", "::", "usage"}], "=", 
   "\"\<expectationValueMaker[calculateParticleDensityX,\
calculatePairCorrelationFunction,numparticles,particleDensityX,\
vectorPairCorrelationFunction]\ncalculateParticleDensityX - whether to \
calculate the single-particle density\ncalculatePairCorrelationFunction - \
whether to calculate the pair/density-density correlation function\n\
numparticles - the number of particles in the system\nparticleDensityX - an \
association of single-particle positions\nvectorPairCorrelationFunction - an \
association of pairs of particle positions\nRETURN - an array of pairs of \
{density,density-density} arrays\n\nexpectationValueMaker takes the \
associations of expectation values (not the energy) calculated at each time \
step, and turns them into arrays.  Currently supports density and \
density-density correlation functions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expectationValueMaker", "[", 
    RowBox[{
    "calculateParticleDensityX_", ",", "calculatePairCorrelationFunction_", 
     ",", "numparticles_", ",", "particleDensityX_", ",", 
     "vectorPairCorrelationFunction_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "particleDensityXsaverarray", ",", "pairCorrelationFunctionsaverarray", 
       ",", "vectorPairCorrelationFunctionsaverarray"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"particleDensityXsaverarray", "=", 
         RowBox[{"Values", "@", "particleDensityX"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"vectorPairCorrelationFunctionsaverarray", "=", 
         RowBox[{"Values", "@", "vectorPairCorrelationFunction"}]}]}], "]"}], 
      ";", 
      RowBox[{"{", 
       RowBox[{
       "particleDensityXsaverarray", ",", 
        "vectorPairCorrelationFunctionsaverarray"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotMaker", "::", "usage"}], "=", 
   "\"\<plotMaker[showPaths,calculateEnergy,calculateParticleDensityX,\
calculatePairCorrelationFunction,allow3DCorrelationPlots,showAutocorrelation,\
numparticles,path,joined,energyVirial,energyFullVirial,energyTherm,\
energyHeinze,energysaverarrayvirial,energysaverarrayfullvirial,\
energysaverarraytherm,energysaverarrayheinze,invvarvirial,invvarfullvirial,\
invvartherm,invvarheinze,equilibrationsteps,numsteps,harmonictrap,\[Omega],\
\[Tau],slices,particleDensityXsaverarray,\
vectorPairCorrelationFunctionsaverarray,binsize,observablecalc,plotPoints_\
dimensionality]\nshowPaths - whether to plot a graph of a realisation of \
particle/bead positions\ncalculateEnergy - whether to calculate the energy \
expectation value\ncalculateParticleDensityX - whether to calculate the \
single-particle density\ncalculatePairCorrelationFunction - whether to \
calculate the pair/density-density correlation function\n\
allow3DCorrelationPlots - whether to make 3D plots of the density and pair \
correlation function; slower to run if allowed\nshowAutocorrelation - whether \
to show the autocorrelation in the energy\nnumparticles - the number of \
particles in the system\npath - list of all particle and bead positions at a \
given time step\njoined - an association of each particle, showing which \
particle is joined before it\nenergyVirial - whether to calculate the energy \
in the virial approximation\nenergyFullVirial - whether to calculate the \
energy in the full virial approximation\nenergyTherm - whether to calculate \
the energy in the thermodynamic approximation\nenergyHeinze - whether to \
calculate the energy using the Heinze procedure\nenergysaverarrayvirial - an \
array of energies calculated in the virial approximation\n\
energysaverarrayfullvirial - an array of energies calculated in the full \
virial approximation\nenergysaverarraytherm - an array of energies calculated \
in the thermodynamic approximation\nenergysaverarrayheinze - an array of \
energies calculated using the Heinze procedure\ninvvarvirial - an array of \
inverse variances of the energy calculated in the virial approximation\n\
invvarfullvirial - an array of inverse variances of the energy calculated in \
the full virial approximation\ninvvartherm - an array of inverse variances of \
the energy calculated in the thermodynamic approximation\ninvvarheinze - an \
array of inverse variances of the energy calculated using the Heinze \
procedure\nequilibrationsteps - the number of equilibration steps taken \
before calculating estimators\nnumsteps - the total number of time steps used\
\nharmonictrap - whether to calculate properties in a corresponding harmonic \
trap\n\[Omega] - harmonic trap frequency\n\[Tau] - the time step, also a \
measure of inverse temperature\nslices - the number of slices/beads per \
particle\nparticleDensityXsaverarray - an array of particle positions\n\
vectorPairCorrelationFunctionsaverarray - an array of pairs of particle \
positions\nbinsize - an array of sizes of different smoothings to use for the \
particle density and pair correlation functions\nobservablecalc - how many \
steps between calculating quantities\nplotPoints - the number of samples to \
take in 3D plots; slower to run for large numbers\ndimensionality - the \
dimension of the system\nRETURN - an array of plots\n\nplotMaker makes plots \
of the path, energy, particle density, pair correlation function, and \
autocorrelation, as requested\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotMaker", "[", 
    RowBox[{
    "showPaths_", ",", "calculateEnergy_", ",", "calculateParticleDensityX_", 
     ",", "calculatePairCorrelationFunction_", ",", 
     "allow3DCorrelationPlots_", ",", "showAutocorrelation_", ",", 
     "numparticles_", ",", "path_", ",", "joined_", ",", "energyVirial_", ",",
      "energyFullVirial_", ",", "energyTherm_", ",", "energyHeinze_", ",", 
     "energysaverarrayvirial_", ",", "energysaverarrayfullvirial_", ",", 
     "energysaverarraytherm_", ",", "energysaverarrayheinze_", ",", 
     "invvarvirial_", ",", "invvarfullvirial_", ",", "invvartherm_", ",", 
     "invvarheinze_", ",", "equilibrationsteps_", ",", "numsteps_", ",", 
     "harmonictrap_", ",", "\[Omega]_", ",", "\[Tau]_", ",", "slices_", ",", 
     "particleDensityXsaverarray_", ",", 
     "vectorPairCorrelationFunctionsaverarray_", ",", "binsize_", ",", 
     "observablecalc_", ",", "plotPoints_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pathplot", ",", "potentialplot", ",", "energyplot", ",", 
       "particleDensityXplot", ",", "particleDensityXplot3D", ",", 
       "pairCorrelationFunctionplot", ",", 
       "pairUnweightedCorrelationFunctionplot", ",", "autocorrelationplot", 
       ",", "plots", ",", "xyAveragedPairCorrelationFunctionplot", ",", 
       "xPairCorrelationFunctionplot", ",", "plotRange", ",", 
       "shorterPlotRange", ",", "densityPlotRange", ",", "partdensfunc", ",", 
       "partdenstexture"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "PrintTemporary", "[", "\"\<Currently drawing plots ...\>\"", "]"}], 
      ";", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{
         RowBox[{"pathplot", "=", 
          RowBox[{"pathPlot", "[", 
           RowBox[{"path", ",", "joined", ",", "dimensionality"}], "]"}]}], 
         ";", 
         RowBox[{"potentialplot", "=", 
          RowBox[{"potentialPlot", "[", 
           RowBox[{"path", ",", "dimensionality"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "calculateParticleDensityX", "&&", "allow3DCorrelationPlots"}], ",", 
        RowBox[{"densityPlotRange", "=", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"(", "#", ")"}], "]"}], "&"}], "/@", 
            RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"Round", "[", 
            RowBox[{"0.95", 
             RowBox[{"Length", "[", 
              RowBox[{"Join", "@@", "particleDensityXsaverarray"}], "]"}]}], 
            "]"}], "]"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"plotRange", "=", 
         RowBox[{"Last", "@", 
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
            RowBox[{
            "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"shorterPlotRange", "=", 
         RowBox[{"(*", "plotRange", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
            RowBox[{
            "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Round", "[", 
            RowBox[{"0.95", 
             RowBox[{"Length", "[", 
              RowBox[{
              "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}], 
              "]"}]}], "]"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"calculateEnergy", ",", 
        RowBox[{"energyplot", "=", 
         RowBox[{"energyPlot", "[", 
          RowBox[{
          "energyVirial", ",", "energyFullVirial", ",", "energyTherm", ",", 
           "energyHeinze", ",", "energysaverarrayvirial", ",", 
           "energysaverarrayfullvirial", ",", "energysaverarraytherm", ",", 
           "energysaverarrayheinze", ",", "invvarvirial", ",", 
           "invvarfullvirial", ",", "invvartherm", ",", "invvarheinze", ",", 
           "equilibrationsteps", ",", "numsteps", ",", "harmonictrap", ",", 
           "\[Omega]", ",", "\[Tau]", ",", "slices", ",", "dimensionality"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"particleDensityXplot", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"PDF", "[", 
                RowBox[{
                 RowBox[{"SmoothKernelDistribution", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                   ",", "#", ",", "\"\<Cosine\>\""}], "]"}], ",", "x"}], 
                "]"}], "&"}], "/@", "binsize"}], ")"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"First", "@", 
              RowBox[{"Sort", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                ")"}]}]}], ",", 
             RowBox[{"Last", "@", 
              RowBox[{"Sort", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                ")"}]}]}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Orange", ",", 
                 RowBox[{"Length", "@", "binsize"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Opacity", "[", 
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["2", "#"]], "+", 
                   FractionBox["1", "2"]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "binsize"}]}]}]}], "}"}], "]"}]}], 
           ",", 
           RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                FractionBox["1", 
                 SuperscriptBox["2", "#"]], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "binsize"}]}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x position\>\"", ",", "\"\<probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", "\"\<Particle Density Probability\>\""}], 
           ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "All"}], "}"}]}]}], "]"}]}]}], "]"}], 
      ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "calculateParticleDensityX", "&&", "allow3DCorrelationPlots"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
          RowBox[{"particleDensityXplot3D", "=", 
           RowBox[{"Plot3D", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{"(", 
               RowBox[{"PDF", "[", 
                RowBox[{
                 RowBox[{"SmoothKernelDistribution", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], 
                   ",", 
                   RowBox[{"binsize", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ")"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
              "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
             RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
             RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<probability\>\""}], 
               "}"}]}], ",", 
             RowBox[{
             "PlotLabel", "\[Rule]", 
              "\"\<2D Particle Density Probability\>\""}]}], "]"}]}], ",", 
          RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"partdensfunc", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "=", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"SmoothKernelDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "@@", "particleDensityXsaverarray"}]}], ",", 
                RowBox[{"binsize", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"partdenstexture", "=", 
            RowBox[{"DensityPlot", "[", 
             RowBox[{
              RowBox[{"extV", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "densityPlotRange"}], ",", "densityPlotRange"}], 
               "}"}], ",", 
              RowBox[{"Frame", "\[Rule]", "None"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
              RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"particleDensityXplot3D", "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"Plot3D", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"partdensfunc", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "<", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "3"}]]}], ",", "Null", ",", 
                  RowBox[{"partdensfunc", "[", 
                   RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "densityPlotRange"}], ",", 
                  "densityPlotRange"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"-", "densityPlotRange"}], ",", 
                  "densityPlotRange"}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
                RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
                RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
                RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<probability\>\""}],
                   "}"}]}], ",", 
                RowBox[{
                "PlotLabel", "\[Rule]", 
                 "\"\<2D Particle Density Probability\>\""}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Texture", "[", "partdenstexture", "]"}], ",", 
                  RowBox[{"Polygon", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "densityPlotRange"}], ",", 
                    RowBox[{"-", "densityPlotRange"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"densityPlotRange", ",", 
                    RowBox[{"-", "densityPlotRange"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "densityPlotRange", ",", "densityPlotRange", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "densityPlotRange"}], ",", 
                    "densityPlotRange", ",", "0"}], "}"}]}], "}"}], ",", 
                    RowBox[{"VertexTextureCoordinates", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], "]"}]}],
              "]"}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"pairCorrelationFunctionplot", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"PDF", "[", 
                RowBox[{
                 RowBox[{"SmoothKernelDistribution", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    "Join", "@@", 
                    "vectorPairCorrelationFunctionsaverarray"}]}], ",", "#", 
                   ",", "\"\<Cosine\>\""}], "]"}], ",", "x"}], "]"}], "&"}], "/@",
               "binsize"}], ")"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "plotRange"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Orange", ",", 
                 RowBox[{"Length", "@", "binsize"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Opacity", "[", 
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["2", "#"]], "+", 
                   FractionBox["1", "2"]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "binsize"}]}]}]}], "}"}], "]"}]}], 
           ",", 
           RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                FractionBox["1", 
                 SuperscriptBox["2", "#"]], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "binsize"}]}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<|r|\>\"", ",", "\"\<probability\>\""}], "}"}]}], 
           ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<Averaged Density-Density Correlation Function\>\""}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"pairUnweightedCorrelationFunctionplot", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
               FractionBox["1", 
                SuperscriptBox["x", "2"]], ",", 
               RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
               FractionBox["1", "x"]}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PDF", "[", 
                 RowBox[{
                  RowBox[{"SmoothKernelDistribution", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    "Join", "@@", 
                    "vectorPairCorrelationFunctionsaverarray"}]}], ",", "#", 
                    ",", "\"\<Cosine\>\""}], "]"}], ",", "x"}], "]"}], "&"}], 
               "/@", "binsize"}], ")"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "plotRange"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Orange", ",", 
                 RowBox[{"Length", "@", "binsize"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Opacity", "[", 
                  RowBox[{
                   FractionBox["1", 
                    SuperscriptBox["2", "#"]], "+", 
                   FractionBox["1", "2"]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "binsize"}]}]}]}], "}"}], "]"}]}], 
           ",", 
           RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                FractionBox["1", 
                 SuperscriptBox["2", "#"]], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "binsize"}]}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<|r|\>\"", ",", "\"\<probability\>\""}], "}"}]}], 
           ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", "\"\<Pair Correlation Function\>\""}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"xyAveragedPairCorrelationFunctionplot", "=", 
         RowBox[{"Plot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"SmoothKernelDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}], "/@", 
                 RowBox[{
                 "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
                ",", 
                RowBox[{"binsize", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<probability\>\""}], 
             "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<2D Density-Density Correlation Function\>\""}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"xPairCorrelationFunctionplot", "=", 
         RowBox[{"Plot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "@", 
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"SmoothKernelDistribution", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], "&"}],
                  "/@", 
                 RowBox[{
                 "Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
                ",", 
                RowBox[{"binsize", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Cosine\>\""}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "shorterPlotRange"}], ",", "shorterPlotRange"}], 
            "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "plotPoints"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\)\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[\(x\), \(2\)]\)\>\"", ",", 
              "\"\<probability\>\""}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<x-direction Density-Density Correlation Function\>\""}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showAutocorrelation", ",", 
        RowBox[{"autocorrelationplot", "=", 
         RowBox[{"autocorrelationPlot", "[", 
          RowBox[{
          "energyVirial", ",", "energyFullVirial", ",", "energyTherm", ",", 
           "energyHeinze", ",", "energysaverarrayvirial", ",", 
           "energysaverarrayfullvirial", ",", "energysaverarraytherm", ",", 
           "energysaverarrayheinze", ",", "observablecalc"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", 
           RowBox[{"potentialplot", ",", "pathplot"}], "]"}]}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"calculateEnergy", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "energyplot", "]"}]}], "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"If", "[", 
           RowBox[{"harmonictrap", ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{"particleDensityXplot", ",", 
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "@", 
                  RowBox[{"exactHarmonicTrapWfns", "[", 
                   RowBox[{
                   "5", ",", "\[Tau]", ",", "slices", ",", "\[Omega]", ",", 
                    "dimensionality"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"Show", "[", "particleDensityXplot", "]"}]}], "]"}]}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "calculateParticleDensityX", "&&", "allow3DCorrelationPlots"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "particleDensityXplot3D", "]"}]}], "]"}]}], 
       "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "pairCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{
          "Show", "[", "pairUnweightedCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{
          "Show", "[", "xyAveragedPairCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}], "&&", 
         "allow3DCorrelationPlots"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "xPairCorrelationFunctionplot", "]"}]}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"showAutocorrelation", ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", 
          RowBox[{"Show", "[", "autocorrelationplot", "]"}]}], "]"}]}], "]"}],
       ";", "plots"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arrayExtractor", "::", "usage"}], "=", 
   "\"\<arrayExtractor[energyTherm,energyVirial,energyFullVirial,energyHeinze,\
calculateParticleDensityX,calculatePairCorrelationFunction,numparticles,\
arrays]\nenergyTherm - whether to calculate the energy in the thermodynamic \
approximation\nenergyVirial - whether to calculate the energy in the virial \
approximation\nenergyFullVirial - whether to calculate the energy in the full \
virial approximation\nenergyHeinze - whether to calculate the energy using \
the Heinze procedure\ncalculateParticleDensityX - whether to calculate the \
single-particle density\ncalculatePairCorrelationFunction - whether to \
calculate the pair/density-density correlation function\nnumparticles - the \
number of particles in the system\narrays - an array of arrays of different \
expectation values\nRETURN - an array of expectation values and errors, as \
{energy(therm),error(therm),energy(virial),error(virial),energy(fullvirial),\
error(fullvirial),energy(heinze),error(heinze),density,pair corr. fn.,number \
of successful bisections,number of steps with permutations,the last path,the \
last joined,the longest permutation cycle}\n\narrayExtractor takes arrays of \
expectation values calculated on different processors and combines them into \
single expectation values per time step\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arrayExtractor", "[", 
    RowBox[{
    "energyTherm_", ",", "energyVirial_", ",", "energyFullVirial_", ",", 
     "energyHeinze_", ",", "calculateParticleDensityX_", ",", 
     "calculatePairCorrelationFunction_", ",", "numparticles_", ",", 
     "arrays_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "arraysEnergyTherm", ",", "arraysInvVarTherm", ",", 
       "arraysEnergyVirial", ",", "arraysInvVarVirial", ",", 
       "arraysEnergyFullVirial", ",", "arraysInvVarFullVirial", ",", 
       "arraysEnergyHeinze", ",", "arraysInvVarHeinze", ",", 
       "arraysParticleDensityX", ",", "arraysPairCorrelationFunction", ",", 
       "numsuccessesBisect", ",", "numpermuted", ",", "path", ",", "joined", 
       ",", "longestcycle", ",", "arraysVectorPairCorrelationFunction"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"energyTherm", ",", 
        RowBox[{"arraysEnergyTherm", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyTherm", ",", 
        RowBox[{"arraysInvVarTherm", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyVirial", ",", 
        RowBox[{"arraysEnergyVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyVirial", ",", 
        RowBox[{"arraysInvVarVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyFullVirial", ",", 
        RowBox[{"arraysEnergyFullVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyFullVirial", ",", 
        RowBox[{"arraysInvVarFullVirial", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyHeinze", ",", 
        RowBox[{"arraysEnergyHeinze", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "7", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{"energyHeinze", ",", 
        RowBox[{"arraysInvVarHeinze", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "8", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"calculateParticleDensityX", ",", 
        RowBox[{"arraysParticleDensityX", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "9", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"calculatePairCorrelationFunction", "&&", 
         RowBox[{"numparticles", ">", "1"}]}], ",", 
        RowBox[{"arraysVectorPairCorrelationFunction", "=", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
            RowBox[{"[", "10", "]"}], "]"}], ")"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numsuccessesBisect", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
         RowBox[{"[", "11", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numpermuted", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
         RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"path", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"13", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"joined", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"14", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"longestcycle", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Transpose", "@", "arrays"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"15", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"energyTherm", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyTherm"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarTherm"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarTherm"}], ")"}]}]]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyTherm", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarTherm"}], ")"}]}]}], "]"}],
         ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyVirial", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyVirial"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarVirial"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarVirial"}], ")"}]}]]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyVirial", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarVirial"}], ")"}]}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyFullVirial", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyFullVirial"}], ")"}], 
              "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarFullVirial"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarFullVirial"}], ")"}]}]]}],
          "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyFullVirial", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarFullVirial"}], ")"}]}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyHeinze", ",", 
          FractionBox[
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysEnergyHeinze"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"Transpose", "@", "arraysInvVarHeinze"}], ")"}]}], 
             ")"}]}], 
           RowBox[{"Total", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "@", "arraysInvVarHeinze"}], ")"}]}]]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"energyHeinze", ",", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "@", "arraysInvVarHeinze"}], ")"}]}]}], 
         "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"calculateParticleDensityX", ",", 
          RowBox[{"Catenate", "@", "arraysParticleDensityX"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"calculatePairCorrelationFunction", "&&", 
           RowBox[{"numparticles", ">", "1"}]}], ",", 
          RowBox[{"Catenate", "@", "arraysVectorPairCorrelationFunction"}]}], 
         "]"}], ",", "numsuccessesBisect", ",", "numpermuted", ",", "path", 
        ",", "joined", ",", "longestcycle"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialisationloop", "::", "usage"}], "=", 
   "\"\<initialisationloop[showPaths,\[Lambda],\[Tau],slices,numparticles,\
numsteps,startingRange,startingDelta,dimensionality]\nshowPaths - whether to \
plot the starting realisation of particle/bead positions\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\n\[Tau] - the time step, also a measure of inverse temperature\n\
slices - the number of slices/beads per particle\nnumparticles - the number \
of particles in the system\nnumsteps - the total number of time steps used\n\
startingRange - the position range over which to look for local minima to \
start particles in\nstartingDelta - the position sampling size over which \
minima are sought\ndimensionality - the dimension of the system\nRETURN - an \
array of the starting particle/bead positions, and starting association of \
all particles unpermuted\n\ninitialisationloop creates the starting particle \
positions and permutations, also printing some information about the system \
and the starting positions, if requested\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialisationloop", "[", 
    RowBox[{
    "showPaths_", ",", "\[Lambda]_", ",", "\[Tau]_", ",", "slices_", ",", 
     "numparticles_", ",", "numsteps_", ",", "startingRange_", ",", 
     "startingDelta_", ",", "dimensionality_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"originaljoined", ",", "originalpath", ",", "startingPos"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"originalpath", ",", "originaljoined"}], "]"}], ";", 
      RowBox[{
      "PrintTemporary", "[", 
       "\"\<Currently constructing the starting positions ...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"originaljoined", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"startingPos", "=", 
       RowBox[{"startingPositions", "[", 
        RowBox[{
        "numparticles", ",", "slices", ",", "startingRange", ",", 
         "startingDelta", ",", "dimensionality"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"startingPos", ",", "1"}], "]"}]}]}], "<", 
         "numparticles"}], ",", 
        RowBox[{
        "Print", "[", 
         "\"\<Appears to be at least one starting position with more than one \
particle: check if this is desired behaviour.  If not, try increasing \
startingRange or decreasing startingDelta.\>\"", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"originalpath", "=", 
       RowBox[{"startingPos", "+", 
        RowBox[{"pathInitialise", "[", 
         RowBox[{
         "numparticles", ",", "slices", ",", "\[Lambda]", ",", "\[Tau]", ",", 
          "dimensionality"}], "]"}]}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"originaljoined", "[", "i", "]"}], "=", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "originalpath"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Temperature kT=\>\"", ",", 
        FractionBox["1", 
         RowBox[{"\[Tau]", " ", "slices"}]]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Thermal wavelength \!\(\*SqrtBox[\(2  \[Lambda]\[Tau]\)]\)=\>\"", 
        ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"potentialAction1beadStatisticsC", "=", 
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"path", ",", "_Real", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Lambda]t", ",", "_Real"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Tau]t", ",", "_Real"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"particle", ",", "_Integer"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"bead", ",", "_Integer"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"joined", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], 
            ",", 
            RowBox[{
             RowBox[{
              FractionBox["\[Tau]t", "2"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"bead", "\[Equal]", "1"}], ",", 
                  RowBox[{"extV", "[", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"joined", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"joined", "[", 
                    RowBox[{"[", "particle", "]"}], "]"}], "]"}], "]"}]}]}], 
                    "]"}], "]"}], "]"}], ",", 
                  RowBox[{"extV", "[", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"particle", ",", 
                    RowBox[{"bead", "-", "1"}]}], "]"}], "]"}], "]"}]}], 
                 "]"}], "+", 
                RowBox[{"extV", "[", 
                 RowBox[{"path", "[", 
                  RowBox[{"[", 
                   RowBox[{"particle", ",", "bead"}], "]"}], "]"}], "]"}]}], 
               ")"}]}], "+", 
             RowBox[{"\[Tau]t", " ", 
              RowBox[{"Total", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"intpartV", "[", 
                  RowBox[{
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{"particle", ",", "bead"}], "]"}], "]"}], ",", 
                   RowBox[{"path", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"place", "[", 
                    RowBox[{
                    RowBox[{"Length", "@", "path"}], ",", 
                    RowBox[{"particle", "+", "j"}]}], "]"}], ",", "bead"}], 
                    "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"Length", "@", "path"}], "-", "1"}]}], "}"}]}], 
                "]"}]}]}]}]}], "]"}], "]"}], "/.", 
         RowBox[{"Join", "@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DownValues", "@", "extV"}], ",", 
            RowBox[{"DownValues", "@", "intpartV"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{
        "PrintTemporary", "[", "\"\<Currently drawing plot ...\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showPaths", ",", 
        RowBox[{"Print", "@", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
             RowBox[{"DensityPlot3D", "[", 
              RowBox[{
               RowBox[{"extV", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"OpacityFunction", "\[Rule]", "0.02"}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
                 "}"}]}]}], "]"}], ",", 
             RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
             RowBox[{"DensityPlot", "[", 
              RowBox[{
               RowBox[{"extV", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{
                  RowBox[{"-", "startingRange"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}], ",", 
                 RowBox[{"startingRange", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "\[Lambda]", " ", "\[Tau]"}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             "True", ",", 
             RowBox[{
             "Throw", "[", 
              "\"\<Unknown dimensionality in initialisationloop\>\"", "]"}]}],
             "]"}], ",", 
           RowBox[{"pathPlot", "[", 
            RowBox[{
            "originalpath", ",", "originaljoined", ",", "dimensionality"}], 
            "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"originalpath", ",", "originaljoined"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mainLoop", "::", "usage"}], "=", 
   "\"\<mainLoop[originalpath,originaljoined,\[Lambda],\[Tau],calculateEnergy,\
calculateParticleDensity,calculatePairCorrelationFunction,maxcyclelength,\
dimensionality,numparticles,equilibrationsteps,observablecalc,numsteps,slices,\
energyTherm,energyVirial,energyFullVirial,energyHeinze,\[Omega],harmonictrap,\
calculateFracSameWell]\noriginalpath - an array ofstarting particle/bead \
positions\noriginaljoined - an association of starting particle permutations\n\
\[Lambda] - \!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) \
for mass of particles m\n\[Tau] - the time step, also a measure of inverse \
temperature\ncalculateEnergy - whether to calculate the energy expectation \
value\ncalculateParticleDensityX - whether to calculate the single-particle \
density\ncalculatePairCorrelationFunction - whether to calculate the \
pair/density-density correlation function\nmaxcyclelength - the maximum \
number of particles to attempt to permute labels of in a single move\n\
dimensionality - the dimension of the system\nnumparticles - the number of \
particles in the system\nequilibrationsteps - number of time steps to \
equilibrate for before calculating expectation values\nobservablecalc - how \
many time steps between calculating expectation values\nnumsteps - the total \
number of time steps used\nslices - the number of slices/beads per particle\n\
energyTherm - whether to calculate the energy in the thermodynamic \
approximation\nenergyVirial - whether to calculate the energy in the virial \
approximation\nenergyFullVirial - whether to calculate the energy in the full \
virial approximation\nenergyHeinze - whether to calculate the energy using \
the Heinze procedure\n\[Omega] - harmonic trap frequency\nharmonictrap - \
whether to compare to analytic results in an harmonic trap\n\
calculateFracSameWell - whether to calculate fraction of particle pairs in \
the same well\nRETURN - an array of expectation values and other observables\n\
\nmainLoop does the main body of the path integral monte carlo calculation, \
calling the bisection algorithm and expectation value creation \
routines\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mainLoop", "[", 
    RowBox[{
    "originalpath_", ",", "originaljoined_", ",", "\[Lambda]_", ",", 
     "\[Tau]_", ",", "calculateEnergy_", ",", "calculateParticleDensity_", 
     ",", "calculatePairCorrelationFunction_", ",", "maxcyclelength_", ",", 
     "dimensionality_", ",", "numparticles_", ",", "equilibrationsteps_", ",",
      "observablecalc_", ",", "numsteps_", ",", "slices_", ",", 
     "energyTherm_", ",", "energyVirial_", ",", "energyFullVirial_", ",", 
     "energyHeinze_", ",", "\[Omega]_", ",", "harmonictrap_", ",", 
     "calculateFracSameWell_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "path", ",", "joined", ",", "particleDensity", ",", 
       "energysaveassocvirial", ",", "energysaveassocfullvirial", ",", 
       "energysaveassoctherm", ",", "energysaveassocheinze", ",", 
       "energysquaredsaveassocheinze", ",", "energysquaredsaveassocvirial", 
       ",", "energysquaredsaveassocfullvirial", ",", 
       "energysquaredsaveassoctherm", ",", "vectorPairCorrelationFunction", 
       ",", "numsuccessesBisect", ",", "numpermuted", ",", "successBisect", 
       ",", "kernels", ",", "mainRunTime", ",", "arrays", ",", 
       "energysaverarraytherm", ",", "invvartherm", ",", 
       "energysaverarrayvirial", ",", "invvarvirial", ",", 
       "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
       "energysaverarrayheinze", ",", "invvarheinze", ",", 
       "particleDensitysaverarray", ",", 
       "vectorPairCorrelationFunctionsaverarray", ",", "longestcycle"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"path", "=", "originalpath"}], ";", "\[IndentingNewLine]", 
      RowBox[{"joined", "=", "originaljoined"}], ";", "\[IndentingNewLine]", 
      RowBox[{"longestcycle", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"particleDensity", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassocvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassocfullvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassoctherm", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysaveassocheinze", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysquaredsaveassocheinze", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"energysquaredsaveassocvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysquaredsaveassocfullvirial", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"energysquaredsaveassoctherm", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", 
      RowBox[{"vectorPairCorrelationFunction", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
          "calculateEnergy", "||", "calculateParticleDensity", "||", 
           "calculatePairCorrelationFunction"}], ")"}]}], ",", 
        RowBox[{
        "Throw", "[", "\"\<We don't appear to be calculating anything?\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"path", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\[NotEqual]", "slices"}], ",", 
        RowBox[{
        "Throw", "[", 
         "\"\<Double-check you ran the 'Initialisation' cell\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"kernels", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"$KernelID", "\[Rule]", "i"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "$KernelCount"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "kernels", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "currentNumber", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentNumber", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "@", "kernels"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<Current fraction complete : \>\"", ",", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "@", 
           RowBox[{"Mean", "@", "currentNumber"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "100"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mainRunTime", ",", "arrays"}], "}"}], "=", 
       RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
        RowBox[{"ParallelEvaluate", "[", 
         RowBox[{
          RowBox[{"numsuccessesBisect", "=", "0"}], ";", 
          RowBox[{"numpermuted", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"successBisect", "=", "False"}], ";", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"successBisect", ",", "path", ",", "joined"}], "}"}], 
              "=", 
              RowBox[{"bisectionMoveStatistics", "[", 
               RowBox[{
               "path", ",", "\[Lambda]", ",", "\[Tau]", ",", "joined", ",", 
                "maxcyclelength", ",", "dimensionality"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{"Normal", "[", "joined", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
                "\[NotEqual]", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "joined", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{
               "Throw", "[", 
                "\"\<Joined array maps to same particle twice!\>\"", "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", "joined", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                 RowBox[{"Range", "@", "numparticles"}]}], "&&", 
                RowBox[{"step", ">", "equilibrationsteps"}]}], ",", 
               RowBox[{"numpermuted", "++"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"successBisect", "&&", 
                RowBox[{"step", ">", "equilibrationsteps"}]}], ",", 
               RowBox[{"numsuccessesBisect", "++"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Divisible", "[", 
                 RowBox[{"step", ",", "observablecalc"}], "]"}], "&&", 
                RowBox[{"step", "\[GreaterEqual]", "equilibrationsteps"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"numparticles", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "longestcycle"}], ",", 
                    RowBox[{"longestcycle", "=", "#"}]}], "]"}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{"First", "@", 
                    RowBox[{"tarjan", "[", "joined", "]"}]}], ")"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"calculateEnergy", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"energyTherm", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassoctherm", "[", "step", "]"}], ",", 
                    RowBox[{
                    "energysquaredsaveassoctherm", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", "\"\<therm\>\""}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"energyVirial", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassocvirial", "[", "step", "]"}], ",", 
                    RowBox[{
                    "energysquaredsaveassocvirial", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", "\"\<virial\>\""}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"energyFullVirial", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassocfullvirial", "[", "step", "]"}], 
                    ",", 
                    RowBox[{
                    "energysquaredsaveassocfullvirial", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", 
                    "\"\<fullvirial\>\""}], "]"}]}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"energyHeinze", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"energysaveassocheinze", "[", "step", "]"}], ",", 
                    RowBox[{
                    "energysquaredsaveassocheinze", "[", "step", "]"}]}], 
                    "}"}], "=", 
                    RowBox[{"energyAssocMakerStatistics", "[", 
                    RowBox[{
                    "step", ",", "numsteps", ",", "\[Lambda]", ",", "\[Tau]", 
                    ",", "numparticles", ",", "slices", ",", "path", ",", 
                    "joined", ",", "dimensionality", ",", "\"\<heinze\>\""}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    "energyTherm", "||", "energyVirial", "||", 
                    "energyFullVirial", "||", "energyHeinze"}], ")"}]}], ",", 
                    RowBox[{
                    "Throw", "[", 
                    "\"\<Calculating energy, but no energy estimators \
selected!\>\"", "]"}]}], "]"}], ";"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{"calculateParticleDensity", ",", 
                  RowBox[{
                   RowBox[{"particleDensity", "[", "step", "]"}], "=", 
                   RowBox[{"Join", "@@", "path"}]}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"calculatePairCorrelationFunction", "&&", 
                   RowBox[{"numparticles", ">", "1"}]}], ",", 
                  RowBox[{
                   RowBox[{
                   "vectorPairCorrelationFunction", "[", "step", "]"}], "=", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", "path"}], ")"}]}], ")"}]}]}]}], 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Divisible", "[", 
                RowBox[{"step", ",", "observablecalc"}], "]"}], ",", 
               RowBox[{
                RowBox[{"currentNumber", "[", 
                 RowBox[{"[", 
                  RowBox[{"$KernelID", "/.", "kernels"}], "]"}], "]"}], "=", 
                RowBox[{
                 FractionBox["step", "numsteps"], "*", "100."}]}]}], "]"}], 
             ";"}], ",", 
            RowBox[{"{", 
             RowBox[{"step", ",", "numsteps"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"energysaverarraytherm", ",", "invvartherm"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"energysaverarrayvirial", ",", "invvarvirial"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"energysaverarrayfullvirial", ",", "invvarfullvirial"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"energysaverarrayheinze", ",", "invvarheinze"}], 
              "}"}]}], "}"}], "=", 
           RowBox[{"energyMaker", "[", 
            RowBox[{
            "calculateEnergy", ",", "energyTherm", ",", "energyVirial", ",", 
             "energyFullVirial", ",", "energyHeinze", ",", "harmonictrap", 
             ",", "energysaveassoctherm", ",", "energysquaredsaveassoctherm", 
             ",", "energysaveassocvirial", ",", 
             "energysquaredsaveassocvirial", ",", "energysaveassocfullvirial",
              ",", "energysquaredsaveassocfullvirial", ",", 
             "energysaveassocheinze", ",", "energysquaredsaveassocheinze", 
             ",", "\[Tau]", ",", "slices", ",", "\[Omega]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "particleDensitysaverarray", ",", 
             "vectorPairCorrelationFunctionsaverarray"}], "}"}], "=", 
           RowBox[{"expectationValueMaker", "[", 
            RowBox[{
            "calculateParticleDensity", ",", 
             "calculatePairCorrelationFunction", ",", "numparticles", ",", 
             "particleDensity", ",", "vectorPairCorrelationFunction"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "energysaverarraytherm", ",", "invvartherm", ",", 
            "energysaverarrayvirial", ",", "invvarvirial", ",", 
            "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
            "energysaverarrayheinze", ",", "invvarheinze", ",", 
            "particleDensitysaverarray", ",", 
            "vectorPairCorrelationFunctionsaverarray", ",", 
            "numsuccessesBisect", ",", "numpermuted", ",", "path", ",", 
            "joined", ",", "longestcycle"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Temperature kT=\>\"", ",", 
        FractionBox["1", 
         RowBox[{"\[Tau]", " ", "slices"}]]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Run time of main loop: \>\"", ",", "mainRunTime", ",", 
        "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "energysaverarraytherm", ",", "invvartherm", ",", 
         "energysaverarrayvirial", ",", "invvarvirial", ",", 
         "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
         "energysaverarrayheinze", ",", "invvarheinze", ",", 
         "particleDensitysaverarray", ",", 
         "vectorPairCorrelationFunctionsaverarray", ",", "numsuccessesBisect",
          ",", "numpermuted", ",", "path", ",", "joined", ",", 
         "longestcycle"}], "}"}], "=", 
       RowBox[{"arrayExtractor", "[", 
        RowBox[{
        "energyTherm", ",", "energyVirial", ",", "energyFullVirial", ",", 
         "energyHeinze", ",", "calculateParticleDensity", ",", 
         "calculatePairCorrelationFunction", ",", "numparticles", ",", 
         "arrays"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Acceptance ratio bisection: \>\"", ",", 
        FractionBox[
         RowBox[{"numsuccessesBisect", "+", "0."}], 
         RowBox[{"(", 
          RowBox[{"numsteps", "-", "equilibrationsteps"}], ")"}]]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numparticles", ">", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Fractional time with permutations: \>\"", ",", 
          FractionBox[
           RowBox[{"numpermuted", "+", "0."}], 
           RowBox[{"(", 
            RowBox[{"numsteps", "-", "equilibrationsteps"}], ")"}]]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numparticles", ">", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Longest permutation cycle: \>\"", ",", "longestcycle", ",", 
          "\"\< which is \>\"", ",", 
          FractionBox[
           RowBox[{"longestcycle", "+", "0."}], "numparticles"], ",", 
          "\"\< of all particles\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"numparticles", ">", "1"}], "&&", "calculateFracSameWell", "&&",
          "calculatePairCorrelationFunction", "&&", 
         RowBox[{"dimensionality", "\[Equal]", "2"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Fraction of particle pairs within same well is \>\"", ",", 
          RowBox[{
          "fracsamewell", "[", "vectorPairCorrelationFunctionsaverarray", 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "energysaverarraytherm", ",", "invvartherm", ",", 
        "energysaverarrayvirial", ",", "invvarvirial", ",", 
        "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
        "energysaverarrayheinze", ",", "invvarheinze", ",", 
        "particleDensitysaverarray", ",", 
        "vectorPairCorrelationFunctionsaverarray", ",", "numsuccessesBisect", 
        ",", "numpermuted", ",", "path", ",", "joined"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierSpacing", "::", "usage"}], "=", 
   "\"\<barrierSpacing[startingRange,startingDelta,dimensionality,kvec]\n\
startingRange - the position range over which to look for local minima to \
start particles in\nstartingDelta - the position sampling size over which \
minima are sought\ndimensionality - the dimension of the system\nkvec - a \
measure of the momentum-space separation between minima of the potential; k \
in Sin[k x]\nRETURN - a plot of the distribution of heights of the barriers \
between adjacent potential minima\n\nbarrierSpacing is used to investigate \
the distribution of barriers between potential minima, for comparison between \
potentials\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierSpacing", "[", 
    RowBox[{
    "startingRange_", ",", "startingDelta_", ",", "dimensionality_", ",", 
     "kvec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "table", ",", "data", ",", "heights", ",", "minima", ",", "sets"}], 
      "}"}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"dimensionality", "\[Equal]", "3"}], ",", 
       RowBox[{
       "Throw", "[", 
        "\"\<Sorry, this feature isn't implemented for 3D yet\>\"", "]"}], 
       ",", 
       RowBox[{"dimensionality", "\[Equal]", "2"}], ",", 
       RowBox[{
        RowBox[{"table", "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"extV", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "startingRange"}], ",", "startingRange", ",", 
             "startingDelta"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "startingRange"}], ",", "startingRange", ",", 
             "startingDelta"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"table", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"heights", "=", 
         RowBox[{"table", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minima", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MaximalBy", "[", 
             RowBox[{
              RowBox[{"Join", "@@@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Riffle", "[", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
                   RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"MinDetect", "[", "heights", "]"}], ",", "2"}], 
                    "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Last"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"extV", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minima", "=", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "/.", 
              RowBox[{"Quiet", "@", 
               RowBox[{
                RowBox[{"FindMinimum", "[", 
                 RowBox[{
                  RowBox[{"extV", "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "#"}], "}"}], 
                   "]"}]}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], ",", "minima"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sets", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", 
            RowBox[{"minima", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ">", 
             RowBox[{"1.1", 
              SqrtBox["2"], 
              RowBox[{"\[Pi]", "/", "kvec"}]}]}]}]}], "]"}]}], ";", 
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"NMaximize", "[", 
                   RowBox[{
                    RowBox[{"extV", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
                    RowBox[{"Line", "[", "#", "]"}]}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"extV", "@", 
                  RowBox[{"minima", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "&"}], ",", 
               RowBox[{"sets", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{"sets", ",", 
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "minima"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", "0.05", "}"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<|r|\>\"", ",", "\"\<probability\>\""}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", "\"\<Histogram of barrier heights\>\""}]}], 
         "]"}]}], ",", "True", ",", 
       RowBox[{
       "Throw", "[", "\"\<Unknown dimensionality encountered\>\"", "]"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tarjan", "::", "usage"}], "=", 
   "\"\<tarjan[cycle]\ncycle - a 'joined' association of particle \
permutations\nRETURN - an array of the permutation cycle lengths encountered \
throughout a calculation\n\ntarjan implements a reduced version of the Tarjan \
algorithm to identify cycles within a permutation association\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tarjan", "[", "cycle_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$RecursionLimit", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"1024", ",", 
         RowBox[{"Length", "@", "cycle"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"visited", ",", "loops", ",", "loopfn", ",", "i"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"visited", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"False", ",", 
           RowBox[{"Length", "@", "cycle"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"loops", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "@", "cycle"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"loopfn", "[", 
          RowBox[{"loop_", ",", "v_"}], "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"visited", "[", 
             RowBox[{"[", "v", "]"}], "]"}], "\[Equal]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"cycle", "[", 
               RowBox[{"[", 
                RowBox[{"Key", "@", "v"}], "]"}], "]"}], "\[NotEqual]", "v"}],
              ",", 
             RowBox[{
              RowBox[{
               RowBox[{"visited", "[", 
                RowBox[{"[", "v", "]"}], "]"}], "=", "True"}], ";", 
              RowBox[{
               RowBox[{"loops", "[", 
                RowBox[{"[", "loop", "]"}], "]"}], "++"}], ";", 
              RowBox[{"loopfn", "[", 
               RowBox[{"loop", ",", 
                RowBox[{"cycle", "[", 
                 RowBox[{"[", 
                  RowBox[{"Key", "@", "v"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"visited", "[", 
                RowBox[{"[", "v", "]"}], "]"}], "=", "True"}], ";", 
              RowBox[{
               RowBox[{"loops", "[", 
                RowBox[{"[", "loop", "]"}], "]"}], "++"}], ";"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "cycle"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"visited", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "False"}], ",", 
            RowBox[{
             RowBox[{"loopfn", "[", 
              RowBox[{"i", ",", "i"}], "]"}], ";"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Reverse", "@", 
           RowBox[{"Sort", "@", 
            RowBox[{"Flatten", "@", "loops"}]}]}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "\[Equal]", "0"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fracsamewell", "::", "usage"}], "=", 
   "\"\<fracsamewell[vectorPairCorrelationFunctionsaverarray]\n\
vectorPairCorrelationFunctionsaverarray - an array of pairs of particle \
positions\nRETURN - a real number giving the fraction of pairs within a \
calculated distance\n\nfracsamewell is used to calculate what proportion of \
particle pairs are within the same potential minimum\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "fracsamewell", "[", "vectorPairCorrelationFunctionsaverarray_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"firstxmax", ",", "joinedlist"}], "}"}], ",", 
     RowBox[{
      RowBox[{"firstxmax", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"FindMaximum", "[", 
          RowBox[{
           RowBox[{"extV", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.01"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
      RowBox[{"joinedlist", "=", 
       RowBox[{"Join", "@@", "vectorPairCorrelationFunctionsaverarray"}]}], 
      ";", 
      RowBox[{
       FractionBox[
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
           "joinedlist"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "<", "firstxmax"}]}]}], "]"}], 
        RowBox[{"Length", "@", "joinedlist"}]], "//", "N"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hoppingt", "::", "usage"}], "=", 
   "\"\<hoppingt[\[Lambda],kvec,V,a]\n\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\nkvec - the k in V Sin[k x] for periodic potential\nV - the V in \
V Sin[k x] for periodic potential\na - scattering length\nRETURN - a real \
number, the kinetic energy constant for a Hubbard model\n\nhoppingt is used \
to calculate the kinetic constant for a Hubbard-model equivalent of a studied \
lattice\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hoppingt", "[", 
    RowBox[{"\[Lambda]_", ",", "kvec_", ",", "V_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["4", 
     SqrtBox["\[Pi]"]], "\[Lambda]", " ", 
    SuperscriptBox["kvec", "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["V", 
       RowBox[{"\[Lambda]", " ", 
        SuperscriptBox["kvec", "2"]}]], ")"}], 
     RowBox[{"3", "/", "4"}]], 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SqrtBox[
       FractionBox["V", 
        RowBox[{"\[Lambda]", " ", 
         SuperscriptBox["kvec", "2"]}]]]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barrierU", "::", "usage"}], "=", 
   "\"\<barrierU[\[Lambda],kvec,V,a]\n\n\[Lambda] - \
\!\(\*FractionBox[SuperscriptBox[\(\[HBar]\), \(2\)], \(2  m\)]\) for mass of \
particles m\nkvec - the k in V Sin[k x] for periodic potential\nV - the V in \
V Sin[k x] for periodic potential\na - scattering length\nRETURN - a real \
number, the well depth constant for a Hubbard model\n\nbarrierU is used to \
calculate the well depth for a Hubbard-model equivalent of a studied \
lattice\>\""}], ";", 
  RowBox[{
   RowBox[{"barrierU", "[", 
    RowBox[{"\[Lambda]_", ",", "kvec_", ",", "V_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     FractionBox["8", "\[Pi]"]], "kvec", " ", "a", " ", "\[Lambda]", " ", 
    SuperscriptBox["kvec", "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["V", 
       RowBox[{"\[Lambda]", " ", 
        SuperscriptBox["kvec", "2"]}]], ")"}], 
     RowBox[{"3", "/", "4"}]]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6937328577157955`*^9, 3.693732871926397*^9}, {
   3.6937329623351345`*^9, 3.6937330059617767`*^9}, {3.693733091028027*^9, 
   3.6937330926064224`*^9}, {3.6937331572881756`*^9, 3.693733158561211*^9}, {
   3.693733212249709*^9, 3.693733214680628*^9}, {3.6937337210567017`*^9, 
   3.693734024900859*^9}, {3.6937340564313064`*^9, 3.693734057986619*^9}, {
   3.6937341192586374`*^9, 3.693734294851548*^9}, {3.6937343524065*^9, 
   3.6937345055506334`*^9}, {3.693734654392229*^9, 3.6937346846451426`*^9}, {
   3.693734822614479*^9, 3.6937348315619273`*^9}, {3.6937349706983757`*^9, 
   3.6937350320502777`*^9}, {3.6937350892495337`*^9, 3.693735233460159*^9}, {
   3.693735318912857*^9, 3.693735340158223*^9}, {3.693735397550826*^9, 
   3.69373545160012*^9}, {3.693735502955567*^9, 3.693735581395976*^9}, {
   3.693735655054883*^9, 3.6937357160398736`*^9}, {3.693735760716426*^9, 
   3.6937357738367167`*^9}, {3.6937358388770337`*^9, 
   3.6937359371787415`*^9}, {3.693736156815794*^9, 3.6937361613531494`*^9}, {
   3.6937361983405523`*^9, 3.6937362028698587`*^9}, {3.693736265723651*^9, 
   3.6937363595291357`*^9}, {3.693736407252245*^9, 3.6937364760617685`*^9}, 
   3.693736513017078*^9, 3.6937366953331423`*^9, 3.693736772945053*^9, {
   3.6937368974394274`*^9, 3.693736964606036*^9}, {3.6937370565291433`*^9, 
   3.6937370675685406`*^9}, {3.6937371885307636`*^9, 
   3.6937371888987436`*^9}, {3.693737227232959*^9, 3.6937372339065127`*^9}, {
   3.693739350864886*^9, 3.6937393905398064`*^9}, {3.6937394549777822`*^9, 
   3.693739456559867*^9}, {3.6937396980015855`*^9, 3.693739733814211*^9}, {
   3.693739906255794*^9, 3.6937399071503105`*^9}, {3.693740505091183*^9, 
   3.6937405472313905`*^9}, 3.693740624991358*^9, {3.6937409568412037`*^9, 
   3.693740956913821*^9}, {3.693741013848127*^9, 3.6937410184606285`*^9}, {
   3.6937421270682783`*^9, 3.693742476053337*^9}, {3.693742536333623*^9, 
   3.693742589922074*^9}, {3.6937426822423315`*^9, 3.6937426891875896`*^9}, {
   3.6937427507107286`*^9, 3.693742777058873*^9}, {3.693742924401736*^9, 
   3.6937429252721605`*^9}, 3.6937429568233614`*^9, 3.69374319822071*^9, {
   3.693743404901238*^9, 3.693743453366543*^9}, {3.693743484054395*^9, 
   3.693743632756857*^9}, 3.6937436812628703`*^9, {3.6937439920790086`*^9, 
   3.6937440026768703`*^9}, {3.6937442892899637`*^9, 3.693744333693492*^9}, {
   3.693744364629568*^9, 3.6937444316441708`*^9}, {3.6937445823463836`*^9, 
   3.6937446957903495`*^9}, {3.693744734410906*^9, 3.6937448465496187`*^9}, {
   3.6937452209822626`*^9, 3.6937452210963373`*^9}, {3.6937459351388583`*^9, 
   3.6937460025604286`*^9}, 3.693747287166373*^9, {3.6937476531338496`*^9, 
   3.6937476532790365`*^9}, 3.69389383497793*^9, {3.6938954599266577`*^9, 
   3.6938955120021996`*^9}, {3.6938956037092066`*^9, 
   3.6938956191259813`*^9}, {3.6938958726166735`*^9, 3.693895892682617*^9}, {
   3.693896056522691*^9, 3.6938960604547386`*^9}, {3.6938961068401823`*^9, 
   3.6938961949411345`*^9}, 3.693896285316744*^9, {3.6938967987117543`*^9, 
   3.6938968177962885`*^9}, {3.693896890030961*^9, 3.693896895682151*^9}, {
   3.6938969802267933`*^9, 3.693897070631871*^9}, {3.6938971161376143`*^9, 
   3.693897117002226*^9}, {3.6938971471988072`*^9, 3.693897160529114*^9}, {
   3.6938972058063965`*^9, 3.6938972160503626`*^9}, {3.6938973641489277`*^9, 
   3.693897402279758*^9}, {3.6938974779174943`*^9, 3.6938975150862923`*^9}, {
   3.6938976021915436`*^9, 3.6938976032209578`*^9}, {3.69389775060184*^9, 
   3.6938977514418983`*^9}, 3.6938979467604628`*^9, 3.693898100376807*^9, 
   3.693898315501224*^9, 3.6938985325230184`*^9, {3.693899389681425*^9, 
   3.6938994113790226`*^9}, {3.693899444561149*^9, 3.6938994525772057`*^9}, {
   3.6938995232272863`*^9, 3.6938995464730372`*^9}, {3.693900404041184*^9, 
   3.693900446823524*^9}, {3.694348378403511*^9, 3.694348380737541*^9}, {
   3.694348423884836*^9, 3.694348429566416*^9}, {3.6943485455491786`*^9, 
   3.6943485460818396`*^9}, {3.694348580728989*^9, 3.694348650021744*^9}, {
   3.694348705128582*^9, 3.694348823201338*^9}, {3.694348860721506*^9, 
   3.694348862087966*^9}, {3.6943488982936773`*^9, 3.6943488984612684`*^9}, {
   3.6943491069870334`*^9, 3.694349116748706*^9}, {3.6943491516980505`*^9, 
   3.6943491545195556`*^9}, {3.694349196059837*^9, 3.6943492047129326`*^9}, {
   3.694349242788161*^9, 3.694349259835473*^9}, {3.6943495780667267`*^9, 
   3.694349578252164*^9}, {3.6943496928403406`*^9, 3.6943496997627163`*^9}, {
   3.6943497596672153`*^9, 3.69434976032069*^9}, {3.694349842751155*^9, 
   3.694349850861555*^9}, {3.694349985697508*^9, 3.6943499970928726`*^9}, {
   3.694350138788652*^9, 3.694350143280735*^9}, {3.6943503193981414`*^9, 
   3.694350348696685*^9}, {3.6943505031438847`*^9, 3.694350541339717*^9}, {
   3.694350765036606*^9, 3.694350850276313*^9}, {3.694350952143583*^9, 
   3.694350983792643*^9}, {3.694351139699606*^9, 3.6943511711847053`*^9}, 
   3.6943512303088803`*^9, {3.694351512022543*^9, 3.694351516239496*^9}, 
   3.694351877072115*^9, {3.694588152338148*^9, 3.6945882192070665`*^9}, {
   3.6945882499468613`*^9, 3.6945882620057077`*^9}, {3.6945883185962205`*^9, 
   3.6945883216605062`*^9}, {3.6945883629457006`*^9, 
   3.6945883827118225`*^9}, {3.694588420164903*^9, 3.6945884819838395`*^9}, {
   3.694588547884305*^9, 3.6945885907187123`*^9}, {3.6945887457330356`*^9, 
   3.694588797251514*^9}, {3.6945889083500175`*^9, 3.6945889301477537`*^9}, {
   3.6945889772994614`*^9, 3.694588979236189*^9}, {3.694589010175273*^9, 
   3.6945890146711664`*^9}, {3.6945898895312557`*^9, 3.6945899024481516`*^9}, 
   3.694590218881259*^9, {3.6945905800917616`*^9, 3.6945905868829527`*^9}, 
   3.6945906970142045`*^9, 3.6945907340769978`*^9, {3.6945908995935144`*^9, 
   3.6945909027236137`*^9}, {3.694591417308548*^9, 3.6945914222228403`*^9}, {
   3.694591711261218*^9, 3.694591740703244*^9}, {3.694591776296466*^9, 
   3.694591798636243*^9}, {3.694592115824007*^9, 3.69459219371562*^9}, 
   3.694796601063303*^9, {3.6947966342518682`*^9, 3.694796769178394*^9}, {
   3.6947968076039867`*^9, 3.6947968513053713`*^9}, {3.694796888162255*^9, 
   3.6947968922118883`*^9}, {3.694797005130186*^9, 3.694797009844381*^9}, {
   3.694797056550145*^9, 3.694797059299159*^9}, {3.694797131963108*^9, 
   3.6947971550523634`*^9}, {3.6947972858097444`*^9, 3.694797288452361*^9}, {
   3.6947974264082794`*^9, 3.6947974317205925`*^9}, 3.6947974946273108`*^9, {
   3.6947975675776844`*^9, 3.694797582685236*^9}, {3.694797717837392*^9, 
   3.694797721109836*^9}, {3.6947977925072556`*^9, 3.6947977931152096`*^9}, 
   3.6947978769743614`*^9, 3.6947980784916162`*^9, 3.6947982466652293`*^9, 
   3.694798494211519*^9, {3.6947985568003674`*^9, 3.6947985665986505`*^9}, {
   3.694798681808041*^9, 3.694798691268399*^9}, {3.694798749141557*^9, 
   3.694798752181282*^9}, {3.6947988244429*^9, 3.6947988245700426`*^9}, {
   3.6947988721526403`*^9, 3.694798876856243*^9}, {3.694798961889494*^9, 
   3.694798975231694*^9}, 3.6947990405814962`*^9, 3.6947991003564987`*^9, {
   3.6947991997660527`*^9, 3.6947992052068386`*^9}, {3.6947992795580306`*^9, 
   3.694799296680137*^9}, 3.694799354747449*^9, {3.6947994132777557`*^9, 
   3.694799419216998*^9}, {3.6947994670731463`*^9, 3.694799467514634*^9}, {
   3.694799531505315*^9, 3.694799533223065*^9}, {3.6947995992168474`*^9, 
   3.6947996043683724`*^9}, 3.6947996694832964`*^9, 3.6947997362338057`*^9, {
   3.694799823487182*^9, 3.6947998272011127`*^9}, {3.694799869090934*^9, 
   3.6947998830005493`*^9}, {3.694799933592022*^9, 3.6947999774036922`*^9}, {
   3.69480011703117*^9, 3.694800145878871*^9}, {3.6948001772715993`*^9, 
   3.6948001830469613`*^9}, 3.6948002147502947`*^9, 3.6948002876773863`*^9, 
   3.694800384059367*^9, 3.694800477869158*^9, {3.6948005419312615`*^9, 
   3.694800546987245*^9}, {3.6948006960932093`*^9, 3.6948006987006626`*^9}, 
   3.694800837843979*^9, {3.694956382623393*^9, 3.6949563958387957`*^9}, {
   3.6949564897793565`*^9, 3.6949565466347623`*^9}, {3.6949566143670235`*^9, 
   3.694956616974881*^9}, {3.694957488348857*^9, 3.6949574887708154`*^9}, {
   3.694957864125721*^9, 3.6949578668751345`*^9}, {3.6953815255727897`*^9, 
   3.6953815263853807`*^9}, {3.6953815638655977`*^9, 
   3.6953815644359517`*^9}, {3.695381718371852*^9, 3.695381731744876*^9}, {
   3.6953818502161818`*^9, 3.6953818536349497`*^9}, {3.6953823455524645`*^9, 
   3.6953823474251575`*^9}, {3.6953823885842743`*^9, 
   3.6953823917402997`*^9}, {3.695382587229602*^9, 3.6953825901501637`*^9}, {
   3.6953826640584626`*^9, 3.6953826812141013`*^9}, {3.695382731102551*^9, 
   3.6953827347529945`*^9}, 3.695382771505479*^9, {3.695383060330981*^9, 
   3.6953830753265963`*^9}, {3.6953832368731084`*^9, 3.695383255576876*^9}, {
   3.695383329744881*^9, 3.695383333652198*^9}, {3.695383396663517*^9, 
   3.6953834044491696`*^9}, {3.6953835222424927`*^9, 3.6953835997700768`*^9}, 
   3.6953840840015306`*^9, {3.6953842779456663`*^9, 3.695384343594803*^9}, {
   3.695384412139904*^9, 3.695384456158177*^9}, {3.695384789187792*^9, 
   3.6953847897739015`*^9}, {3.695384870885027*^9, 3.695384912121307*^9}, 
   3.695385104191775*^9, {3.6953852023820047`*^9, 3.695385205224455*^9}, {
   3.6953852622261353`*^9, 3.6953852667439723`*^9}, {3.6953853201064987`*^9, 
   3.6953853202442913`*^9}, {3.6953855790924263`*^9, 
   3.6953855820523977`*^9}, {3.695387403696869*^9, 3.6953874062623653`*^9}, {
   3.6955414436407967`*^9, 3.6955414460921016`*^9}, {3.6955415555274563`*^9, 
   3.6955416246567025`*^9}, {3.6955416854473906`*^9, 
   3.6955417135025034`*^9}, {3.695541779068056*^9, 3.6955417967893944`*^9}, {
   3.6955418916116605`*^9, 3.6955419546999874`*^9}, {3.6955420022606373`*^9, 
   3.695542016839148*^9}, {3.695542068469715*^9, 3.6955420700237455`*^9}, {
   3.695542106983405*^9, 3.6955421222505817`*^9}, {3.6955421868200755`*^9, 
   3.695542225118989*^9}, {3.695542259458274*^9, 3.6955422840424504`*^9}, {
   3.695542364502957*^9, 3.695542367066472*^9}, {3.695542420605754*^9, 
   3.6955424643549485`*^9}, {3.6955425022361283`*^9, 
   3.6955425241094327`*^9}, {3.695542624632284*^9, 3.695542625264017*^9}, {
   3.6955426558254576`*^9, 3.6955426562579947`*^9}, {3.695543195441657*^9, 
   3.6955431968173275`*^9}, {3.695543384886084*^9, 3.695543408753065*^9}, {
   3.6955441560440407`*^9, 3.6955441651947765`*^9}, {3.695544204652798*^9, 
   3.6955442085007567`*^9}, 3.695544334436845*^9, {3.695544398168744*^9, 
   3.695544455838892*^9}, {3.6955445735530167`*^9, 3.69554457799187*^9}, {
   3.695544643504475*^9, 3.6955446448220778`*^9}, {3.6955447371556296`*^9, 
   3.6955447400564547`*^9}, {3.695545389929453*^9, 3.6955454058810263`*^9}, {
   3.6955500021206164`*^9, 3.695550005229519*^9}, {3.6955515508011904`*^9, 
   3.695551561697544*^9}, {3.6955537509755373`*^9, 3.695553755926751*^9}, {
   3.695553868626031*^9, 3.695553878951897*^9}, {3.6955539315321465`*^9, 
   3.695553934327298*^9}, 3.695553968571542*^9, 3.695554406993353*^9, {
   3.695554918651978*^9, 3.6955549220778737`*^9}, {3.6955554666508007`*^9, 
   3.6955554721434174`*^9}, {3.6955555381554995`*^9, 
   3.6955555610258455`*^9}, {3.6955560788998876`*^9, 3.695556201492799*^9}, {
   3.695556333011636*^9, 3.69555637977626*^9}, {3.695556414757777*^9, 
   3.695556523853095*^9}, {3.6955567085871983`*^9, 3.695556713142626*^9}, {
   3.6955568224232273`*^9, 3.6955568809245553`*^9}, {3.6955569122113543`*^9, 
   3.6955569430294275`*^9}, {3.6955570310719867`*^9, 
   3.6955571415730333`*^9}, {3.695557292978301*^9, 3.695557297149123*^9}, {
   3.695557381368019*^9, 3.695557385187851*^9}, {3.695557445929472*^9, 
   3.695557448448922*^9}, {3.6955579628297205`*^9, 3.6955579664337273`*^9}, {
   3.695558073856519*^9, 3.695558075689453*^9}, {3.6955581114270654`*^9, 
   3.695558111626439*^9}, {3.695558612790351*^9, 3.6955586514661355`*^9}, {
   3.6955586989011507`*^9, 3.6955587889916143`*^9}, {3.696744400893324*^9, 
   3.696744407031744*^9}, {3.6967453528840337`*^9, 3.6967453876152725`*^9}, {
   3.6967458562052*^9, 3.696745863119633*^9}, {3.696746017939933*^9, 
   3.696746020561135*^9}, {3.6967461396153283`*^9, 3.6967461522012625`*^9}, {
   3.696746246723404*^9, 3.696746257260377*^9}, {3.6967463254307017`*^9, 
   3.696746339951249*^9}, 3.6967463862894306`*^9, {3.696746476409947*^9, 
   3.6967464949185514`*^9}, {3.696746633075533*^9, 3.6967466997162495`*^9}, {
   3.6967470277656913`*^9, 3.696747040042522*^9}, {3.6967476660281677`*^9, 
   3.696747680745244*^9}, {3.6967478413996487`*^9, 3.6967478419277525`*^9}, {
   3.696748007301557*^9, 3.696748038383421*^9}, {3.696748205064007*^9, 
   3.696748213857814*^9}, {3.6967483191209183`*^9, 3.69674832154075*^9}, {
   3.6967489563049755`*^9, 3.696748967415389*^9}, {3.696749037058161*^9, 
   3.696749047752804*^9}, {3.6967491607088366`*^9, 3.696749165356569*^9}, {
   3.6967492255811596`*^9, 3.696749265321503*^9}, {3.6967498246931667`*^9, 
   3.69674983674776*^9}, {3.696749882189721*^9, 3.6967498850261736`*^9}, {
   3.6967529254732943`*^9, 3.696752953442108*^9}, {3.6967530122794914`*^9, 
   3.6967530927073874`*^9}, {3.6967531751923895`*^9, 3.69675320003513*^9}, {
   3.696753237373773*^9, 3.696753344879094*^9}, 3.696753710915655*^9, {
   3.6967537751313334`*^9, 3.696753787333697*^9}, 3.6967538394638443`*^9, {
   3.6967538941083193`*^9, 3.696754301458558*^9}, {3.6967547581932554`*^9, 
   3.6967547739254055`*^9}, {3.6967550209581475`*^9, 
   3.6967550302586017`*^9}, {3.6967552373622136`*^9, 3.696755238924272*^9}, {
   3.696755435242628*^9, 3.696755550568416*^9}, {3.696755621258362*^9, 
   3.6967557703460608`*^9}, {3.696755817750074*^9, 3.6967559203573666`*^9}, 
   3.6967560027670107`*^9, {3.6967566140904207`*^9, 3.6967566338206987`*^9}, {
   3.6967573085536647`*^9, 3.6967573252218237`*^9}, {3.696757808639658*^9, 
   3.6967578237743044`*^9}, {3.696761181124696*^9, 3.696761189671977*^9}, {
   3.6967626579580326`*^9, 3.696762661092307*^9}, {3.6967629713482685`*^9, 
   3.696762976971311*^9}, {3.6967630433047657`*^9, 3.6967630874041*^9}, {
   3.696763148234123*^9, 3.696763155073603*^9}, {3.696763207429207*^9, 
   3.696763209265852*^9}, {3.6967632610111027`*^9, 3.6967632624678726`*^9}, {
   3.696763304668929*^9, 3.6967633058577814`*^9}, {3.696763356024865*^9, 
   3.696763357993297*^9}, {3.6967634405299053`*^9, 3.696763441792782*^9}, {
   3.6967634850528717`*^9, 3.6967635210679007`*^9}, {3.6970296153283405`*^9, 
   3.6970296456555514`*^9}, {3.6981346520277166`*^9, 
   3.6981346531686525`*^9}, {3.6981390659764724`*^9, 3.6981390716932735`*^9}, 
   3.698139326199333*^9, {3.6981397135301695`*^9, 3.6981397152503114`*^9}, {
   3.6981397884289675`*^9, 3.6981397902731886`*^9}, {3.6981519828522625`*^9, 
   3.6981520071765356`*^9}, {3.698152833794609*^9, 3.6981528455266323`*^9}, {
   3.698153180750084*^9, 3.6981531959469285`*^9}, 3.698329694190998*^9, {
   3.69833129442272*^9, 3.6983313199535685`*^9}, {3.6983315898849306`*^9, 
   3.698331645137048*^9}, {3.6986474446470585`*^9, 3.6986474462803445`*^9}, {
   3.698649411021797*^9, 3.6986494905540295`*^9}, {3.6986495323649054`*^9, 
   3.6986495844370127`*^9}, {3.698649651567284*^9, 3.698649661942586*^9}, {
   3.698649776456063*^9, 3.6986497771926785`*^9}, {3.6986501145631437`*^9, 
   3.6986501170759153`*^9}, {3.6987370540231047`*^9, 
   3.6987370542511625`*^9}, {3.698745040098801*^9, 3.6987450406649027`*^9}, {
   3.6987451038180466`*^9, 3.698745104143914*^9}, {3.6987451631342816`*^9, 
   3.698745222901985*^9}, {3.6987452713349333`*^9, 3.6987454831909246`*^9}, {
   3.6987455707938595`*^9, 3.6987456352069745`*^9}, 3.698745948769885*^9, {
   3.698745991044155*^9, 3.6987459917121396`*^9}, {3.6987466535666933`*^9, 
   3.698746656016897*^9}, {3.698750651484751*^9, 3.6987506560211506`*^9}, 
   3.6987507486946373`*^9, {3.698751904623638*^9, 3.6987519111690874`*^9}, {
   3.698752099963913*^9, 3.6987521048464193`*^9}, {3.698755209386197*^9, 
   3.6987552495374346`*^9}, {3.698755346186655*^9, 3.6987553478229303`*^9}, 
   3.6987553994643946`*^9, {3.6987554392372274`*^9, 3.698755553597015*^9}, {
   3.698755613511908*^9, 3.69875581448138*^9}, {3.6987558470596066`*^9, 
   3.698755924843093*^9}, {3.6987560544280815`*^9, 3.698756084576733*^9}, {
   3.6987561505760765`*^9, 3.69875615536769*^9}, {3.698756284455168*^9, 
   3.6987563326844473`*^9}, {3.698757214662123*^9, 3.6987572468759804`*^9}, {
   3.698757591299078*^9, 3.6987579735266542`*^9}, {3.6987580801962633`*^9, 
   3.69875808064443*^9}, {3.698758213286351*^9, 3.6987582252693844`*^9}, {
   3.698758317555768*^9, 3.6987583433330817`*^9}, {3.6987584014155593`*^9, 
   3.6987584030504913`*^9}, 3.6987584430562167`*^9, 3.698759029468719*^9, {
   3.6989967203972387`*^9, 3.698996728819853*^9}, {3.699001224544629*^9, 
   3.6990012639760456`*^9}, 3.699001579999382*^9, {3.6990039301826544`*^9, 
   3.699003931601199*^9}, {3.6990042445415683`*^9, 3.699004336596517*^9}, {
   3.6990045065127907`*^9, 3.699004522271346*^9}, {3.699004868181716*^9, 
   3.69900487219659*^9}, {3.699004961347357*^9, 3.6990049707340984`*^9}, {
   3.699005834652977*^9, 3.6990058565376806`*^9}, {3.699006039874158*^9, 
   3.699006043763255*^9}, {3.6990063108037863`*^9, 3.699006313081642*^9}, {
   3.6990064398307743`*^9, 3.699006442203493*^9}, {3.6990065775699625`*^9, 
   3.6990065784862514`*^9}, {3.6990066334497623`*^9, 3.69900664069993*^9}, {
   3.699006713688736*^9, 3.699006721956896*^9}, {3.6990110609564066`*^9, 
   3.6990110922880774`*^9}, 3.6990115467472763`*^9, {3.699011630462675*^9, 
   3.6990116658088417`*^9}, {3.6990168376275578`*^9, 3.699016904144115*^9}, {
   3.6990183203062105`*^9, 3.6990183578501596`*^9}, {3.699020790582703*^9, 
   3.699020790800967*^9}, {3.6990213834635906`*^9, 3.699021385128069*^9}, {
   3.699191574602974*^9, 3.6991915997530975`*^9}, {3.6991925308421144`*^9, 
   3.6991925330103416`*^9}, {3.6991931893300133`*^9, 
   3.6991932156278725`*^9}, {3.6993489209610353`*^9, 3.699348921455079*^9}, {
   3.6993490214085264`*^9, 3.6993490244522476`*^9}, {3.6996835810112453`*^9, 
   3.6996835869889345`*^9}, {3.6996896217017593`*^9, 
   3.6996896218766985`*^9}, {3.6996905012113223`*^9, 
   3.6996905059192734`*^9}, {3.6996936488302355`*^9, 3.699693682891845*^9}, {
   3.699694171053814*^9, 3.6996941713720884`*^9}, {3.6996950958061285`*^9, 
   3.699695118370365*^9}, 3.699696697336752*^9, {3.699696757326259*^9, 
   3.6996967885571537`*^9}, {3.6996968577440476`*^9, 
   3.6996968912786074`*^9}, {3.6996969413222885`*^9, 
   3.6996969417571545`*^9}, {3.6996969937981887`*^9, 
   3.6996970524816685`*^9}, {3.6996976040966806`*^9, 
   3.6996976052294188`*^9}, {3.70020256968288*^9, 3.7002025728121853`*^9}, 
   3.7002042623509126`*^9, {3.700206710008403*^9, 3.700206720513959*^9}, {
   3.700208708577815*^9, 3.7002087274605055`*^9}, {3.7002115172134876`*^9, 
   3.70021151975589*^9}, {3.700212975362315*^9, 3.700212987048631*^9}, {
   3.7002133911524935`*^9, 3.7002133937580185`*^9}, {3.700213432867756*^9, 
   3.700213432994852*^9}, {3.7010828520913677`*^9, 3.701082852341383*^9}, 
   3.701083525345909*^9, {3.7010839379850683`*^9, 3.7010839894916267`*^9}, 
   3.701084774543027*^9, {3.701090293545869*^9, 3.701090295754433*^9}, 
   3.7010906051762*^9, {3.701090717029852*^9, 3.701090785475825*^9}, {
   3.7010908907669907`*^9, 3.7010909124951363`*^9}, {3.7019472312793727`*^9, 
   3.7019472713053217`*^9}, {3.7019474631935883`*^9, 3.7019474778681307`*^9}, 
   3.701947752929531*^9, {3.7019478128764024`*^9, 3.701947861535141*^9}, {
   3.701947892073057*^9, 3.701947902531472*^9}, {3.7019480045725965`*^9, 
   3.7019480220837812`*^9}, {3.7019480625638676`*^9, 
   3.7019481421105027`*^9}, {3.701948174137224*^9, 3.7019482382532787`*^9}, 
   3.701948763687353*^9, {3.702374406623624*^9, 3.7023744094183574`*^9}, {
   3.702390576424737*^9, 3.702390601122178*^9}, {3.7023906351869793`*^9, 
   3.7023908011850986`*^9}, {3.702390850067935*^9, 3.7023908916156063`*^9}, {
   3.702390937167017*^9, 3.7023909401264277`*^9}, {3.702391205633848*^9, 
   3.702391295492752*^9}, {3.7023913274338923`*^9, 3.7023913663369083`*^9}, {
   3.702391416984788*^9, 3.7023914295399466`*^9}, {3.702391484962322*^9, 
   3.702391521074007*^9}, {3.702391569080635*^9, 3.7023916585698957`*^9}, {
   3.7023917056411414`*^9, 3.7023919675641203`*^9}, {3.7023920202713547`*^9, 
   3.7023920767868376`*^9}, {3.7023921176540165`*^9, 
   3.7023921923860435`*^9}, {3.7023922301772585`*^9, 3.702392242026648*^9}, {
   3.702392339297451*^9, 3.7023924049409595`*^9}, {3.702392628761347*^9, 
   3.702392774270048*^9}, {3.7023928428867674`*^9, 3.702392937975214*^9}, {
   3.702393038277297*^9, 3.7023931170593557`*^9}, {3.7023931716404495`*^9, 
   3.7023931727182703`*^9}, {3.7023932129612427`*^9, 
   3.7023932356714907`*^9}, {3.702393316346282*^9, 3.702393367234672*^9}, {
   3.702393436393159*^9, 3.702393438038121*^9}, {3.7023935885128183`*^9, 
   3.702393593669727*^9}, {3.7023939249326963`*^9, 3.702393941675706*^9}, {
   3.70239409311698*^9, 3.7023941080413523`*^9}, {3.70266036717586*^9, 
   3.702660368084465*^9}, {3.702660425592696*^9, 3.7026604257087727`*^9}, {
   3.702660490697978*^9, 3.7026604956132455`*^9}, {3.7026605564932594`*^9, 
   3.702660569454878*^9}, {3.7032369186856575`*^9, 3.7032369215984793`*^9}, 
   3.703237527000278*^9, {3.7032409093401585`*^9, 3.703240912045637*^9}, {
   3.7032445771114764`*^9, 3.7032446080444756`*^9}, {3.70324464708543*^9, 
   3.703244680588703*^9}, {3.703244774992462*^9, 3.703244786869525*^9}, {
   3.7033971610913353`*^9, 3.7033971614595785`*^9}, {3.703397399953444*^9, 
   3.7033974607368546`*^9}, 3.703398059349988*^9, {3.7033981250765524`*^9, 
   3.703398158540794*^9}, {3.703399805631974*^9, 3.703399948983839*^9}, {
   3.703400005870658*^9, 3.7034000062829275`*^9}, {3.7034000632892804`*^9, 
   3.7034002225721717`*^9}, {3.7034002746691475`*^9, 
   3.7034002891837964`*^9}, {3.703401756741975*^9, 3.7034017611708174`*^9}, {
   3.7034018275202684`*^9, 3.703401827562297*^9}, {3.703401859988226*^9, 
   3.7034018795102167`*^9}, {3.7034050749002323`*^9, 
   3.7034050778148046`*^9}, {3.7044360799631042`*^9, 
   3.7044360871414013`*^9}, {3.704436192763096*^9, 3.704436193126966*^9}, {
   3.704436232229046*^9, 3.704436254892293*^9}, {3.704455485146399*^9, 
   3.7044555678955793`*^9}, {3.704532022616886*^9, 3.704532102406918*^9}, {
   3.7045379098571253`*^9, 3.704537922179668*^9}, {3.704629389860537*^9, 
   3.704629404544704*^9}, {3.704630445024473*^9, 3.7046304456169157`*^9}, {
   3.7046304826371107`*^9, 3.704630486317354*^9}, {3.7046305904249067`*^9, 
   3.704630595029345*^9}, {3.7046306370833483`*^9, 3.704630714566762*^9}, {
   3.704630753167489*^9, 3.704630921675601*^9}, {3.704630965776515*^9, 
   3.704630981861772*^9}, {3.704689747696971*^9, 3.7046897562978973`*^9}, {
   3.70477936737661*^9, 3.704779415872752*^9}, {3.704796356297931*^9, 
   3.7047963762220645`*^9}, {3.7047964379620433`*^9, 3.704796673960289*^9}, {
   3.704796728953624*^9, 3.70479718004766*^9}, {3.7047972380526752`*^9, 
   3.7047980089238157`*^9}, {3.7047981100489817`*^9, 
   3.7047982934008827`*^9}, {3.70479832920107*^9, 3.704798394810946*^9}, {
   3.704798459730542*^9, 3.704798533059264*^9}, {3.70488817948901*^9, 
   3.704888336449789*^9}, {3.704888491877344*^9, 3.7048885754697847`*^9}, {
   3.704888607594077*^9, 3.7048887233274355`*^9}, {3.704888852669753*^9, 
   3.7048888625139112`*^9}, {3.7048891215939116`*^9, 3.704889262158228*^9}, {
   3.7048893174038534`*^9, 3.7048894331659408`*^9}, {3.70489059165767*^9, 
   3.7048906649044867`*^9}, {3.7048907485177207`*^9, 
   3.7048909056517673`*^9}, {3.7048909873699427`*^9, 
   3.7048911107990603`*^9}, {3.7049583652524166`*^9, 
   3.7049584594301944`*^9}, {3.704958504072755*^9, 3.704958765903878*^9}, 
   3.7049588201909933`*^9, {3.70495886414058*^9, 3.7049589113239307`*^9}, {
   3.704958980711299*^9, 3.70495908667237*^9}, {3.704959157634282*^9, 
   3.7049593330662084`*^9}, {3.7049593683723383`*^9, 3.704959393188727*^9}, {
   3.704959455182458*^9, 3.7049595419537616`*^9}, {3.704959611514118*^9, 
   3.704960180369914*^9}, {3.7049602128672943`*^9, 3.704960239018441*^9}, {
   3.704960393512287*^9, 3.70496114422766*^9}, {3.7049612002194223`*^9, 
   3.7049612663157606`*^9}, {3.7049613042199755`*^9, 
   3.7049613137352595`*^9}, {3.7049613536868086`*^9, 3.704961492993756*^9}, {
   3.7049615238659396`*^9, 3.704961578568671*^9}, {3.7049616785573025`*^9, 
   3.7049618073299417`*^9}, {3.704961979053316*^9, 3.704961991112254*^9}, {
   3.70496283477418*^9, 3.704962860756607*^9}, {3.7049820456725597`*^9, 
   3.704982132324394*^9}, 3.7049821670069475`*^9, {3.704982222571184*^9, 
   3.704982268424224*^9}, {3.7049823305308647`*^9, 3.7049824457639885`*^9}, {
   3.70498252802617*^9, 3.7049826376626368`*^9}, {3.7049826679812965`*^9, 
   3.704982720635203*^9}, {3.704982760546812*^9, 3.7049827610470853`*^9}, {
   3.705050416317898*^9, 3.705050490422517*^9}, {3.705050538661942*^9, 
   3.705050828062571*^9}, {3.7050509211784143`*^9, 3.7050514298080997`*^9}, {
   3.7050514760679398`*^9, 3.705051755566929*^9}, {3.705051838465683*^9, 
   3.705051914298758*^9}, {3.705051955609809*^9, 3.705052245432942*^9}, {
   3.705052461056903*^9, 3.705052472070561*^9}, {3.705052657717084*^9, 
   3.705052940968462*^9}, {3.705053003936029*^9, 3.705053005611548*^9}, {
   3.705053052114723*^9, 3.7050533826801*^9}, {3.705053421160487*^9, 
   3.705053463163862*^9}, {3.7050535150813913`*^9, 3.7050537702212667`*^9}, {
   3.70505380598884*^9, 3.70505388353298*^9}, {3.705053969256295*^9, 
   3.7050540895276546`*^9}, {3.705054200597645*^9, 3.705054234204956*^9}, {
   3.705054388667183*^9, 3.705054525375209*^9}, {3.705054653714521*^9, 
   3.7050546663609657`*^9}, {3.705055514981268*^9, 3.70505559175378*^9}, {
   3.705055799058687*^9, 3.7050558349610157`*^9}, {3.705057644509494*^9, 
   3.705057644948999*^9}, {3.705057691814453*^9, 3.7050577097749*^9}, {
   3.705058002367317*^9, 3.705058083387209*^9}, {3.705059120321846*^9, 
   3.705059122551374*^9}, 3.705061122663558*^9, {3.705121717204832*^9, 
   3.705121822367877*^9}, {3.705121876137659*^9, 3.705122023899249*^9}, {
   3.705122066158383*^9, 3.705122083581024*^9}, 3.70512246184326*^9, {
   3.70522956022797*^9, 3.7052297496633997`*^9}, 3.705233086850525*^9, {
   3.7053985710141916`*^9, 3.705398575607237*^9}, {3.705399259418619*^9, 
   3.7053992679152517`*^9}, 3.7053995516864696`*^9, {3.7068532576605496`*^9, 
   3.706853286936988*^9}, {3.70685846982327*^9, 3.7068584829559655`*^9}},
 ExpressionUUID -> "2480ef09-f672-4e8b-b1e3-cb342103ff33"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Section",
 CellChangeTimes->{{3.6937331169973345`*^9, 3.6937331202369833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "dimensionality", " ", "of", " ", "the", " ", "system"}], " ",
     "-", " ", 
    RowBox[{
    "3", " ", "or", " ", "2", " ", "supported", "                                 ",
      "Integer"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"dimensionality", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[HBar]", "/", "2"}], "m", " ", "for", " ", "particle", " ", 
     "mass", " ", "m", "                                                               ",
      "Real"}], "*)"}], 
   RowBox[{
    RowBox[{"\[Lambda]", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "time", " ", "step", " ", "of", " ", "the", " ", 
      "simulation"}], ",", " ", 
     RowBox[{
     "also", " ", "a", " ", "measure", " ", "of", " ", "inverse", " ", 
      "temperature", "                 ", "Real"}]}], "*)"}], 
   RowBox[{
    RowBox[{"\[Tau]", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Number", " ", "of", " ", 
      RowBox[{"beads", "/", "slices"}], " ", "per", " ", "particle"}], ";", 
     " ", 
     RowBox[{
     "more", " ", "lowers", " ", "the", " ", "temperature", "                    ",
       "Integer"}]}], "*)"}], 
   RowBox[{
    RowBox[{"slices", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "particles", " ", "to", " ", "include", " ", 
     "in", " ", "the", " ", "simulation", "                                    ",
      "Integer"}], "*)"}], 
   RowBox[{
    RowBox[{"numparticles", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "steps", " ", "to", " ", "run", " ", "the", " ",
      "simulation", " ", "for", "                                           ",
      "Integer"}], "*)"}], 
   RowBox[{
    RowBox[{"numsteps", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "steps", " ", "to", " ", "take", " ", "between",
      " ", "calculating", " ", "observables", "                             ",
      "Integer"}], "*)"}], 
   RowBox[{
    RowBox[{"observablecalc", "=", "200"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "steps", " ", "to", " ", "take", " ", "to", " ",
      "equilibrate", " ", "before", " ", "starting", " ", "calculating", " ", 
     "observables", "      ", "Integer"}], "*)"}], 
   RowBox[{
    RowBox[{"equilibrationsteps", "=", "2000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Smoothing", " ", "lengths", " ", "to", " ", "use", " ", "on", " ", 
     "plots", "                                            ", "Array", " ", 
     "of", " ", "reals"}], "*)"}], 
   RowBox[{
    RowBox[{"binsize", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.05", ",", "0.025", ",", "0.0125"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Maximum", " ", "number", " ", "of", " ", "particles", " ", "to", " ", 
     "try", " ", "permuting", " ", "at", " ", "once", "                                ",
      "Integer"}], "*)"}], 
   RowBox[{
    RowBox[{"maxcyclelength", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "estimators", " ", "for", 
     " ", "the", " ", "energy", "                                      ", 
     "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"calculateEnergy", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "the", " ", "thermodynamic", 
     " ", "estimator", " ", "for", " ", "the", " ", "energy", " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "recommended"}], ")"}], "   ", "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"energyTherm", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "the", " ", "virial", " ", 
     "estimator", " ", "for", " ", "the", " ", "energy", " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "recommended"}], ")"}], "          ", "Boolean"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"energyVirial", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "a", " ", "better", " ", 
     "virial", " ", "estimator", " ", "for", " ", "the", " ", "energy", " ", 
     RowBox[{"(", "recommended", ")"}], "         ", "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"energyFullVirial", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "the", " ", "Heinze", " ", 
     "estimator", " ", "for", " ", "the", " ", "energy", " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "recommended"}], ")"}], "          ", "Boolean"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"energyHeinze", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "the", " ", "particle", " ", 
     "density", "                                           ", "Boolean"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"calculateParticleDensity", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Whether", " ", "to", " ", "calculate", " ", "the", " ", "density"}], 
     "-", 
     RowBox[{"density", " ", 
      RowBox[{"(", "pair", ")"}], " ", "correlation", " ", "function", "                ",
       "Boolean"}]}], "*)"}], 
   RowBox[{
    RowBox[{"calculatePairCorrelationFunction", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "draw", " ", "3", "D", " ", "plot", " ", "of", 
     " ", "observables", " ", 
     RowBox[{"(", "slow", ")"}], "                                       ", 
     "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"allow3DCorrelationPlots", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "How", " ", "many", " ", "samples", " ", "to", " ", "use", " ", "for", 
     " ", "each", " ", "direction", " ", "in", " ", "3", "D", " ", "plots", "                              ",
      "Integer"}], "*)"}], 
   RowBox[{
    RowBox[{"plotPoints3D", "=", "30"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "compare", " ", "results", " ", "to", " ", 
     "those", " ", "from", " ", "a", " ", "single", " ", "particle", " ", 
     "in", " ", "an", " ", "harmonic", " ", "trap", "      ", "Boolean"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"harmonictrap", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "and", " ", "show", " ", 
     "the", " ", "autocorrelation", " ", "in", " ", "the", " ", "energy", "                     ",
      "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"showAutocorrelation", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "show", " ", "plots", " ", "of", " ", "sample",
      " ", "configurations", " ", "of", " ", "particles", "                         ",
      "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"showPaths", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "to", " ", "calculate", " ", "the", " ", "fraction", " ", 
     "of", " ", "particles", " ", "sitting", " ", "on", " ", "the", " ", 
     "same", " ", "lattice", " ", "site", "     ", "Boolean"}], "*)"}], 
   RowBox[{
    RowBox[{"calculateFracSameWell", "=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "frequency", " ", "used", " ", "for", " ", "comparison", " ", 
      "harmonic", " ", "traps"}], ",", " ", 
     RowBox[{
     "or", " ", "in", " ", "the", " ", "external", " ", "potential", "           ",
       "Real"}]}], "*)"}], 
   RowBox[{
    RowBox[{"\[Omega]", "=", "1."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Range", " ", "over", " ", "which", " ", "to", " ", "look", " ", "for", 
     " ", "minima", " ", "to", " ", "start", " ", "the", " ", "particles", 
     " ", "in", "                          ", "Real"}], "*)"}], 
   RowBox[{
    RowBox[{"startingRange", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Sample", " ", "spacing", " ", "for", " ", "identifying", " ", "minima", 
     " ", "to", " ", "start", " ", "the", " ", "particles", " ", "in", "                        ",
      "Real"}], "*)"}], 
   RowBox[{
    RowBox[{"startingDelta", "=", "0.05"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6937331388177385`*^9, 3.693733139026889*^9}, {
   3.6937332833892355`*^9, 3.693733284534817*^9}, {3.6937360662274714`*^9, 
   3.693736067450225*^9}, {3.6937370883899565`*^9, 3.6937370910683284`*^9}, 
   3.693739225765199*^9, 3.693739935389353*^9, 3.6937401753641114`*^9, 
   3.6937406779823613`*^9, 3.693740716389656*^9, {3.693740973828511*^9, 
   3.6937409762611475`*^9}, {3.693741158281137*^9, 3.693741158725572*^9}, {
   3.6937412957814765`*^9, 3.6937413232221355`*^9}, 3.6937429706186476`*^9, 
   3.693743116670851*^9, 3.6937432279077215`*^9, 3.69374377664627*^9, 
   3.693744082388966*^9, {3.6937449209404073`*^9, 3.6937449229567375`*^9}, {
   3.6937450377144337`*^9, 3.6937450394610753`*^9}, 3.693745345529408*^9, {
   3.6937459093101664`*^9, 3.6937459126769314`*^9}, 3.693746159125739*^9, 
   3.6937463958959885`*^9, 3.693747037359083*^9, 3.6937479408879895`*^9, 
   3.693748001453699*^9, 3.6937480903747807`*^9, {3.6937481989092436`*^9, 
   3.6937481991019745`*^9}, 3.693748505412053*^9, {3.693894024572444*^9, 
   3.69389404011594*^9}, {3.693894233910152*^9, 3.6938942406616697`*^9}, {
   3.6938950481713715`*^9, 3.693895048622581*^9}, {3.6938951584207845`*^9, 
   3.6938951619241157`*^9}, 3.693895727872303*^9, 3.6938986866783204`*^9, {
   3.69389881238988*^9, 3.693898816095707*^9}, 3.6938999543588057`*^9, 
   3.6943481938962417`*^9, 3.6943482732887087`*^9, {3.694349305643404*^9, 
   3.69434930602777*^9}, 3.6943523545206947`*^9, 3.6943527614538655`*^9, 
   3.694588045256811*^9, 3.694589058608446*^9, 3.694589130380195*^9, 
   3.6945892352357454`*^9, {3.6945896512670393`*^9, 3.694589655559357*^9}, 
   3.694590776951627*^9, {3.6945908224336405`*^9, 3.69459082511539*^9}, 
   3.694797647449039*^9, 3.694798352408825*^9, {3.6947984242105484`*^9, 
   3.694798424483781*^9}, 3.6947991589581137`*^9, 3.694800618772274*^9, 
   3.6948008922166567`*^9, 3.694800953696253*^9, {3.69480100194667*^9, 
   3.69480100817398*^9}, 3.6948010630065737`*^9, {3.694801108885538*^9, 
   3.694801109600706*^9}, {3.694801158167662*^9, 3.694801159980093*^9}, {
   3.6948012756000304`*^9, 3.6948012815755897`*^9}, {3.69495836686907*^9, 
   3.694958367110878*^9}, {3.694958425323821*^9, 3.6949584256167846`*^9}, {
   3.694958524436015*^9, 3.694958524707364*^9}, {3.694958637246316*^9, 
   3.694958637397664*^9}, {3.69538165536034*^9, 3.695381658590647*^9}, {
   3.695381792406124*^9, 3.6953818228108864`*^9}, {3.6953818890975685`*^9, 
   3.695381890973747*^9}, 3.6953826235542817`*^9, {3.6953837227322373`*^9, 
   3.6953837244354753`*^9}, 3.6953847097388315`*^9, 3.69538537882762*^9, 
   3.6953854668109417`*^9, {3.6953863007823687`*^9, 3.695386304232047*^9}, 
   3.695386497543458*^9, {3.695386689171892*^9, 3.695386691954546*^9}, {
   3.6955445086251636`*^9, 3.69554453799085*^9}, 3.6955447702759953`*^9, {
   3.6955448027199583`*^9, 3.6955448030786347`*^9}, {3.695544876822039*^9, 
   3.6955448786360073`*^9}, 3.695550382100727*^9, {3.6955506841209097`*^9, 
   3.695550685715621*^9}, {3.6955537633483095`*^9, 3.695553765224779*^9}, {
   3.695554012416082*^9, 3.69555401386585*^9}, {3.6955544149927025`*^9, 
   3.6955544188010287`*^9}, {3.6955545580098834`*^9, 
   3.6955545594417906`*^9}, {3.6955557311674557`*^9, 3.695555736785798*^9}, {
   3.69555579083848*^9, 3.695555797290474*^9}, {3.6955558583101916`*^9, 
   3.6955558602880063`*^9}, {3.695555903201682*^9, 3.6955559056934414`*^9}, {
   3.6955559827440243`*^9, 3.6955559844116735`*^9}, {3.695556022768589*^9, 
   3.6955560248299327`*^9}, {3.6955565650935926`*^9, 
   3.6955565652777853`*^9}, {3.695557189141864*^9, 3.695557192288579*^9}, 
   3.695557533572627*^9, 3.6955575929641013`*^9, {3.6955576463310933`*^9, 
   3.6955576479103208`*^9}, 3.6955577281815085`*^9, {3.6955577847201853`*^9, 
   3.695557784946845*^9}, 3.69555826864604*^9, {3.6955589295518465`*^9, 
   3.6955589400339947`*^9}, 3.695559004099691*^9, {3.6955590440382056`*^9, 
   3.6955590444127812`*^9}, {3.6967444139293227`*^9, 
   3.6967444144672003`*^9}, {3.69674492663957*^9, 3.6967449272600822`*^9}, 
   3.696746767649418*^9, {3.6967468718391094`*^9, 3.6967468755863285`*^9}, {
   3.6967474496163993`*^9, 3.6967474527617855`*^9}, {3.6967478803361506`*^9, 
   3.696747880798601*^9}, 3.696749388800146*^9, {3.696749425720195*^9, 
   3.6967494258372965`*^9}, {3.696749471811097*^9, 3.696749473666374*^9}, {
   3.696749527936478*^9, 3.6967495333345585`*^9}, 3.696750264295827*^9, {
   3.6967504612867746`*^9, 3.6967504615943947`*^9}, {3.696750538215513*^9, 
   3.6967505386083713`*^9}, {3.6967508252556567`*^9, 
   3.6967508319459095`*^9}, {3.696750987827993*^9, 3.696750988421243*^9}, {
   3.696751083713664*^9, 3.6967510841744547`*^9}, 3.6967516274352293`*^9, 
   3.696751722277431*^9, {3.696751817029714*^9, 3.6967518173652735`*^9}, {
   3.696751928491053*^9, 3.69675193004537*^9}, {3.6967528472765937`*^9, 
   3.6967528504847393`*^9}, {3.6967536044176455`*^9, 3.696753604807851*^9}, {
   3.696756640145387*^9, 3.696756644325045*^9}, {3.6967577331594696`*^9, 
   3.6967577368972836`*^9}, {3.6967579668218355`*^9, 3.6967579670949106`*^9}, 
   3.6967583250612144`*^9, {3.696758356029213*^9, 3.696758356581057*^9}, {
   3.6967613166979733`*^9, 3.696761323057467*^9}, 3.696761509921594*^9, {
   3.6967615565283337`*^9, 3.6967615566609526`*^9}, {3.6967615969877043`*^9, 
   3.6967615973005037`*^9}, 3.696761637826914*^9, 3.6967617429238176`*^9, {
   3.696761808588912*^9, 3.6967618092585707`*^9}, {3.6967619651548767`*^9, 
   3.6967619663669558`*^9}, {3.696762040257596*^9, 3.696762043283732*^9}, {
   3.6967622728367805`*^9, 3.696762275474764*^9}, {3.6967623115037575`*^9, 
   3.6967623136189766`*^9}, {3.696762491499521*^9, 3.6967624919869504`*^9}, {
   3.6967627456485124`*^9, 3.696762745895651*^9}, {3.6967628092028217`*^9, 
   3.6967628094351025`*^9}, {3.6967630951161766`*^9, 3.696763100568681*^9}, {
   3.6967635874699*^9, 3.696763588240705*^9}, 3.697029453339182*^9, 
   3.697029511930584*^9, {3.6970297056445217`*^9, 3.6970297063026023`*^9}, {
   3.697029752862089*^9, 3.697029752959646*^9}, 3.6970298476065717`*^9, {
   3.697030126781513*^9, 3.6970301306679535`*^9}, {3.6970301721092715`*^9, 
   3.697030177781302*^9}, 3.697030209322007*^9, 3.6970302571958528`*^9, {
   3.6970302942826633`*^9, 3.697030294404745*^9}, 3.697030331440424*^9, {
   3.6970303820771646`*^9, 3.697030382247305*^9}, {3.6970304401403246`*^9, 
   3.697030440403122*^9}, {3.6970304956197243`*^9, 3.697030495823454*^9}, {
   3.6970305626749673`*^9, 3.6970305630057373`*^9}, {3.697030638183161*^9, 
   3.6970306386248407`*^9}, {3.6970307237734985`*^9, 3.6970307241188173`*^9}, 
   3.697031902331319*^9, {3.697032020002879*^9, 3.697032022020295*^9}, {
   3.6970320845223193`*^9, 3.697032084664488*^9}, 3.6970321269452715`*^9, {
   3.6970321700316677`*^9, 3.697032170176264*^9}, {3.69703221936464*^9, 
   3.697032219556361*^9}, {3.697032274397169*^9, 3.6970322745885305`*^9}, {
   3.6970323326621284`*^9, 3.6970323330002303`*^9}, {3.697032393423231*^9, 
   3.6970323938391294`*^9}, {3.6970324551252737`*^9, 3.697032455526127*^9}, {
   3.6970325241657286`*^9, 3.6970325245460615`*^9}, {3.697032682663473*^9, 
   3.697032684219529*^9}, {3.697032717071336*^9, 3.6970327172534876`*^9}, {
   3.697032762350007*^9, 3.69703276255768*^9}, {3.6970328039411745`*^9, 
   3.697032804077793*^9}, {3.6970328526999855`*^9, 3.6970328529728537`*^9}, {
   3.697032899828477*^9, 3.6970328999561043`*^9}, {3.697032948099091*^9, 
   3.697032948461976*^9}, {3.6970329976971045`*^9, 3.697032998101841*^9}, {
   3.6970330457988815`*^9, 3.6970330461521797`*^9}, {3.6970330956898828`*^9, 
   3.6970330960627537`*^9}, {3.697033173501691*^9, 3.6970331749270325`*^9}, {
   3.6970332096911287`*^9, 3.69703320991582*^9}, {3.6970332463484397`*^9, 
   3.6970332466695514`*^9}, {3.6970332894398565`*^9, 3.69703328965407*^9}, {
   3.6970333337100573`*^9, 3.6970333340164356`*^9}, {3.697033382580427*^9, 
   3.697033382836265*^9}, {3.6970334283339577`*^9, 3.697033428679847*^9}, {
   3.697033473023203*^9, 3.697033473431633*^9}, {3.69703351687022*^9, 
   3.6970335172335057`*^9}, {3.697033560193035*^9, 3.697033560560972*^9}, {
   3.6970336528959994`*^9, 3.697033654149811*^9}, {3.697033689409953*^9, 
   3.697033689545542*^9}, {3.697033744485942*^9, 3.697033744755095*^9}, {
   3.697033792483801*^9, 3.6970337927069287`*^9}, {3.6970338368781157`*^9, 
   3.6970338371333313`*^9}, {3.6970338935946665`*^9, 
   3.6970338937032604`*^9}, {3.6970339418162365`*^9, 3.697033942183768*^9}, {
   3.697033982956128*^9, 3.6970339833928227`*^9}, {3.6970340231143355`*^9, 
   3.6970340235010834`*^9}, {3.6970340650871964`*^9, 3.69703406543286*^9}, {
   3.6971895835659847`*^9, 3.6971895873803344`*^9}, {3.697189660967038*^9, 
   3.697189661319571*^9}, {3.6971896994025373`*^9, 3.6971896995967216`*^9}, {
   3.697189749077219*^9, 3.697189749137759*^9}, {3.697189805246561*^9, 
   3.697189805529478*^9}, {3.6971898848976707`*^9, 3.6971898853860826`*^9}, {
   3.6971900018370905`*^9, 3.6971900022156153`*^9}, {3.6971901933170943`*^9, 
   3.6971901948452916`*^9}, {3.697190230753907*^9, 3.697190230857544*^9}, {
   3.697190274086996*^9, 3.6971902742787504`*^9}, {3.697190327032173*^9, 
   3.6971903272629604`*^9}, {3.6971904038884315`*^9, 
   3.6971904042807865`*^9}, {3.697190492329398*^9, 3.6971904926601796`*^9}, {
   3.6971906176516476`*^9, 3.697190619030652*^9}, {3.69719065780056*^9, 
   3.697190657984373*^9}, {3.697190712349805*^9, 3.69719071253209*^9}, {
   3.6971907613471036`*^9, 3.697190761563367*^9}, {3.697190822151843*^9, 
   3.6971908224680233`*^9}, {3.6971909005547194`*^9, 
   3.6971909009047956`*^9}, {3.6971910845196114`*^9, 3.697191127021881*^9}, {
   3.697191501088607*^9, 3.697191507587661*^9}, {3.6971916733185873`*^9, 
   3.6971916737090282`*^9}, {3.6971919056496477`*^9, 
   3.6971919060381956`*^9}, {3.6971922750329304`*^9, 3.69719227558881*^9}, {
   3.6971929515166645`*^9, 3.6971929591560574`*^9}, {3.697193298785714*^9, 
   3.697193298873144*^9}, {3.69719334947374*^9, 3.6971933545437565`*^9}, 
   3.6971934862601457`*^9, {3.6971936088600993`*^9, 3.6971936103470926`*^9}, 
   3.6971937492422037`*^9, {3.6971938501568794`*^9, 3.6971938509366655`*^9}, {
   3.697193940418167*^9, 3.697193940522246*^9}, 3.6971940299943094`*^9, {
   3.6976342117998247`*^9, 3.6976342162759843`*^9}, {3.697634265258328*^9, 
   3.697634265805504*^9}, {3.69813908518324*^9, 3.698139085594516*^9}, {
   3.6981392985079274`*^9, 3.698139303438204*^9}, {3.6981393922972765`*^9, 
   3.6981394217598658`*^9}, {3.698139463360999*^9, 3.698139479593788*^9}, {
   3.6981395307908263`*^9, 3.6981395393915434`*^9}, 3.6981397408643436`*^9, {
   3.698139827588173*^9, 3.698139827736272*^9}, {3.6981497352185407`*^9, 
   3.6981497390858965`*^9}, {3.698152103128186*^9, 3.6981521096900325`*^9}, {
   3.6981521677085066`*^9, 3.6981521744004445`*^9}, 3.6981522224125767`*^9, 
   3.6981522761597166`*^9, {3.6981530693128967`*^9, 3.6981530760332227`*^9}, 
   3.698153214450403*^9, {3.69832970245444*^9, 3.6983297029928527`*^9}, {
   3.6983299554251766`*^9, 3.698329955552637*^9}, 3.698330095855733*^9, {
   3.6983302131908083`*^9, 3.698330215843128*^9}, 3.698330830184*^9, {
   3.6983313306654215`*^9, 3.698331340869032*^9}, 3.6983314186666765`*^9, {
   3.6983315019514065`*^9, 3.698331502122714*^9}, 3.698744493925744*^9, 
   3.698744734170614*^9, 3.69874486991755*^9, {3.698745871705139*^9, 
   3.698745894512761*^9}, {3.6987463846784034`*^9, 3.698746408765179*^9}, {
   3.6987508282845755`*^9, 3.698750831048795*^9}, {3.69875088140547*^9, 
   3.6987508893356504`*^9}, {3.6987509959455557`*^9, 3.6987510188783317`*^9}, 
   3.698751087741351*^9, {3.6987515007729993`*^9, 3.698751512688167*^9}, 
   3.6987515505667624`*^9, 3.6987515814314547`*^9, {3.698751627979062*^9, 
   3.698751635755144*^9}, {3.6987516893410745`*^9, 3.698751691971244*^9}, {
   3.6987518121413918`*^9, 3.6987518139302015`*^9}, {3.698752118825303*^9, 
   3.6987521222693496`*^9}, 3.6987522994302435`*^9, 3.698752509355153*^9, {
   3.698752589967723*^9, 3.6987525908686843`*^9}, {3.6987527440369997`*^9, 
   3.6987527443420315`*^9}, 3.6987532053463364`*^9, {3.698753296990243*^9, 
   3.698753297265741*^9}, {3.698753409255025*^9, 3.698753409668661*^9}, 
   3.698753828379583*^9, 3.6987541680446415`*^9, 3.6987542715942492`*^9, {
   3.6987552645964923`*^9, 3.6987552762801332`*^9}, {3.6987573843903384`*^9, 
   3.698757394450918*^9}, {3.698758412369356*^9, 3.6987584164901977`*^9}, {
   3.6987587479617653`*^9, 3.698758785046522*^9}, 3.6987590385750904`*^9, 
   3.698759383417911*^9, {3.698759790126482*^9, 3.6987597948236656`*^9}, {
   3.698996740505371*^9, 3.6989967447362404`*^9}, 3.698996794301648*^9, 
   3.698997203666439*^9, 3.698997236814001*^9, {3.698997434122922*^9, 
   3.698997434354698*^9}, {3.6990004190356474`*^9, 3.699000422097728*^9}, 
   3.699000659681285*^9, {3.699000814531087*^9, 3.699000824343539*^9}, {
   3.6990014243534527`*^9, 3.699001487402882*^9}, {3.699001598467531*^9, 
   3.6990016015055275`*^9}, {3.699001633663082*^9, 3.6990016372540784`*^9}, {
   3.6990017150374107`*^9, 3.6990017152876525`*^9}, {3.699001906895027*^9, 
   3.699001907204932*^9}, {3.6990022100057616`*^9, 3.6990022238176413`*^9}, {
   3.69900229215973*^9, 3.699002294006133*^9}, {3.6990024287508335`*^9, 
   3.699002439563838*^9}, {3.699002487937654*^9, 3.6990024880202107`*^9}, {
   3.6990026777629166`*^9, 3.699002685601329*^9}, 3.699002725325696*^9, {
   3.6990028722380548`*^9, 3.6990028771646476`*^9}, 3.6990029290355473`*^9, 
   3.699002984096717*^9, {3.6990033033876176`*^9, 3.6990033074587774`*^9}, 
   3.699003343030773*^9, 3.699004358429119*^9, {3.6990044280808043`*^9, 
   3.6990044294085836`*^9}, 3.6990045987898936`*^9, {3.699004658251053*^9, 
   3.6990046724882927`*^9}, 3.69900477349995*^9, {3.699004881496148*^9, 
   3.69900488361761*^9}, 3.699004994998211*^9, 3.69900506304559*^9, 
   3.6990051284300065`*^9, 3.69900517993107*^9, {3.699005236260259*^9, 
   3.699005236367456*^9}, {3.69900530625499*^9, 3.699005308306492*^9}, 
   3.6990054235337763`*^9, 3.699005536871122*^9, {3.6990056276004725`*^9, 
   3.6990056278908405`*^9}, 3.6990057502160854`*^9, {3.6990059513700705`*^9, 
   3.6990059566209583`*^9}, 3.699006113400688*^9, 3.6990061817121215`*^9, 
   3.6990062344989147`*^9, {3.699006505748891*^9, 3.699006507638191*^9}, 
   3.699010582924763*^9, {3.699016687879484*^9, 3.6990166935210695`*^9}, 
   3.6990168051358624`*^9, {3.6990170265270443`*^9, 3.69901702671955*^9}, 
   3.6990171382290516`*^9, {3.6990171874735947`*^9, 3.699017189893998*^9}, {
   3.6990174067120667`*^9, 3.6990174087717915`*^9}, 3.699017545559846*^9, 
   3.699020262280854*^9, {3.6990214385386047`*^9, 3.69902144088086*^9}, {
   3.699022008858091*^9, 3.699022011597233*^9}, {3.6990282351788235`*^9, 
   3.699028236571926*^9}, {3.69902826968281*^9, 3.69902827105823*^9}, {
   3.699028635998371*^9, 3.699028637651905*^9}, 3.6990287091312184`*^9, 
   3.6990287541784916`*^9, {3.699029001238958*^9, 3.6990290039806714`*^9}, 
   3.699029401367228*^9, {3.699029997362481*^9, 3.699030004156178*^9}, {
   3.6990301501984572`*^9, 3.699030152183363*^9}, 3.699030211695662*^9, 
   3.6990302695974045`*^9, {3.6990303486066027`*^9, 3.6990303487888656`*^9}, {
   3.699191646484806*^9, 3.6991916518762217`*^9}, 3.69919171789645*^9, {
   3.6991919464250045`*^9, 3.699191947795704*^9}, 3.6991921006622677`*^9, {
   3.6993490968508596`*^9, 3.6993490979406967`*^9}, {3.699693271157935*^9, 
   3.699693301686164*^9}, 3.699693893304648*^9, 3.6996941145967283`*^9, 
   3.699694651813818*^9, 3.6996966767977705`*^9, {3.6996971022034006`*^9, 
   3.6996971034614964`*^9}, 3.699697374401292*^9, {3.699697615293935*^9, 
   3.6996976221741323`*^9}, {3.700201150995579*^9, 3.700201151036096*^9}, {
   3.70020119523858*^9, 3.7002011975687685`*^9}, {3.7002026375191574`*^9, 
   3.700202647008342*^9}, {3.700202817514259*^9, 3.700202824229949*^9}, 
   3.7002029046884937`*^9, {3.700202981902598*^9, 3.7002029882616744`*^9}, 
   3.7002030894533806`*^9, {3.7002032412487803`*^9, 3.7002032480822372`*^9}, 
   3.7002034324381275`*^9, {3.700203807467642*^9, 3.700203807772649*^9}, 
   3.700204282631538*^9, 3.7002052264870534`*^9, 3.7002057454491396`*^9, {
   3.7002057896588306`*^9, 3.7002057931419196`*^9}, {3.700205992458728*^9, 
   3.7002060007729406`*^9}, 3.7002067260994015`*^9, {3.7002068048588037`*^9, 
   3.700206807513857*^9}, 3.7002079133545218`*^9, {3.700208113238386*^9, 
   3.7002081162835183`*^9}, {3.700211550478795*^9, 3.7002115507308397`*^9}, {
   3.700211690339667*^9, 3.7002116926509867`*^9}, 3.700211875347393*^9, 
   3.700211984471755*^9, {3.7002121041329355`*^9, 3.7002121043388634`*^9}, 
   3.7002123364256506`*^9, {3.7002126006842403`*^9, 3.7002126012997*^9}, {
   3.700213218435546*^9, 3.7002132230169797`*^9}, {3.700213442992633*^9, 
   3.7002134431303215`*^9}, 3.7002140853108644`*^9, {3.7002142865776296`*^9, 
   3.70021428793442*^9}, 3.700233598015523*^9, {3.7002336596156406`*^9, 
   3.7002336670540185`*^9}, {3.7002337756361055`*^9, 
   3.7002337781363688`*^9}, {3.701081913368635*^9, 3.7010819147908506`*^9}, {
   3.7010843754795356`*^9, 3.701084381745804*^9}, {3.701086540957855*^9, 
   3.701086542679965*^9}, 3.7010871105172763`*^9, {3.701087468231577*^9, 
   3.7010874750030107`*^9}, {3.701087542482891*^9, 3.701087542760229*^9}, 
   3.701087604810808*^9, {3.7010876734624643`*^9, 3.701087676145029*^9}, {
   3.7010879023751497`*^9, 3.7010879078752007`*^9}, {3.7010879520266075`*^9, 
   3.701087952817851*^9}, {3.701088085908478*^9, 3.7010880952106085`*^9}, {
   3.7010881636741605`*^9, 3.701088167248187*^9}, 3.7010885977039227`*^9, 
   3.7010891472945485`*^9, {3.701089263228487*^9, 3.7010892641064415`*^9}, {
   3.7010893746642876`*^9, 3.7010893748635*^9}, {3.701089517092874*^9, 
   3.7010895172094507`*^9}, {3.701089684763814*^9, 3.701089684955157*^9}, {
   3.701089899010242*^9, 3.7010899038866615`*^9}, 3.701089963358378*^9, {
   3.7010900519604673`*^9, 3.701090054870202*^9}, {3.7010901200554523`*^9, 
   3.701090122916941*^9}, 3.7010901535257597`*^9, 3.701090220467561*^9, 
   3.701090616707163*^9, {3.7010908352291145`*^9, 3.701090877957926*^9}, {
   3.7012610670431967`*^9, 3.7012610675504446`*^9}, {3.701261099675404*^9, 
   3.701261111037816*^9}, {3.701261441335913*^9, 3.701261447669975*^9}, 
   3.701261927944665*^9, {3.70126255862986*^9, 3.701262559590467*^9}, {
   3.701942778113147*^9, 3.701942778503922*^9}, {3.701946681893362*^9, 
   3.701946697803239*^9}, 3.701946958788245*^9, 3.701948774375065*^9, {
   3.701948924230877*^9, 3.7019489256836143`*^9}, {3.7019491876252966`*^9, 
   3.701949196505308*^9}, 3.7019496036371913`*^9, {3.701949685861068*^9, 
   3.701949692176319*^9}, {3.7019498167937965`*^9, 3.701949817357559*^9}, {
   3.702374422587672*^9, 3.702374463703593*^9}, {3.7023746322679377`*^9, 
   3.702374652052091*^9}, {3.7023768064399796`*^9, 3.702376816210408*^9}, {
   3.702377558568325*^9, 3.7023775586118207`*^9}, {3.7023789099847827`*^9, 
   3.702378942360489*^9}, 3.70237917453977*^9, {3.70237938668806*^9, 
   3.702379393046646*^9}, {3.702379591714759*^9, 3.7023795941206455`*^9}, {
   3.702379947371937*^9, 3.702379950542096*^9}, {3.70238046835777*^9, 
   3.70238047396177*^9}, {3.7023807521753373`*^9, 3.702380759440286*^9}, {
   3.70238084823983*^9, 3.702380850883783*^9}, {3.702381020796388*^9, 
   3.702381023185278*^9}, {3.7023813493213673`*^9, 3.702381358662507*^9}, {
   3.702381665487154*^9, 3.7023816697209754`*^9}, 3.7023817697697*^9, {
   3.7023820165973744`*^9, 3.7023820166964397`*^9}, 3.702382614820781*^9, {
   3.702382778294631*^9, 3.7023827819896727`*^9}, {3.70238297991847*^9, 
   3.702383002122351*^9}, {3.702383188696458*^9, 3.7023831967869315`*^9}, {
   3.7023833609297085`*^9, 3.702383362553586*^9}, {3.702384424119054*^9, 
   3.702384427314805*^9}, 3.7023845470167904`*^9, {3.702390539843566*^9, 
   3.702390545129609*^9}, {3.702393618958791*^9, 3.7023936236321716`*^9}, 
   3.7023936824068284`*^9, 3.702394032705143*^9, 3.702394125765275*^9, {
   3.7023942800517626`*^9, 3.7023942895374107`*^9}, 3.702395767385085*^9, 
   3.702395906469969*^9, {3.7023959549605355`*^9, 3.702395958333288*^9}, {
   3.7023960454379845`*^9, 3.70239604775163*^9}, {3.70239624996115*^9, 
   3.702396255579364*^9}, {3.702396314866272*^9, 3.7023963154708824`*^9}, {
   3.7026560796514397`*^9, 3.7026561149969363`*^9}, {3.7026561714656286`*^9, 
   3.702656195739439*^9}, {3.702656229709262*^9, 3.7026562297798033`*^9}, 
   3.7026564113867583`*^9, {3.702656543356038*^9, 3.702656550969616*^9}, 
   3.7026565937679343`*^9, {3.7026569019687233`*^9, 3.7026569048183713`*^9}, 
   3.702656960554653*^9, 3.7026571862457943`*^9, {3.7026575158482113`*^9, 
   3.7026575319759893`*^9}, {3.7026575847549367`*^9, 
   3.7026575866794767`*^9}, {3.7026577767148085`*^9, 3.702657792788487*^9}, {
   3.702657933074335*^9, 3.7026579331819754`*^9}, 3.7026581446980543`*^9, {
   3.7026583669141583`*^9, 3.7026583778239975`*^9}, 3.7026584609701967`*^9, 
   3.7026586235017147`*^9, {3.7026587381284695`*^9, 3.7026587405460773`*^9}, 
   3.7026589907134223`*^9, {3.7026595128500104`*^9, 3.70265952809761*^9}, {
   3.7032330097343807`*^9, 3.7032330104738684`*^9}, {3.703233228799253*^9, 
   3.703233230407321*^9}, {3.703233437498907*^9, 3.703233439090272*^9}, {
   3.703233575866978*^9, 3.70323358314307*^9}, 3.7032337544921174`*^9, 
   3.703233895116845*^9, 3.703233991122247*^9, {3.703234085301499*^9, 
   3.7032340870913825`*^9}, 3.703234213034111*^9, {3.7032344414664764`*^9, 
   3.703234452963912*^9}, {3.7032346439485545`*^9, 3.7032346656188865`*^9}, {
   3.703235335449704*^9, 3.7032353545321355`*^9}, 3.703235946848981*^9, 
   3.7032364626574497`*^9, {3.70323667784184*^9, 3.7032366817709775`*^9}, {
   3.703236976843311*^9, 3.703236997324953*^9}, {3.703237233718914*^9, 
   3.703237234302532*^9}, 3.7032375719081774`*^9, {3.7032378729866548`*^9, 
   3.7032378793069973`*^9}, {3.7032383420167356`*^9, 3.703238345984079*^9}, 
   3.7032409245899773`*^9, {3.7032452791013794`*^9, 3.703245281011647*^9}, {
   3.7033958927040396`*^9, 3.7033958977183676`*^9}, {3.7033964220482583`*^9, 
   3.7033964314405017`*^9}, {3.7034003407770996`*^9, 
   3.7034003564775376`*^9}, {3.7034006071426864`*^9, 
   3.7034006077330785`*^9}, {3.7034006814240685`*^9, 
   3.7034007194613557`*^9}, {3.7034013241624417`*^9, 3.70340134303699*^9}, {
   3.7034023398154993`*^9, 3.703402357370711*^9}, 3.7034024769914947`*^9, {
   3.7034026549007626`*^9, 3.7034026553220253`*^9}, {3.703402801950502*^9, 
   3.7034028020060415`*^9}, {3.7034033719170065`*^9, 
   3.7034033887572694`*^9}, {3.7034051693750477`*^9, 3.7034051794993353`*^9}, 
   3.7034059301672525`*^9, {3.7034062354083223`*^9, 3.703406236124798*^9}, 
   3.7034089270119476`*^9, {3.703409118272954*^9, 3.7034091202292557`*^9}, 
   3.7034092996478434`*^9, {3.7034106576911783`*^9, 3.703410669695652*^9}, 
   3.7034114071510096`*^9, {3.7034151478415403`*^9, 3.7034151589369164`*^9}, {
   3.703417735581423*^9, 3.7034177356944942`*^9}, {3.703417948892229*^9, 
   3.7034179962827325`*^9}, {3.7034218664610014`*^9, 3.7034218715473833`*^9}, 
   3.70342246350093*^9, {3.7034251223149443`*^9, 3.703425122486058*^9}, 
   3.703427140597582*^9, {3.7034290058198977`*^9, 3.70342900788827*^9}, {
   3.7034298189106293`*^9, 3.7034298214081078`*^9}, {3.703830522240932*^9, 
   3.703830522575777*^9}, {3.703831537209992*^9, 3.703831537496584*^9}, 
   3.70383335369738*^9, {3.703835563289576*^9, 3.703835567365624*^9}, {
   3.703838112799781*^9, 3.703838115490677*^9}, {3.703838190850218*^9, 
   3.703838191065487*^9}, {3.703840224922421*^9, 3.703840225251786*^9}, {
   3.7038436369322367`*^9, 3.70384363733186*^9}, 3.703845539601265*^9, {
   3.7038489471436462`*^9, 3.7038489649722853`*^9}, 3.703849006318081*^9, {
   3.703912525027234*^9, 3.703912532067916*^9}, {3.703915220753434*^9, 
   3.703915253291285*^9}, {3.703918249720064*^9, 3.7039182516435747`*^9}, 
   3.703924962359604*^9, {3.7039249938251247`*^9, 3.703925035370225*^9}, 
   3.703925065627819*^9, 3.703925106412923*^9, 3.703925181731691*^9, {
   3.703925243874277*^9, 3.7039252910434713`*^9}, {3.703997746010208*^9, 
   3.703997778331341*^9}, {3.7039978819340267`*^9, 3.703997900758892*^9}, {
   3.703998003540901*^9, 3.703998027538669*^9}, {3.704003916349066*^9, 
   3.70400395103682*^9}, {3.704004045392439*^9, 3.704004046200774*^9}, {
   3.7044340612161407`*^9, 3.7044340735032377`*^9}, {3.70443470952711*^9, 
   3.704434714038301*^9}, 3.7044347942917337`*^9, {3.70443871530317*^9, 
   3.70443871561415*^9}, {3.704439103709791*^9, 3.704439110950922*^9}, {
   3.7044391442547503`*^9, 3.7044391448461933`*^9}, {3.704439187536683*^9, 
   3.704439192976788*^9}, {3.704439278564102*^9, 3.704439278888575*^9}, {
   3.7044397709108467`*^9, 3.704439778940887*^9}, {3.704439863122127*^9, 
   3.704439865057074*^9}, {3.704444584598383*^9, 3.704444610886566*^9}, 
   3.704444674073761*^9, 3.704455864366735*^9, {3.704457070366796*^9, 
   3.704457070803364*^9}, {3.704457195234992*^9, 3.704457212397402*^9}, {
   3.704517403886442*^9, 3.704517411510145*^9}, {3.704517627623633*^9, 
   3.704517628950345*^9}, {3.704517721362252*^9, 3.7045177236501017`*^9}, {
   3.704517925361969*^9, 3.7045179368978643`*^9}, {3.704518225725354*^9, 
   3.704518231013197*^9}, {3.7045238256254473`*^9, 3.704523825935602*^9}, {
   3.7045255853474293`*^9, 3.704525585615696*^9}, {3.704536600943068*^9, 
   3.704536602620921*^9}, 3.7045371042190113`*^9, {3.704537376445106*^9, 
   3.704537376768527*^9}, {3.704537853079875*^9, 3.704537871807488*^9}, {
   3.7045385129850187`*^9, 3.7045385166326427`*^9}, {3.7045387502899847`*^9, 
   3.7045387661380863`*^9}, 3.704539449485263*^9, {3.704539940583652*^9, 
   3.7045399409030323`*^9}, 3.704540469756422*^9, {3.704542525322082*^9, 
   3.7045425255356407`*^9}, {3.704543182531489*^9, 3.70454321128153*^9}, {
   3.704601943269874*^9, 3.704601949165552*^9}, 3.704604620412263*^9, {
   3.7046055509195013`*^9, 3.7046055556025543`*^9}, 3.704605587920834*^9, {
   3.704607851127489*^9, 3.704607873756175*^9}, {3.704609873308476*^9, 
   3.704609891036812*^9}, {3.704616549873831*^9, 3.704616605283174*^9}, {
   3.704629454449445*^9, 3.704629459553729*^9}, {3.704630278664838*^9, 
   3.7046302802445173`*^9}, {3.70463031617846*^9, 3.704630322658267*^9}, 
   3.704631201028019*^9, 3.704631337377026*^9, {3.70468979051077*^9, 
   3.704689799905774*^9}, {3.704691221884523*^9, 3.704691244309017*^9}, {
   3.704691599579232*^9, 3.704691599962676*^9}, 3.70469168729426*^9, 
   3.704693354981146*^9, {3.7046937649481363`*^9, 3.704693765058379*^9}, {
   3.704700087933152*^9, 3.70470009010876*^9}, 3.704701292509293*^9, {
   3.7047778072000685`*^9, 3.7047778174381156`*^9}, {3.7047778604823723`*^9, 
   3.704777895823805*^9}, {3.704777978201672*^9, 3.704777983501004*^9}, {
   3.704778030326185*^9, 3.7047780304091063`*^9}, {3.704778175873671*^9, 
   3.704778177957363*^9}, 3.7047782345985026`*^9, 3.704778334382628*^9, 
   3.7047784635447235`*^9, {3.7047787807976837`*^9, 3.7047788031245613`*^9}, 
   3.704778962296894*^9, {3.7047791359096413`*^9, 3.704779136015721*^9}, 
   3.704779332264782*^9, 3.704779430044217*^9, {3.704779536559391*^9, 
   3.7047795368479896`*^9}, {3.704779645295788*^9, 3.7047796454685082`*^9}, {
   3.7047797391354227`*^9, 3.7047797393455315`*^9}, {3.704779856041795*^9, 
   3.704779856381611*^9}, {3.704780081335151*^9, 3.7047800816580267`*^9}, {
   3.704780269303279*^9, 3.704780275687677*^9}, {3.7047804144664326`*^9, 
   3.7047804146911287`*^9}, {3.7047806062349076`*^9, 3.7047806063828325`*^9}, 
   3.704780723859193*^9, {3.7047808665762987`*^9, 3.7047808667204437`*^9}, {
   3.704780962630184*^9, 3.704780962758537*^9}, {3.7047810764284253`*^9, 
   3.7047810765595646`*^9}, {3.7047811654622097`*^9, 
   3.7047811657986803`*^9}, {3.704781363317314*^9, 3.7047813636046515`*^9}, {
   3.704781534290536*^9, 3.70478153453981*^9}, {3.7047816784639473`*^9, 
   3.7047816786652346`*^9}, {3.7047818422147865`*^9, 3.704781850819501*^9}, {
   3.7047819691947575`*^9, 3.7047819693840747`*^9}, {3.7047820836594977`*^9, 
   3.7047820838938847`*^9}, {3.704782186691894*^9, 3.7047821868325024`*^9}, {
   3.704782313124052*^9, 3.704782313342806*^9}, {3.704782397169977*^9, 
   3.704782397482006*^9}, {3.7047825918886905`*^9, 3.7047825922359405`*^9}, {
   3.70478274003214*^9, 3.704782740279689*^9}, {3.704782879418866*^9, 
   3.7047828796180906`*^9}, {3.7047830033283978`*^9, 3.704783003577258*^9}, {
   3.70478311708579*^9, 3.7047831172489333`*^9}, {3.704783221713707*^9, 
   3.7047832218489866`*^9}, {3.7047833264935417`*^9, 3.704783326663948*^9}, {
   3.704783440955801*^9, 3.7047834411324387`*^9}, {3.7047835549272366`*^9, 
   3.704783555242178*^9}, {3.7047837552578044`*^9, 3.704783755571458*^9}, {
   3.704783916956732*^9, 3.7047839172407236`*^9}, {3.7047843409755173`*^9, 
   3.704784341231241*^9}, {3.7047845103463078`*^9, 3.7047845105049715`*^9}, {
   3.7047846049377975`*^9, 3.704784605109517*^9}, {3.704784717503255*^9, 
   3.704784717669919*^9}, {3.704784855570901*^9, 3.7047848601052303`*^9}, {
   3.704784986981905*^9, 3.7047849871723456`*^9}, {3.704785111102163*^9, 
   3.7047851114173346`*^9}, {3.704785321299881*^9, 3.704785321620205*^9}, {
   3.704785524108233*^9, 3.704785524325508*^9}, {3.704785712018354*^9, 
   3.7047857177522097`*^9}, {3.704786017259304*^9, 3.7047860174621906`*^9}, {
   3.7047863519188113`*^9, 3.70478635209893*^9}, {3.704786681598973*^9, 
   3.7047866817620797`*^9}, {3.7047869227846346`*^9, 
   3.7047869229648213`*^9}, {3.704787139028165*^9, 3.7047871392058353`*^9}, {
   3.7047873129911933`*^9, 3.7047873131922793`*^9}, {3.7047875357234282`*^9, 
   3.7047875441192174`*^9}, {3.7047876631579685`*^9, 3.704787670772911*^9}, 
   3.7047877207642026`*^9, 3.7047877890422263`*^9, 3.704787839411392*^9, {
   3.7049619072182074`*^9, 3.7049619143599625`*^9}, {3.704962050861816*^9, 
   3.7049620911223793`*^9}, {3.7049621356031227`*^9, 3.704962136214531*^9}, 
   3.7049622528320866`*^9, 3.7049623318073997`*^9, 3.704962397875659*^9, 
   3.7049626428998995`*^9, {3.7049628117603545`*^9, 3.7049628118944764`*^9}, 
   3.7049628693098707`*^9, {3.704962954773162*^9, 3.704962956337907*^9}, 
   3.704963106222248*^9, {3.7050529607450027`*^9, 3.7050529624083767`*^9}, {
   3.705054341421483*^9, 3.7050543498608418`*^9}, 3.705054542845595*^9, 
   3.705054588631361*^9, {3.7050559426996183`*^9, 3.705055948411421*^9}, 
   3.70505682244471*^9, 3.705057024844914*^9, 3.705057489598783*^9, 
   3.70505818414329*^9, 3.7050586929010077`*^9, {3.7050591576193113`*^9, 
   3.705059190111299*^9}, {3.705059232873621*^9, 3.705059251833829*^9}, 
   3.7050594005054626`*^9, {3.705059954957622*^9, 3.705059964597599*^9}, {
   3.7050603317082787`*^9, 3.7050603349986887`*^9}, 3.705060731611683*^9, {
   3.705061138867313*^9, 3.7050611436510487`*^9}, {3.705121833504047*^9, 
   3.70512184418014*^9}, 3.705122117531014*^9, 3.705122548667491*^9, {
   3.70512326088629*^9, 3.705123261202326*^9}, {3.70512425030011*^9, 
   3.70512425728397*^9}, {3.705125392231409*^9, 3.705125399076353*^9}, {
   3.705127396844001*^9, 3.705127397179044*^9}, {3.705129326542171*^9, 
   3.705129327087446*^9}, {3.705131350955841*^9, 3.7051313742204*^9}, 
   3.7051322182773333`*^9, 3.705133169057869*^9, {3.705134021754592*^9, 
   3.7051340219814796`*^9}, {3.705135097745943*^9, 3.705135098213182*^9}, 
   3.705136311907392*^9, {3.705137313066247*^9, 3.705137336466202*^9}, {
   3.705138075599998*^9, 3.7051380769351387`*^9}, {3.705138304440608*^9, 
   3.705138319313169*^9}, 3.705142144044559*^9, 3.705143419389443*^9, {
   3.705145406817432*^9, 3.7051454069991426`*^9}, {3.7051476617437077`*^9, 
   3.705147662053444*^9}, 3.7052079985426683`*^9, 3.7052194160133753`*^9, 
   3.705221046107627*^9, {3.705222524364296*^9, 3.705222524593898*^9}, {
   3.705224998427866*^9, 3.7052249986662483`*^9}, 3.705227184711431*^9, 
   3.705229358347378*^9, 3.705230008956352*^9, 3.7052332008942204`*^9, 
   3.705293200671062*^9, {3.705296084284177*^9, 3.705296084579318*^9}, {
   3.705302992809577*^9, 3.7053029932621603`*^9}, 3.705307229746196*^9, 
   3.70530910153722*^9, 3.705311578414838*^9, {3.705315414591503*^9, 
   3.7053154148739347`*^9}, {3.705394191700184*^9, 3.705394198358985*^9}, {
   3.7053951140467815`*^9, 3.705395318438032*^9}, {3.7053972599457054`*^9, 
   3.705397672358137*^9}, {3.7053977166204796`*^9, 3.7053978313435793`*^9}, {
   3.705397977308811*^9, 3.7053979935205574`*^9}, {3.7053980885014687`*^9, 
   3.705398129445614*^9}, {3.7053981689528055`*^9, 3.7053981695482006`*^9}, {
   3.705398288508622*^9, 3.7053982887827983`*^9}, 3.70539836086959*^9, {
   3.705398425574483*^9, 3.70539843287032*^9}, {3.7053985114897327`*^9, 
   3.705398514512738*^9}, {3.705398555930192*^9, 3.7053985560432653`*^9}, {
   3.705399152748302*^9, 3.7053991751187363`*^9}, 3.7053992392732635`*^9, 
   3.7053993367198663`*^9, {3.7053996139577627`*^9, 3.7053996141458855`*^9}, {
   3.7053996735365353`*^9, 3.705399673853942*^9}, {3.705399747063103*^9, 
   3.7053997472575345`*^9}, 3.7053998006550007`*^9, 3.7053998694413304`*^9, 
   3.705399928267706*^9, 3.7054000116366563`*^9, 3.7054001078408375`*^9, 
   3.7054003423450146`*^9, {3.7054006410151324`*^9, 3.705400641207822*^9}, {
   3.7054008846234503`*^9, 3.7054008850314093`*^9}, {3.7054011036388054`*^9, 
   3.705401105516572*^9}, {3.7056619094568157`*^9, 3.7056619096689577`*^9}},
 ExpressionUUID -> "631fe070-b9d8-48f1-97d6-4641ae4498a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Potentials", "Section",
 CellChangeTimes->{{3.699694157505305*^9, 3.6996941608521156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "external", " ", "potential", " ", "for", " ", "particles", 
     " ", "to", " ", "move", " ", "in"}], ";", " ", 
    RowBox[{"acts", " ", "equally", " ", "on", " ", "all", " ", 
     RowBox[{"particles", ".", " ", "pos"}], " ", "is", " ", "position", " ", 
     "vector"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"extV", "[", "pos_", "]"}], ":=", 
     RowBox[{"0.5", 
      SuperscriptBox["\[Omega]", "2"], 
      RowBox[{"pos", ".", "pos"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "gradient", " ", "of", " ", "the", " ", "external", " ", 
     "potential"}], 
    "                                                                ", 
    "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"derivExtV", "[", "pos_", "]"}], ":=", 
     RowBox[{
      SuperscriptBox["\[Omega]", "2"], "pos"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "inter"}], "-", 
      RowBox[{"particle", " ", "potential"}]}], ",", " ", 
     RowBox[{
     "which", " ", "acts", " ", "equally", " ", "between", " ", "all", " ", 
      "pairs", " ", "of", " ", "particles"}]}], "                       ", 
    "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"intpartV", "[", 
      RowBox[{"pos1_", ",", "pos2_"}], "]"}], ":=", "0."}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "gradient", " ", "of", " ", "the", " ", "inter"}], 
      "-", 
      RowBox[{"particle", " ", "potential"}]}], ",", " ", 
     RowBox[{
     "differentiated", " ", "with", " ", "respect", " ", "to", " ", "the", 
      " ", "first", " ", "argument"}], ",", " ", "pos1"}], " ", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"derivIntpartV", "[", 
      RowBox[{"pos1_", ",", "pos2_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6996942534134502`*^9, 3.6996942924998975`*^9}, {
   3.699694383165087*^9, 3.699694383606414*^9}, {3.699694506302575*^9, 
   3.699694510253192*^9}, {3.700205457184452*^9, 3.7002055055477695`*^9}, {
   3.700205881087449*^9, 3.700205881255591*^9}, {3.700206943693565*^9, 
   3.700206944959982*^9}, {3.700207039248538*^9, 3.7002070446915684`*^9}, {
   3.7002116314164534`*^9, 3.7002116316156483`*^9}, {3.700233575340762*^9, 
   3.70023357665354*^9}, {3.7010873808631935`*^9, 3.7010873831754556`*^9}, {
   3.701089407071601*^9, 3.701089408348531*^9}, {3.70109003598357*^9, 
   3.7010900464268384`*^9}, {3.701942794771597*^9, 3.7019428046166534`*^9}, {
   3.7019490550641694`*^9, 3.7019490578050184`*^9}, {3.702384432559785*^9, 
   3.7023844787797976`*^9}, {3.7023845227355204`*^9, 3.702384527602166*^9}, {
   3.702384568974568*^9, 3.702384573495926*^9}, {3.7023847707159147`*^9, 
   3.7023848208665752`*^9}, {3.702385044910134*^9, 3.7023850475510216`*^9}, {
   3.702385259481651*^9, 3.7023852621856155`*^9}, {3.70239368828609*^9, 
   3.7023936884592056`*^9}, {3.7023940180653057`*^9, 3.70239402862786*^9}, {
   3.702656123284446*^9, 3.702656126226402*^9}, {3.7026596961697607`*^9, 
   3.702659744070037*^9}, {3.7032346036658893`*^9, 3.703234634547734*^9}, {
   3.703234679124138*^9, 3.703234686508774*^9}, {3.7032347220259748`*^9, 
   3.7032347390086412`*^9}, 3.703234847921909*^9, {3.703235000137334*^9, 
   3.7032350145991507`*^9}, {3.703235257016494*^9, 3.703235275630792*^9}, {
   3.7032356285205946`*^9, 3.7032356366521797`*^9}, {3.703235955760969*^9, 
   3.7032359559001217`*^9}, {3.703400612515258*^9, 3.703400626150323*^9}, {
   3.703400955220356*^9, 3.7034009596593103`*^9}, {3.703401938882657*^9, 
   3.703401945780187*^9}, {3.703401976544775*^9, 3.703402003941615*^9}, {
   3.7034026367740493`*^9, 3.7034026688654985`*^9}, {3.7034030505046234`*^9, 
   3.7034030527022495`*^9}, {3.703405546586994*^9, 3.7034055513026905`*^9}, {
   3.7034062155811443`*^9, 3.7034062293723087`*^9}, {3.703409489576912*^9, 
   3.7034094952596903`*^9}, {3.703409753489587*^9, 3.7034097582157307`*^9}, {
   3.7034141965272007`*^9, 3.7034142019476957`*^9}, {3.70341542512076*^9, 
   3.703415431075719*^9}, {3.703423266812084*^9, 3.7034232718528643`*^9}, {
   3.7034241338591413`*^9, 3.703424139217524*^9}, {3.70342570466364*^9, 
   3.7034257102454915`*^9}, {3.7038487783826723`*^9, 3.703848903548545*^9}, {
   3.703852186890045*^9, 3.703852194689601*^9}, {3.7039111498314333`*^9, 
   3.7039111603364143`*^9}, {3.703915192026905*^9, 3.7039152013479557`*^9}, {
   3.703930649246125*^9, 3.7039306573170633`*^9}, {3.7039380804629107`*^9, 
   3.703938084699339*^9}, {3.7040225414076853`*^9, 3.704022544242689*^9}, {
   3.7040866968334007`*^9, 3.704086703149624*^9}, {3.704443015083897*^9, 
   3.7044430215505753`*^9}, {3.704443710996471*^9, 3.704443718853868*^9}, {
   3.7044456507642*^9, 3.7044456542105207`*^9}, {3.7044456867542143`*^9, 
   3.704445694985958*^9}, {3.7044468041091833`*^9, 3.704446810910087*^9}, {
   3.704448193698395*^9, 3.704448202070369*^9}, {3.704453407371252*^9, 
   3.704453411852687*^9}, {3.7044535720609503`*^9, 3.704453574830306*^9}, {
   3.704454114950716*^9, 3.704454122319525*^9}, {3.7044545003931*^9, 
   3.70445450316191*^9}, {3.7044549620074883`*^9, 3.704454966283927*^9}, {
   3.7044570799838877`*^9, 3.704457181755287*^9}, {3.7045194099914427`*^9, 
   3.704519424683506*^9}, {3.704520803703473*^9, 3.704520809855098*^9}, {
   3.704522560473948*^9, 3.7045225700505867`*^9}, {3.704523831345388*^9, 
   3.704523836230776*^9}, {3.704524690440407*^9, 3.704524693212327*^9}, {
   3.70452473704385*^9, 3.704524743269949*^9}, {3.704525594787253*^9, 
   3.704525600241507*^9}, {3.7045273977892857`*^9, 3.704527400758037*^9}, {
   3.7045299743546877`*^9, 3.704529979318213*^9}, {3.704532344636999*^9, 
   3.7045323522286987`*^9}, {3.704534625049589*^9, 3.704534629346183*^9}, {
   3.704536613987253*^9, 3.704536621055112*^9}, {3.7046294441563873`*^9, 
   3.7046294464182034`*^9}, {3.704691935239091*^9, 3.704691941015555*^9}, 
   3.704692194970079*^9, 3.704692462164241*^9, 3.704692723053526*^9, 
   3.7046930854674788`*^9, 3.704693760117302*^9, {3.7047000442522306`*^9, 
   3.704700059902968*^9}, {3.7047778260668774`*^9, 3.7047778566043324`*^9}, {
   3.7047798621158457`*^9, 3.704779867828786*^9}, {3.704781173176094*^9, 
   3.704781173410997*^9}, 3.704782400079035*^9, {3.704783558467715*^9, 
   3.704783559093628*^9}, 3.704785117670468*^9, {3.7047875484438343`*^9, 
   3.704787553536728*^9}, 3.704890280205909*^9, {3.7049620259109735`*^9, 
   3.7049620466856256`*^9}, {3.705054560146186*^9, 3.705054572130554*^9}, {
   3.70505561307833*^9, 3.705055613443975*^9}, {3.7050563338109827`*^9, 
   3.705056338952066*^9}, {3.705056424983117*^9, 3.705056425446727*^9}, {
   3.705056579094049*^9, 3.705056588974166*^9}, {3.70505720682086*^9, 
   3.7050572196354322`*^9}, {3.705057268311543*^9, 3.705057268647296*^9}, {
   3.705057334339799*^9, 3.70505745594904*^9}, 3.705057628701633*^9, {
   3.705057922808167*^9, 3.705057926655809*^9}, {3.7050591646226587`*^9, 
   3.705059167510768*^9}, {3.7050592747352057`*^9, 3.705059346781682*^9}, {
   3.705059380713168*^9, 3.705059386188552*^9}, {3.7051313619345512`*^9, 
   3.705131364044976*^9}, {3.705136299179554*^9, 3.705136307691019*^9}, {
   3.70513938585924*^9, 3.705139386466097*^9}, {3.705140104989725*^9, 
   3.705140107982832*^9}, {3.705141009817327*^9, 3.705141021569244*^9}, {
   3.7052079909257317`*^9, 3.705207993830329*^9}, {3.705227189150483*^9, 
   3.705227193862084*^9}, 3.705229085209425*^9, 3.705229231919301*^9, {
   3.705229371404645*^9, 3.7052293936366796`*^9}, {3.705229952699018*^9, 
   3.705229982434999*^9}, {3.705230031469557*^9, 3.705230034141135*^9}, 
   3.705307250307516*^9, {3.705398002828726*^9, 3.7053980416534643`*^9}, {
   3.705662020023117*^9, 3.705662084577467*^9}, {3.705662115431923*^9, 
   3.7056621922938786`*^9}},
 ExpressionUUID -> "231e53cd-63e3-4c16-b1a5-c968ffbbb598"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialisation", "Section",
 CellChangeTimes->{{3.699693205354725*^9, 3.699693209307227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"originalpath", ",", "originaljoined"}], "}"}], "=", 
   RowBox[{"initialisationloop", "[", 
    RowBox[{
    "showPaths", ",", "\[Lambda]", ",", "\[Tau]", ",", "slices", ",", 
     "numparticles", ",", "numsteps", ",", "startingRange", ",", 
     "startingDelta", ",", "dimensionality"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6996932300025787`*^9, 3.699693259303553*^9}, {
   3.699693313939022*^9, 3.6996935438120923`*^9}, {3.6996937052396092`*^9, 
   3.6996937331646404`*^9}, {3.6996937767594795`*^9, 
   3.6996937928780403`*^9}, {3.6996938522598*^9, 3.699693869507581*^9}, {
   3.6996939517355075`*^9, 3.6996939639922543`*^9}, {3.699694015087697*^9, 
   3.6996940402395563`*^9}, {3.6996940822488613`*^9, 3.699694106606792*^9}, {
   3.699694437712001*^9, 3.699694483882416*^9}, {3.6996976283070374`*^9, 
   3.6996976294436493`*^9}, {3.7002082927364006`*^9, 3.7002083277586355`*^9}, 
   3.7002115333406754`*^9, {3.7010907955850096`*^9, 3.701090811798766*^9}, {
   3.7023905564775677`*^9, 3.7023905597354183`*^9}, {3.705052970760466*^9, 
   3.705052982691782*^9}, {3.7050543242365294`*^9, 3.705054324768984*^9}, {
   3.705054355685157*^9, 3.705054356686392*^9}, {3.705054621984825*^9, 
   3.7050546394246407`*^9}},
 ExpressionUUID -> "5cb1b0bd-3c3c-48dc-954d-1b2ed938c4e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Running calls", "Section",
 CellChangeTimes->{{3.693733125902392*^9, 3.693733127550764*^9}}],

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "energysaverarraytherm", ",", "invvartherm", ",", 
     "energysaverarrayvirial", ",", "invvarvirial", ",", 
     "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
     "energysaverarrayheinze", ",", "invvarheinze", ",", 
     "particleDensitysaverarray", ",", 
     "vectorPairCorrelationFunctionsaverarray", ",", "numsuccessesBisect", 
     ",", "numpermuted", ",", "path", ",", "joined"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "energysaverarraytherm", ",", "invvartherm", ",", 
      "energysaverarrayvirial", ",", "invvarvirial", ",", 
      "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
      "energysaverarrayheinze", ",", "invvarheinze", ",", 
      "particleDensitysaverarray", ",", 
      "vectorPairCorrelationFunctionsaverarray", ",", "numsuccessesBisect", 
      ",", "numpermuted", ",", "path", ",", "joined"}], "}"}], "=", 
    RowBox[{"mainLoop", "[", 
     RowBox[{
     "originalpath", ",", "originaljoined", ",", "\[Lambda]", ",", "\[Tau]", 
      ",", "calculateEnergy", ",", "calculateParticleDensity", ",", 
      "calculatePairCorrelationFunction", ",", "maxcyclelength", ",", 
      "dimensionality", ",", "numparticles", ",", "equilibrationsteps", ",", 
      "observablecalc", ",", "numsteps", ",", "slices", ",", "energyTherm", 
      ",", "energyVirial", ",", "energyFullVirial", ",", "energyHeinze", ",", 
      "\[Omega]", ",", "harmonictrap", ",", "calculateFracSameWell"}], 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"energyPrinter", "[", 
    RowBox[{
    "calculateEnergy", ",", "energyTherm", ",", "energyVirial", ",", 
     "energyFullVirial", ",", "energyHeinze", ",", "harmonictrap", ",", 
     "energysaverarraytherm", ",", "invvartherm", ",", 
     "energysaverarrayvirial", ",", "invvarvirial", ",", 
     "energysaverarrayfullvirial", ",", "invvarfullvirial", ",", 
     "energysaverarrayheinze", ",", "invvarheinze", ",", "\[Tau]", ",", 
     "slices", ",", "\[Omega]", ",", "dimensionality"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"plotMaker", "[", 
    RowBox[{
    "showPaths", ",", "calculateEnergy", ",", "calculateParticleDensity", ",",
      "calculatePairCorrelationFunction", ",", "allow3DCorrelationPlots", ",",
      "showAutocorrelation", ",", "numparticles", ",", "path", ",", "joined", 
     ",", "energyVirial", ",", "energyFullVirial", ",", "energyTherm", ",", 
     "energyHeinze", ",", "energysaverarrayvirial", ",", 
     "energysaverarrayfullvirial", ",", "energysaverarraytherm", ",", 
     "energysaverarrayheinze", ",", "invvarvirial", ",", "invvarfullvirial", 
     ",", "invvartherm", ",", "invvarheinze", ",", "equilibrationsteps", ",", 
     "numsteps", ",", "harmonictrap", ",", "\[Omega]", ",", "\[Tau]", ",", 
     "slices", ",", "particleDensitysaverarray", ",", 
     "vectorPairCorrelationFunctionsaverarray", ",", "binsize", ",", 
     "observablecalc", ",", "plotPoints3D", ",", "dimensionality"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.698745742098097*^9, 3.6987458353564463`*^9}, {
   3.6987467151232243`*^9, 3.698746722597444*^9}, {3.698746790907386*^9, 
   3.6987468384067135`*^9}, 3.698750979166326*^9, {3.6987512938910255`*^9, 
   3.698751409193777*^9}, {3.698752561138399*^9, 3.698752576606024*^9}, {
   3.6987574044064646`*^9, 3.698757556775589*^9}, {3.698758034049122*^9, 
   3.6987580449965696`*^9}, {3.6987582330859756`*^9, 3.698758256576641*^9}, 
   3.698758313640332*^9, {3.698759774771448*^9, 3.6987597807747984`*^9}, {
   3.698996751837555*^9, 3.6989967545172887`*^9}, {3.699000262894986*^9, 
   3.6990003554051027`*^9}, {3.699000390809785*^9, 3.699000407044505*^9}, {
   3.6990004545202017`*^9, 3.699000458954356*^9}, {3.6990006263289156`*^9, 
   3.6990006536801863`*^9}, 3.699000852693812*^9, {3.699001140225999*^9, 
   3.699001141854748*^9}, {3.6990012742185097`*^9, 3.699001274570241*^9}, 
   3.69900133779303*^9, {3.6990061681798444`*^9, 3.6990061733982706`*^9}, {
   3.699006417664177*^9, 3.699006423579892*^9}, 3.699011112528267*^9, {
   3.6990116791895676`*^9, 3.6990116814535894`*^9}, {3.6990172373577256`*^9, 
   3.6990173007783084`*^9}, 3.699017350225116*^9, {3.6990174333034225`*^9, 
   3.6990175059019136`*^9}, {3.6990179264876027`*^9, 3.699017930989604*^9}, {
   3.6990183738499575`*^9, 3.699018393099511*^9}, {3.699018606195555*^9, 
   3.6990186546567698`*^9}, {3.699018685066144*^9, 3.699018770473223*^9}, 
   3.699018800917515*^9, {3.699019714135895*^9, 3.6990200299914236`*^9}, {
   3.699020063252759*^9, 3.6990201428832064`*^9}, 3.699020229039016*^9, {
   3.6990203750114336`*^9, 3.699020448790698*^9}, {3.6990204993344736`*^9, 
   3.699020643736992*^9}, {3.699020807617055*^9, 3.699020826493931*^9}, {
   3.6990208641313934`*^9, 3.699020933637082*^9}, {3.699020971816178*^9, 
   3.6990210248758016`*^9}, 3.6990211207780313`*^9, {3.699021198424464*^9, 
   3.6990212002999144`*^9}, {3.6990213701756573`*^9, 3.699021425538104*^9}, {
   3.699021746793106*^9, 3.6990217908080535`*^9}, {3.69902184936744*^9, 
   3.6990219696993985`*^9}, {3.69902838573866*^9, 3.6990283985210843`*^9}, {
   3.699028437686882*^9, 3.6990285673595266`*^9}, {3.699028804203135*^9, 
   3.6990288280179625`*^9}, {3.6990290858686485`*^9, 
   3.6990290957367167`*^9}, {3.6990291382383323`*^9, 3.699029139460596*^9}, {
   3.699029244999772*^9, 3.6990292747233615`*^9}, {3.6991917848794856`*^9, 
   3.6991917923520236`*^9}, {3.699349039123457*^9, 3.6993491104068537`*^9}, {
   3.699693222357335*^9, 3.6996932281429586`*^9}, {3.6996934866474085`*^9, 
   3.699693490769471*^9}, {3.7002082843733873`*^9, 3.7002082889738846`*^9}, 
   3.7002087721987467`*^9, 3.701081902383032*^9, 3.7010828682492447`*^9, {
   3.7010835431135716`*^9, 3.701083552989778*^9}, {3.7010841238934393`*^9, 
   3.7010841375201693`*^9}, {3.7010841702583838`*^9, 
   3.7010841705084186`*^9}, {3.701084338053173*^9, 3.7010843582743945`*^9}, {
   3.7010844147970247`*^9, 3.701084432643046*^9}, {3.7010844645599422`*^9, 
   3.70108448309336*^9}, {3.701084533193014*^9, 3.7010845676347284`*^9}, 
   3.7010846840627413`*^9, {3.701084721958302*^9, 3.7010847599787254`*^9}, {
   3.7010871210614653`*^9, 3.7010871720869274`*^9}, {3.7010876126156607`*^9, 
   3.7010876237422237`*^9}, {3.701261124456258*^9, 3.70126121209574*^9}, {
   3.701261301592402*^9, 3.7012613422588587`*^9}, {3.701261547890216*^9, 
   3.701261548017847*^9}, {3.7019431839546833`*^9, 3.701943190524046*^9}, {
   3.7019469531299973`*^9, 3.701947065955859*^9}, {3.7019472779236555`*^9, 
   3.7019472893783426`*^9}, {3.7019475123564086`*^9, 
   3.7019475138858204`*^9}, {3.701948784566188*^9, 3.7019488402345796`*^9}, {
   3.702393463420533*^9, 3.7023934906550603`*^9}, {3.7023936003416724`*^9, 
   3.7023936058900566`*^9}, 3.7026565619334707`*^9, {3.7026575970406165`*^9, 
   3.702657599978177*^9}, {3.7033971222264977`*^9, 3.7033971350940523`*^9}, {
   3.7033974689603224`*^9, 3.7033974732091455`*^9}, 3.7034019083061*^9, {
   3.704537042866185*^9, 3.704537047497069*^9}, {3.704537890666264*^9, 
   3.704537893247328*^9}, {3.705121858026497*^9, 3.705121863761085*^9}, 
   3.7054048155824995`*^9},
 ExpressionUUID -> "bb4206cc-0c57-414b-bf7a-1994862574d0"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
CellContext->Notebook,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 92, 1, 101, "Title"],
Cell[675, 25, 130, 4, 49, "Text"],
Cell[808, 31, 874, 17, 125, "Text"],
Cell[1685, 50, 1002, 20, 163, "Text"],
Cell[2690, 72, 262, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[2977, 81, 94, 1, 70, "Section"],
Cell[3074, 84, 417, 9, 30, "Input"],
Cell[3494, 95, 304064, 6807, 23125, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[307595, 6907, 98, 1, 70, "Section"],
Cell[307696, 6910, 42166, 664, 525, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[349899, 7579, 97, 1, 70, "Section"],
Cell[349999, 7582, 8021, 139, 107, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358057, 7726, 99, 1, 70, "Section"],
Cell[358159, 7729, 1348, 23, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359544, 7757, 98, 1, 70, "Section"],
Cell[359645, 7760, 7275, 114, 202, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

